\chapter{Computational Complexity of Strategies in Repeated Games with Discounting}\label{ch:ch3}

%\section{Повторяющийся трёхсторонний чёт-нечет}\label{sec:ch3/sect1}

%Чувствительность к дополнительной информационной асимметрии интересна не только тем, как на исходы проявляющих её игр влияет собственно информационная асимметрия. Далее будет показано, что в тех случаях, когда этим свойством обладают отдельные розыгрыши повторяющихся игр, необычные эффекты могут возникать даже при отсутствии приватных механизмов корреляции, в рамках классического смешанного расширения и совершенных подыгровых равновесий. Разберём этот феномен на примере игры в <<трёхсторонний чёт-нечет>>, описанной в разделе \ref{sec:ch1/sec4}. Сперва проанализируем повторяющуюся версию данного конфликта с классической точки зрения, применяя <<народную>> теорему.
%
%\begin{table} [htbp]
%	\centering
%	\begin{threeparttable}
%		\caption{Трёхсторонний чёт"~нечет}
%		\label{tab:coin3b}
%		\begin{tabular}{ |c|c|c|c|c| }
%			\cline{1-2} \cline{4-5}
%			\rule[-7pt]{0pt}{2em}$4, 4, 4$ &
%			\rule[-7pt]{0pt}{2em}$6, 0, 6$ & \qquad\qquad\qquad &
%			\rule[-7pt]{0pt}{2em}$6, 6, 0$ &
%			\rule[-7pt]{0pt}{2em}$0, 6, 6$ \\
%			\cline{1-2} \cline{4-5}
%			\rule[-7pt]{0pt}{2em}$0, 6, 6$ &
%			\rule[-7pt]{0pt}{2em}$6, 6, 0$ & \qquad\qquad\qquad &
%			\rule[-7pt]{0pt}{2em}$6, 0, 6$ &
%			\rule[-7pt]{0pt}{2em}$4, 4, 4$ \\
%			\cline{1-2} \cline{4-5}
%		\end{tabular}
%	\end{threeparttable}
%\end{table}
%
%В соответствии с формулировкой теоремы для получения множества равновесий по Нэшу в повторяющейся игре необходимо построить минимаксные стратегии наказания в отдельной её итерации. Однако трёхсторонний чёт-нечет любопытен тем, что в смешанных стратегиях никакая попытка двух игроков минимизировать выигрыш третьего не может опустить его результат ниже того, что он получает в точках равновесия по Нэшу (т.е. менее $4$). Действительно, пусть первый игрок избрал стратегию $(p, 1 - p)$, а второй "--- $(q, 1 - q)$. Тогда выигрыши третьего при выборе чистых стратегий составляют:
%\begin{align*}
%	u^3(p, q, 1) &= 6 (p + q) - 8 p q; \\
%	u^3(p, q, 0) &= 2 (p + q) - 8 p q + 4.
%\end{align*}
%
%Несложно заметить, что
%\begin{align*}
%	p \ge &q \ge \frac{1}{2} \Rightarrow u^3(p, q, 1) \ge 4; \\
%	p \ge 1 - &q \ge \frac{1}{2} \Rightarrow u^3(p, q, 1) \ge 4; \\
%	q \ge &p \ge \frac{1}{2} \Rightarrow u^3(p, q, 1) \ge 4; \\
%	q \ge 1 - &p \ge \frac{1}{2} \Rightarrow u^3(p, q, 1) \ge 4; \\
%	p \le &q \le \frac{1}{2} \Rightarrow u^3(p, q, 0) \ge 4; \\
%	p \le 1 - &q \le \frac{1}{2} \Rightarrow u^3(p, q, 0) \ge 4; \\
%	q \le &p \le \frac{1}{2} \Rightarrow u^3(p, q, 0) \ge 4; \\
%	q \le 1 - &p \le \frac{1}{2} \Rightarrow u^3(p, q, 0) \ge 4. \\
%\end{align*}
%
%Эти варианты исчерпывают всё пространство возможных ситуаций, так что никакое сочетание смешанных стратегий двух игроков не может быть эффективным наказанием для третьего. В классическом случае это означало бы, что повторяющаяся игра имеет в качестве решения то же самое множество равновесий по Нэшу, что и отдельный розыгрыш. Однако, вывод этот можно интересным образом уточнить, перейдя к модели, учитывающей стоимость вычислений, необходимых для выбора стратегии в очередной итерации.

\section{<<Folk>> theorem in conspiracy spaces}\label{sec:ch3/sect1}

In order to understand how repetition affects conflicts that are sensitive to additional information asymmetry, it is necessary first to analyze how the <<folk>> theorem can be generalized to games in conspiracy spaces. Previously, this theorem has already been proved in various forms for the correlated expansion of games \cite{Fudenberg}, deliberately restricted to the case of public correlation mechanisms. We need to take one more step away from this limitation. In fact, the main change is that the use of private correlation mechanisms can often further reduce the reserve payoffs of players who do not have access to them. Recall that the reserve payoff of player $a$ is %Для того, чтобы понять, как многократное повторение влияет на конфликты, чувствительные к дополнительной информационной асимметрии, необходимо сперва проанализировать то, как <<народная>> теорема может быть обобщена на игры в пространствах заговоров. Ранее эту теорему уже доказывали в различных формах для коррелированного расширения игр \cite{Fudenberg}, сознательно ограничиваясь случаем публичных механизмов корреляции. Нам же необходимо сделать ещё один шаг, отказавшись от этого ограничения. По сути, главным изменением оказывается то, что использование приватных механизмов корреляции зачастую позволяет дополнительно уменьшить резервные выигрыши игроков, не имеющих к ним доступа. Напомним, что резервным выигрышем игрока $a$ называется
\begin{equation*}
	u^a_* = \min_{s \in \overline{S}_a} u^a(s), \overline{S}_a = \{\overline{s} \in S \mid \overline{s}^a \in \arg\max_{s^a \in S^a} u^a(\overline{s} | s^a)\},
\end{equation*}
that is, his smallest payoff among all possible outcomes in which he uses the strategy of the best response. Essentially, the reserve payoff denotes an utility margin below which the expected payoff of the respective player is impossible to lower down, even if all other players unite to achieve this goal, regardless of the damage to their own profits. The strategy profile leading to such an outcome is called minimax for player $a$. The vector $u_* = (u^1_*, \ldots, u^m_*)$, composed of the reserve payoffs of each player, is called the minimax point of the game. The reserve equilibrium payoff of player $a$ can be defined similarly: %то есть наименьший его выигрыш среди всевозможных исходов, в которых он использует стратегию наилучшего ответа. По сути, резервный выигрыш обозначает границу полезности, ниже которой для соответствующего игрока невозможно опустить ожидаемый выигрыш, даже если все остальные игроки объединятся для достижения этой цели, невзирая на ущерб себе. Набор стратегий, приводящий к такому исходу, называется минимаксным для игрока $a$. Вектор $u_* = (u^1_*, \ldots, u^m_*)$, составленный из резервных выигрышей каждого игрока, называется точкой минимакса игры. Аналогичным образом можно определить резервный равновесный выигрыш игрока $a$:
\begin{equation*}
	\tilde{u}^a_* = \min_{s \in \tilde{S}} u^a(s), \text{where $\tilde{S}$ is the set of Nash equilibrium profiles},
\end{equation*}
which form the vector $\tilde{u}_* = (\tilde{u}^1_*, \ldots, \tilde{u}^m_*)$, which is called the equilibrium minimax point of the game. It is obvious that $\tilde{u}_* \succeq u_*$. %из которых составляется вектор $\tilde{u}_* = (\tilde{u}^1_*, \ldots, \tilde{u}^m_*)$, называемый точкой равновесного минимакса игры. Очевидно при этом, что $\tilde{u}_* \succeq u_*$.

The central idea behind the proof of most <<folk>> theorems is the use of minimax sets of strategies to punish players who deviate from the designated chain of actions expected of them by their opponents. Any draw sequence $(s_i)$ with payoffs converging (in the mean or discounted sense, depending on the version of the theorem) to a vector $u_0 = (u^1_0, \ldots, u^m_0)$ strictly dominating the minimax point of the game (i.e., $u^a_0 > u^a_*, a = \overline{1,m}$), can be the equilibrium outcome (in the ordinary Nash or subgame perfection senses, depending on the version of the theorem) of a repeated game. If at iteration $i$ player $a$ deviates from the expected strategy $s^a_i$, then, starting from the next iteration, the remaining players proceed to apply the strategy from the minimax profile for this player, continuing to do so for a sufficiently long time (in some versions of the proofs, infinitely) so that the damage they inflict on player $a$ exceeds his profit from the deviation. %Центральной идеей, стоящей за доказательством большинства <<народных>> теорем, является использование минимаксных наборов стратегий для наказания игроков, отклоняющихся от запланированной цепочки действий, ожидаемых от них соперниками. Любая последовательность розыгрышей $(s_i)$ с выплатами, сходящимися (в смысле среднего или с дисконтированием, в зависимости от версии теоремы) к вектору $u_0 = (u^1_0, \ldots, u^m_0)$, строго доминирующему точку минимакса игры (т.е. $u^a_0 > u^a_*, a = \overline{1,m}$), может быть равновесным исходом (в смысле обычного Нэша или совершенного по подыграм, в зависимости от версии теоремы) повторяющейся игры. Если на итерации $i$ игрок $a$ отклоняется от ожидаемой стратегии $s^a_i$, то начиная со следующей итерации остальные игроки переходят к применению стратегии из минимаксного для этого игрока набора, продолжая делать это достаточно долго (в некоторых версиях доказательств бесконечно) для того, чтобы нанесённый ими игроку $a$ ущерб превзошёл его прибыль от отклонения.

Correlated strategies in the context of repetitive games are usually understood in the limited sense "--- only public signals are considered, which, from our model's point of view, corresponds to conspiracy spaces of the structure $\{A\}$, that is, consisting of one cabal involving all players. The set of payoff vectors attainable in the game $\Gamma | \{A\}$ is the convex hull of the set of vectors entering into the payoff matrix of the game $\Gamma$. The set of correlated Nash equilibria of the game $\Gamma | \{A\}$ is the convex hull of the set of mixed equilibria of the game $\Gamma$. At the same time, as was shown in previous chapters, adding to the conspiracy space cabals that do not include all players can enrich the set of correlated Nash equilibria with points lying outside the convex hull of the set of mixed equilibria. Also, through the use of secrecy, the reserve payoffs of players can be additionally reduced if they do not have the opportunity to observe every signal. %Коррелированные стратегии в контексте повторяющихся игр понимаются обычно в ограниченном смысле "--- рассматриваются только публичные сигналы, что с точки зрения нашей модели соответствует пространствам заговоров структуры $\{A\}$, то есть состоящим из одного заговора, охватывающего всех игроков. Множество платёжных векторов, достижимых в игре $\Gamma | \{A\}$, представляет собой выпуклую оболочку множества векторов, входящих в матрицу выплат игры $\Gamma$. Множество коррелированных равновесий по Нэшу игры $\Gamma | \{A\}$ представляет собой выпуклую оболочку множества смешанных равновесий игры $\Gamma$. При этом, как было показано в предыдущих главах, добавление к пространству заговоров групп, в которые входят не все игроки, может пополнять множество коррелированных равновесий по Нэшу точками, лежащими за пределами выпуклой оболочки множества смешанных равновесий. Кроме того, благодаря использованию тайных сигналов могут быть снижены резервные выигрыши игроков, не имеющих возможности их наблюдать.

For the proofs of the most <<folk>> theorem versions, the transition to more complex conspiracy spaces is probably not a big problem, as the logic of the reasoning remains the same "--- it is enough, if necessary, to take into account new minimax values and correlated equilibria outside the convex hull of the mixed set. Fortunately, in the context of this work, we do not even need its modern formulations "--- the classical, relatively weak statement is quite sufficient: %Для доказательств большинства версий <<народной>> теоремы переход к более сложным пространствам заговоров, вероятно, не представляет большой проблемы "--- логика рассуждений остаётся прежней, достаточно при необходимости учитывать новые значения минимаксов и коррелированные равновесия за пределами выпуклой оболочки множества смешанных. К счастью, в контексте данной работы у нас даже нет необходимости в современных её формулировках "--- вполне достаточно классического, относительно слабого утверждения:
\begin{theorem}\label{the:folk}
	Let $\Gamma = \langle A, S^a, u^a(s), a \in A \rangle$ be a normal form game with a finite set of outcomes, $V$ be the convex hull of the payoff vectors set of its matrix, and $\mathfrak{A} \subseteq 2^A$ be an arbitrary conspiracy space. If the payoff vector $v \in V$ strictly dominates the minimax point of the game $\Gamma | \mathfrak{A}$, then there is a discount factor $0 < \delta < 1$ such that in the infinitely repeating game $\Gamma | \mathfrak{A}$ there will be a Nash equilibrium with payoffs converging to $v$. If the vector $v$ also dominates the equilibrium minimax point of the same game, then in an infinitely repeated game with a sufficiently large discount factor, there will be a perfect subgame equilibrium with payoffs converging to $v$. %Пусть $\Gamma = \langle A, S^a, u^a(s), a \in A \rangle$ "--- игра в нормальной форме с конечным множеством исходов, $V$ "--- выпуклая оболочка множества платёжных векторов её матрицы, а $\mathfrak{A} \subseteq 2^A$ "--- произвольное пространство заговоров. Если вектор выплат $v \in V$ строго доминирует точку минимакса игры $\Gamma | \mathfrak{A}$, то найдётся такой коэффициент дисконтирования $0 < \delta < 1$, что в бесконечно повторяющейся игре $\Gamma | \mathfrak{A}$ будет существовать равновесие Нэша с выплатами, сходящимися к $v$. Если же вектор $v$ доминирует ещё и точку равновесного минимакса той же игры, то в бесконечно повторяющейся игре с достаточно большим коэффициентом дисконтирования будет существовать совершенное подыгровое равновесие с выплатами, сходящимися к $v$.
\end{theorem}
\begin{proof}
	If $A \in \mathfrak{A}$, then a sequence of sets with payoffs converging to $v$ is constructed from correlated strategies based on a public signal and directly mixing pure strategy profiles in proportions that provide the required payoff vector. If $A \notin \mathfrak{A}$, then we can use a sequence of pure strategy profiles that converges at the limit to the same point. If any player deviates from the prescribed strategies, the rest switch to punishing him with the corresponding minimax sets of strategies. The profit of player $a$, who deviates at the $i$-th iteration in favor of the strategy $\hat{s}^a_i$, is finite and amounts to $u^a(s_i | \hat{s}^a_i) - u^a( s_i)$, so that for a sufficiently large $\delta$ the damage from the eternal punishment by the minimax for all subsequent iterations will obviously be greater. Punishment by the ordinary minimax may include strategies that are not optimal from the punishing players' point of view, so that the resulting equilibrium points are generally not subgame perfect. Punishment by the equilibrium minimax does not have this disadvantage, which means that the equilibria based on it will indeed be subgame perfect. %Если $A \in \mathfrak{A}$, то последовательность наборов с выплатами, сходящимися к $v$, строится из коррелированных стратегий, опирающихся на публичный сигнал и напрямую смешивающих наборы чистых стратегий в пропорциях, обеспечивающих необходимый вектор платежей. Если же $A \notin \mathfrak{A}$, то можно использовать последовательность наборов чистых стратегий, сходящуюся в пределе к той же точке. При отклонении любого игрока от предписанной стратегий остальные переключаются на его наказание соответствующими минимаксными наборами стратегий. Прибыль игрока $a$, отклоняющегося на $i$-й итерации в пользу стратегии $\hat{s}^a_i$, конечна и составляет $u^a(s_i | \hat{s}^a_i) - u^a(s_i)$, так что при достаточно большом $\delta$ ущерб от вечной кары минимаксом на все последующие итерации будет очевидно больше. Наказание, использующее обычный минимакс, может включать стратегии неоптимальные с точки зрения карающих игроков, так что получающиеся при этом точки равновесия в общем случае не являются совершенными по подыграм. Наказание с использованием равновесного минимакса лишено этого недостатка, а значит равновесия на его основе уже будут совершенными по подыграм.
\end{proof}

For our purposes, this is enough, since we consider a repetition of the game, for which the points of the ordinary and equilibrium minimax coincide in all plot spaces. However, if the need arises, nothing prevents a similar generalization for more modern, strengthened formulations \cite{Vasin}. In order not to overload the work with more cumbersome reasoning, which in fact would be an almost word-for-word citation of the proofs authored by Vasin A.A., we confine ourselves to a brief retelling of their central idea. Participation in the ordinary minimax punishment of the first player deviating from the prescribed strategy can be made optimal strategy for punishers using a slightly more complex threat format. It is enough for the players to agree that the punishment of the first divergent will not be eternal, but interrupted at the moment when someone refuses to take part in it. As soon as one of the punishers deviates from the strategy prescribed by the minimax set, the previous divergent is forgiven and everyone proceeds to the same conditionally eternal punishment of the last <<evader>>, in which everyone participates, including the just forgiven player. Thus, the process turns into something like a <<tag-game>>, creating an effective threat of being the last to be punished, which expands the set of subgame-perfect equilibria to all points that dominate the usual minimax. Adding a conspiracy space here, again, doesn't pose much of a problem "--- the reasoning keeps working even when synchronization with secret signals is used in punishments. %Для наших целей этого хватает, поскольку рассматривать мы будем повторение игры, у которой точки обычного и равновесного минимакса совпадают во всех пространствах заговоров. Тем не менее, если возникнет такая необходимость, ничего не мешает подобному обобщению и более современных, усиленных формулировок \cite{Vasin}. Чтобы не перегружать работу более громоздкими рассуждениями, которые по факту были бы почти дословным цитированием доказательств за авторством Васина А.А., ограничимся кратким пересказом их центральной идеи. Сделать участие в наказании обычным минимаксом первого отклонившегося от предписанной стратегии игрока оптимальной стратегией для наказывающих можно при помощи чуть более сложного формата угрозы. Игрокам достаточно договориться о том, что наказание первого отклонившегося будет не вечным, а прерывающимся в тот момент, когда кто-либо отказывается принимать в нём участие. Как только один из наказывающих отклоняется от предписываемой минимаксным набором стратегии, предыдущий отклонившийся прощается и все переходят к такому же условно вечному наказанию последнего <<уклониста>>, в котором участвуют все, включая только что прощённого игрока. Таким образом процесс превращается в что-то наподобие <<салочек>>, создавая эффективную угрозу оказаться последним наказанным, что расширяет множество совершенных по подыграм равновесий до всех точек, доминирующих обычный минимакс. Добавление пространства заговоров здесь, опять же, не создаёт особых проблем "--- рассуждение продолжает работать даже при использовании в наказаниях синхронизации тайными сигналами.

\section{Repeated three-way even"~odd}\label{sec:ch3/sect2}

%\begin{table} [htbp]
%	\centering
%	\begin{threeparttable}
%		\caption{Трёхсторонний чёт"~нечет}
%		\label{tab:coin3b}
%		\begin{tabular}{ |c|c|c|c|c| }
%			\cline{1-2} \cline{4-5}
%			\rule[-7pt]{0pt}{2em}$4, 4, 4$ &
%			\rule[-7pt]{0pt}{2em}$6, 0, 6$ & \qquad\qquad\qquad &
%			\rule[-7pt]{0pt}{2em}$6, 6, 0$ &
%			\rule[-7pt]{0pt}{2em}$0, 6, 6$ \\
%			\cline{1-2} \cline{4-5}
%			\rule[-7pt]{0pt}{2em}$0, 6, 6$ &
%			\rule[-7pt]{0pt}{2em}$6, 6, 0$ & \qquad\qquad\qquad &
%			\rule[-7pt]{0pt}{2em}$6, 0, 6$ &
%			\rule[-7pt]{0pt}{2em}$4, 4, 4$ \\
%			\cline{1-2} \cline{4-5}
%		\end{tabular}
%	\end{threeparttable}
%\end{table}

You can demonstrate the application of the generalization of the <<folk>> theorem to games with conspiracies using the example of the same three-way even"~odd (see table \ref{tab:coin3}). Here $V$ is a triangle with vertices $(6, 6, 0)$, $(6, 0, 6)$ and $(0, 6, 6)$. The game has two Nash equilibrium points in pure strategies (synchronous choice of heads or tails by all players) and one additional point in mixed strategies (equiprobable independent choice between heads and tails by all players), entailing the same payoff vector $(4, 4, 4)$, which is also the minimax point of the game. Indeed, let the first player choose the strategy $(p, 1 - p)$, and the second "--- $(q, 1 - q)$. Then the payoffs of the third player when choosing pure strategies are: %Продемонстрировать применение обобщения <<народной>> теоремы на игры с заговорами можно на примере всё того же трёхстороннего чёт-нечета (см. таблицу \ref{tab:coin3}). Здесь $V$ представляет собой треугольник с вершинами $(6, 6, 0)$, $(6, 0, 6)$ и $(0, 6, 6)$. У игры две точки равновесия по Нэшу в чистых стратегиях (синхронный выбор орла или решки всеми игроками) и одна дополнительная в смешанных (равновероятный независимый выбор между орлом и решкой всеми игроками), влекущие один и тот же вектор платежей $(4, 4, 4)$, являющийся, к тому же, ещё и точкой минимакса игры. Действительно, пусть первый игрок избрал стратегию $(p, 1 - p)$, а второй "--- $(q, 1 - q)$. Тогда выигрыши третьего при выборе чистых стратегий составляют:
\begin{align*}
	u^3(p, q, 1) &= 6 (p + q) - 8 p q; \\
	u^3(p, q, 0) &= 2 (p + q) - 8 p q + 4.
\end{align*}

It is easy to see that %Несложно заметить, что
\begin{align*}
	p \ge &q \ge \frac{1}{2} \Rightarrow u^3(p, q, 1) \ge 4; \\
	p \ge 1 - &q \ge \frac{1}{2} \Rightarrow u^3(p, q, 1) \ge 4; \\
	q \ge &p \ge \frac{1}{2} \Rightarrow u^3(p, q, 1) \ge 4; \\
	q \ge 1 - &p \ge \frac{1}{2} \Rightarrow u^3(p, q, 1) \ge 4; \\
	p \le &q \le \frac{1}{2} \Rightarrow u^3(p, q, 0) \ge 4; \\
	p \le 1 - &q \le \frac{1}{2} \Rightarrow u^3(p, q, 0) \ge 4; \\
	q \le &p \le \frac{1}{2} \Rightarrow u^3(p, q, 0) \ge 4; \\
	q \le 1 - &p \le \frac{1}{2} \Rightarrow u^3(p, q, 0) \ge 4. \\
\end{align*}

These options exhaust the entire space of possible situations, so that no combination of two players' mixed strategies can be an effective punishment for the third. Thus, in the absence of private correlation mechanisms, the folk theorem does not expand the set of solutions of the repeated even-odd in any way. However, adding to the conspiracy space, for example, the pair $\{1, 2\}$ changes the picture "--- correlated equilibria with payoffs $(5, 5, 2)$ appear in the game in a situation where all players again make an equiprobable the choice is between heads and tails, but due to the secret mechanism of correlation, the choice of players 1 and 2 is always synchronous. This reduces the reserve (in the ordinary and equilibrium sense) payoffs of player 3, giving us a new minimax point "--- $(4, 4, 2)$. In accordance with the version of the <<folk>> theorem formulated above, in the conspiracy space $\{\{1, 2\}\}$, a repeating three-way even"~odd has new subgame-perfect equilibria in a triangle with vertices $(6, 4 , 2)$, $(4, 6, 2)$ and $(4, 4, 4)$. %Эти варианты исчерпывают всё пространство возможных ситуаций, так что никакое сочетание смешанных стратегий двух игроков не может быть эффективным наказанием для третьего. Таким образом в отсутствие приватных механизмов корреляции народная теорема никак не расширяет множество решений повторяющегося чёт-нечета. Однако, добавление в пространство заговоров, например, пары $\{1, 2\}$ меняет картину "--- в игре появляются коррелированные равновесия с выплатами $(5, 5, 2)$ в ситуации, когда все игроки снова делают равновероятный выбор между орлом и решкой, но при этом благодаря секретному механизму корреляции выбор игроков 1 и 2 всегда синхронен. Это уменьшает резервные (в обычном и равновесном смыслах) выигрыши игрока 3, давая нам новую точку минимакса "--- $(4, 4, 2)$. В соответствии с сформулированной выше версией <<народной>> теоремы, в пространстве заговоров $\{\{1, 2\}\}$ у повторяющегося трёхстороннего чёт-нечета появляются новые совершенные по подыграм равновесия в треугольнике с вершинами $(6, 4, 2)$, $(4, 6, 2)$ и $(4, 4, 4)$.

Similarly, in the conspiracy space $\{\{1, 2\}, \{2, 3\}\}$ the minimax point of the game moves to $(2, 4, 2)$, which expands the solution set to a flat trapezoid with vertices $(4, 6, 2)$, $(2, 6, 4)$, $(2, 4, 6)$ and $(6, 4, 2)$. Finally, the space $\{\{1, 2\}, \{2, 3\}, \{1, 3\}\}$, which includes all pairwise plots, gives the minimax point $(2, 2, 2)$, turning the set of payoffs attainable in perfect subgame equilibria into a flat hexagon with vertices $(6, 4, 2)$, $(6, 2, 4)$, $(4, 2, 6)$, $(2, 4, 6)$, $(2, 6, 4)$ and $(4, 6, 2)$. This illustration goes well with the intuitive notion that groups of agents that have the ability to coordinate their actions in secrecy can use this as a threat to outsiders, forcing them to agree to conflict outcomes that, in the absence of collusion, would be rejected as disadvantageous. However, the effect of sensitivity to additional information asymmetry on repetitive games is not limited to this. Further, it will be shown that even in the absence of a priori information asymmetry (i.e., events external to the conflict, of which its participants are informed differently), players, limited in the complexity of the calculations they can make to select the strategies, can use the threat of artificial creation of information asymmetries with the help of specially organized joint public actions. %Аналогичным образом, в пространстве заговоров $\{\{1, 2\}, \{2, 3\}\}$ точка минимакса игры перемещается в $(2, 4, 2)$, что расширяет множество решений до плоской трапеции с вершинами $(4, 6, 2)$, $(2, 6, 4)$, $(2, 4, 6)$ и $(6, 4, 2)$. Наконец, пространство $\{\{1, 2\}, \{2, 3\}, \{1, 3\}\}$, включающее все парные заговоры, даёт точку минимакса $(2, 2, 2)$, превращая множество выплат, достижимых в совершенных подыгровых равновесиях, в плоский шестиугольник с вершинами $(6, 4, 2)$, $(6, 2, 4)$, $(4, 2, 6)$, $(2, 4, 6)$, $(2, 6, 4)$ и $(4, 6, 2)$. Эта иллюстрация неплохо согласуется с интуитивным представлением о том, что группы агентов, имеющие возможность координировать свои действия втайне от остальных, могут использовать это как угрозу в адрес аутсайдеров, принуждая тех соглашаться на исходы конфликтов, которые в отсутствие тайных сговоров были бы отвергнуты как невыгодные. Однако, этим влияние чувствительности к дополнительной информационной асимметрии на повторяющиеся игры не исчерпывается. Далее будет показано, что даже при отсутствии априорной информационной асимметрии (т.е. внешних по отношению к конфликту событий, о которых его участники осведомлены по-разному) игроки, ограниченные в сложности производимых ими для выбора стратегий вычислений, могут использовать угрозу искусственного создания информационной асимметрии при помощи специальным образом организованных совместных публичных действий.

%Расширение отдельных итераций повторяющейся игры пространством заговоров влияет на формулировки и доказательства утверждений следующим образом:
%\begin{itemize}
%	\item \emph{Теоремы A и B}: формулировки остаются прежними, под точкой минимакса понимается вектор резервных выигрышей, достижимых при использовании против соответствующего игрока частично коррелированных стратегий, опирающихся на сокрытые от него в рамках структуры заговоров события;
%	\item \emph{Теорема C}: то же самое, что для предыдущих теорем, плюс в качестве равновесия по Нэшу отдельного розыгрыша может пониматься коррелированное равновесие с использованием событий из структуры заговоров;
%	\item \emph{Теорема D}: полунепрерывность сверху рассматриваемого отображения сохраняется и для точки минимакса в частично коррелированных стратегиях;
%	\item \emph{Теорема 1}: сохраняется неизменной, поскольку сформулирована для случая двух игроков, не имеющего дополнительных решений в пространствах заговоров;
%	\item \emph{Теорема 2}: 
%\end{itemize}

\section{Model of repeated games accounting for the calculation costs}\label{sec:ch3/sect3}

The construction of the desired model implies the specification of the method by which rational agents calculate the strategy of behavior. Any formalism that allows algorithmically complete calculations with probabilistic branching will do for this purpose. In addition, we need the ability to store an arbitrary internal state in memory for use at subsequent iterations and, obviously, a method for numerically estimating the complexity of the calculation performed at each iteration. %Построение искомой модели подразумевает конкретизацию способа, при помощи которого рациональные агенты вычисляют стратегию поведения. Для этой цели подойдёт любой формализм, позволяющий алгоритмически полные вычисления с вероятностным ветвлением. Кроме того, необходимы возможность сохранения произвольного внутреннего состояния в памяти для использования на последующих итерациях и, очевидно, метод численной оценки сложности произведённого на каждой итерации вычисления.
\begin{figure}[ht]
	\centerfloat{
		\ifdefmacro{\tikzsetnextfilename}{\tikzsetnextfilename{tikz_repeat_compiled}}{}
		\begin{tikzpicture}[scale=2]
			\node[circle,draw] (game1) at (1, 0) {$\Gamma$};
			\node[circle,draw] (game2) at (3, 0) {$\Gamma$};
			\node[circle,draw] (game3) at (5, 0) {$\Gamma$};
			\node[rectangle,draw] (calc11) at (0,  1) {$M^1$};
			\node[rectangle,draw] (calc12) at (2,  1) {$M^1$};
			\node[rectangle,draw] (calc13) at (4,  1) {$M^1$};
			\node[] (calc1i) at (6, 1) {$\cdots$};
			\node[rectangle,draw] (calc21) at (0, -1) {$M^2$};
			\node[rectangle,draw] (calc22) at (2, -1) {$M^2$};
			\node[rectangle,draw] (calc23) at (4, -1) {$M^2$};
			\node[] (calc2i) at (6, -1) {$\cdots$};
			\draw [->,thick,decorate,decoration={snake,post length=1mm}] (calc11) -- (game1) node[midway,sloped,below] {$s^1_0$};
			\draw [->,thick,decorate,decoration={snake,post length=1mm}] (calc21) -- (game1) node[midway,sloped,above] {$s^2_0$};
			\draw [->,thick,decorate,decoration={snake,post length=1mm}] (calc12) -- (game2) node[midway,sloped,below] {$s^1_1$};
			\draw [->,thick,decorate,decoration={snake,post length=1mm}] (calc22) -- (game2) node[midway,sloped,above] {$s^2_1$};
			\draw [->,thick,decorate,decoration={snake,post length=1mm}] (calc13) -- (game3) node[midway,sloped,below] {$s^1_2$};
			\draw [->,thick,decorate,decoration={snake,post length=1mm}] (calc23) -- (game3) node[midway,sloped,above] {$s^2_2$};
			\draw [->,thick,decorate,decoration={snake,post length=1mm}] (game1) -- (calc12) node[midway,sloped,below] {$s_0$};
			\draw [->,thick,decorate,decoration={snake,post length=1mm}] (game1) -- (calc22) node[midway,sloped,above] {$s_0$};
			\draw [->,thick,decorate,decoration={snake,post length=1mm}] (game2) -- (calc13) node[midway,sloped,below] {$s_1$};
			\draw [->,thick,decorate,decoration={snake,post length=1mm}] (game2) -- (calc23) node[midway,sloped,above] {$s_1$};
			\draw [->,thick,decorate,decoration={snake,post length=1mm}] (game3) -- (calc1i) node[midway,sloped,below] {$s_2$};
			\draw [->,thick,decorate,decoration={snake,post length=1mm}] (game3) -- (calc2i) node[midway,sloped,above] {$s_2$};
			\node[diamond,draw] (sum1) at (-1, 2) {$\Sigma^1$};
			\node[] (sum10) at (0,  2) [label=$-\mathfrak{w}^1_0$] {};
			\node[] (sum11) at (1,  2) [label=$+u^1(s_0)$] {};
			\node[] (sum12) at (2,  2) [label=$-\delta \mathfrak{w}^1_1$] {};
			\node[] (sum13) at (3,  2) [label=$+\delta u^1(s_1)$] {};
			\node[] (sum14) at (4,  2) [label=$-\delta^2 \mathfrak{w}^1_2$] {};
			\node[] (sum15) at (5,  2) [label=$+\delta^2 u^1(s_2)$] {};
			\node[] (sum1i) at (6,  2) {$\cdots$};
			\node[diamond,draw] (sum2) at (-1, -2) {$\Sigma^2$};
			\node[] (sum20) at (0, -2) [label=below:$-\mathfrak{w}^2_0$] {};
			\node[] (sum21) at (1, -2) [label=below:$+u^2(s_0)$] {};
			\node[] (sum22) at (2, -2) [label=below:$-\delta \mathfrak{w}^2_1$] {};
			\node[] (sum23) at (3, -2) [label=below:$+\delta u^2(s_1)$] {};
			\node[] (sum24) at (4, -2) [label=below:$-\delta^2 \mathfrak{w}^2_2$] {};
			\node[] (sum25) at (5, -2) [label=below:$+\delta^2 u^2(s_2)$] {};
			\node[] (sum2i) at (6, -2) {$\cdots$};
			\draw [->,thick] (sum1i) -- (sum1);
			\draw [->,thick] (calc11) -- (sum10);
			\draw [->,thick] (game1) -- (sum11);
			\draw [->,thick] (calc12) -- (sum12);
			\draw [->,thick] (game2) -- (sum13);
			\draw [->,thick] (calc13) -- (sum14);
			\draw [->,thick] (game3) -- (sum15);
			\draw [->,thick] (sum2i) -- (sum2);
			\draw [->,thick] (calc21) -- (sum20);
			\draw [->,thick] (game1) -- (sum21);
			\draw [->,thick] (calc22) -- (sum22);
			\draw [->,thick] (game2) -- (sum23);
			\draw [->,thick] (calc23) -- (sum24);
			\draw [->,thick] (game3) -- (sum25);
			\fill [white] (1,  1) circle (2pt);
			\fill [white] (3,  1) circle (2pt);
			\fill [white] (5,  1) circle (2pt);
			\fill [white] (1, -1) circle (2pt);
			\fill [white] (3, -1) circle (2pt);
			\fill [white] (5, -1) circle (2pt);
			\draw [->,double,thick] (-1,  1) -- (calc11) node[midway,above] {$\psi^1_0$};
			\draw [->,double,thick] (calc11) -- (calc12) node[near end,above] {$\psi^1_1$};
			\draw [->,double,thick] (calc12) -- (calc13) node[near end,above] {$\psi^1_2$};
			\draw [->,double,thick] (calc13) -- (calc1i) node[near end,above] {$\psi^1_3$};
			\draw [->,double,thick] (-1, -1) -- (calc21) node[midway,below] {$\psi^2_0$};
			\draw [->,double,thick] (calc21) -- (calc22) node[near end,below] {$\psi^2_1$};
			\draw [->,double,thick] (calc22) -- (calc23) node[near end,below] {$\psi^2_2$};
			\draw [->,double,thick] (calc23) -- (calc2i) node[near end,below] {$\psi^2_3$};
		\end{tikzpicture}
	}
	\legend{}
	\caption[Repeated game accounting for the calculation costs]{Repeated game accounting for the calculation costs}\label{fig:repeat}
\end{figure}

The diagram in the figure \ref{fig:repeat} depicts the general scheme of interaction between agents and the environment for two players (naturally extensible to any finite number of them). At the nodes labeled with the letter $\Gamma$, successive plays of an arbitrary game $\Gamma = \langle A, S^a, u^a(s), a \in A \rangle$ take place. In the $i$-th draw, player $a$ chooses his strategy $s^a_i$ by applying the probabilistic algorithm $M^a$, which is in the $\psi^a_i$ state, to the result of the previous draw $s_{i-1}$ (if there was one) and storing the results of calculations necessary for future iterations in the new state $\psi^a_{i+1}$. The $\Sigma^a$ nodes represent the successive summation of the difference between the payoff $u^a(s_i)$ and the cost of the calculation $\mathfrak{w}^a_i$, taking into account the exponentially decreasing discount factor $\delta^i$. %Диаграмма на рисунке \ref{fig:repeat} изображает общую схему взаимодействия агентов и среды для двух игроков (естественным образом обобщающуюся на любое конечное их число). В узлах, помеченных буквой $\Gamma$, происходят последовательные розыгрыши произвольной игры $\Gamma = \langle A, S^a, u^a(s), a \in A \rangle$. В $i$-м розыгрыше игрок $a$ выбирает свою стратегию $s^a_i$, применяя вероятностный алгоритм $M^a$, находящийся в состоянии $\psi^a_i$, к результату предыдущего розыгрыша $s_{i-1}$ (если таковой был) и запоминая необходимые для будущих итераций результаты вычислений в новом состоянии $\psi^a_{i+1}$. Узлы $\Sigma^a$ изображают последовательное суммирование разностей выигрыша $u^a(s_i)$ и затрат на произведённое вычисление $\mathfrak{w}^a_i$, с учётом экспоненциально уменьшающегося коэффициента дисконтирования $\delta^i$.

Since we are talking about conflicts between rational agents, it makes sense to consider only universal $M^a$ algorithms that allow us to encode any set of computable strategies for a repeated game in initial memory states $\psi^a_0$. The notation $M^a[g]$ will denote the average cost of computing an arbitrary function $g$ for its optimal implementation by $M^a$. In addition, if $\mathfrak{s}$ denotes a set of strategies for a discounted iterative game, then the notation $M^a[\mathfrak{s}]$ is suitable for denoting the cost of the total amount of computation required by player $a$ to select each move, taking into account the same coefficient $\delta$. Thus, in a repetitive game, taking into account the cost of calculations, each player $a$ optimizes not just $u^a(\mathfrak{s})$, but %Поскольку мы говорим о конфликтах рациональных агентов, имеет смысл рассматривать только универсальные алгоритмы $M^a$, позволяющие закодировать любой набор вычислимых стратегий повторяющейся игры в начальных состояниях памяти $\psi^a_0$. Нотация $M^a[g]$ будет обозначать среднюю стоимость вычисления произвольной функции $g$ при её оптимальной реализации посредством $M^a$. Кроме того, если обозначить символом $\mathfrak{s}$ набор стратегий повторяющейся игры с дисконтированием, то нотация $M^a[\mathfrak{s}]$ подходит для обозначения стоимости полного объёма вычислений, необходимых игроку $a$ для выбора каждого хода с учётом того же коэффициента $\delta$. Таким образом, в повторяющейся игре с учётом стоимости вычислений каждый игрок $a$ оптимизирует не просто $u^a(\mathfrak{s})$, но
\begin{equation*}
	\hat{u}^a(\mathfrak{s}) = u^a(\mathfrak{s}) - M^a[\mathfrak{s}].	
\end{equation*}

\section{Cryptographic strategy synchronization}\label{sec:ch3/sect4}

Although, as shown earlier, in the absence of additional information asymmetry, the three-way even"~odd does not allow two players to punish the third using only mixed strategies, even in the case when players cannot use private correlation mechanisms, accounting for the cost of calculations allows in repeated games application of punishment strategies based on the achievements of modern cryptography. To demonstrate this, we need two common cryptographic primitives. %Хотя, как было показано ранее, в отсутствие дополнительной информационной асимметрии трёхсторонний чёт-нечет не даёт возможности двум игрокам наказывать третьего, используя только лишь смешанные стратегии, даже в том случае, когда игроки не могут использовать тайные механизмы корреляции, учёт стоимости вычислений позволяет в повторяющихся играх применять стратегии наказания, опирающиеся на достижения современной криптографии. Для демонстрации этого нам понадобятся два распространённых криптографических примитива.

First, \emph{distributed key-agreement protocol} \cite{Boyd} is needed. In cryptography, this term refers to a mechanism by which Alice and Bob can create a common secret sequence of bits, a priori having only public knowledge about the configuration and the parameters of the mechanism itself, through exchanging messages over an insecure communication channel. At the same time, Carol, having the same a priori knowledge and being able to read their messages, cannot calculate the desired secret sequence of bits, since this requires solving an algorithmically difficult problem (one that requires the number of operations that depends exponentially on the key length). For example, the family of Diffie-Hellman (hereinafter DH) protocols based on integer factorization or discrete logarithm (in a finite multiplicative group or on an elliptic curve) problems can act as such a mechanism. Let us describe the general scheme of an arbitrary DH protocol without going into technical details. %Во-первых, необходим \emph{протокол совместной выработки ключа} \cite{Boyd}. В криптографии этим термином называют механизм, при помощи которого Алиса и Боб могут создать общую секретную последовательность битов, априорно обладая лишь публичным знанием об устройстве и параметрах самого механизма, и обмениваясь сообщениями через незащищённый от прослушивания канал связи. При этом Кэрол, обладая тем же априорным знанием и имея возможность читать их сообщения, не может вычислить искомую секретную последовательность битов, поскольку это требует решения алгоритмически трудной задачи (такой, для которой необходимо количество операций, зависящее от длинны ключа экспоненциально). В качестве такого механизма может выступать, например, семейство протоколов Диффи-Хеллмана (далее DH) на основе задач факторизации целых чисел или дискретного логарифмирования (в конечной мультипликативной группе или на эллиптической кривой). Опишем общую схему произвольного протокола DH, не вдаваясь в технические детали.

Let there be a family of bijections $f_n: \mathbb{N}_{<2^n} \leftrightarrow \mathbb{N}_{<2^n}, n \in \mathbb{N}$ that have the one-wayness property, i.e., for any universal computing device $M^*$ holds both $M^*[f_n] \in o(2^n)$ (the cost of calculating the function itself grows polynomially with $n$) and $M^*[f_n^{- 1}] \in \Theta(2^n)$ (the cost of calculating the inverse function grows exponentially with $n$). In addition, let there be a family of binary functions $h_n : \mathbb{N}_{<2^n} \times \mathbb{N}_{<2^n} \rightarrow \mathbb{N}_{<2^n }$ such that %Пусть имеется семейство биекций $f_n: \mathbb{N}_{<2^n} \leftrightarrow \mathbb{N}_{<2^n}, n \in \mathbb{N}$, обладающих свойством односторонности, т.е. для любого универсального вычислителя $M^*$ одновременно выполняется $M^*[f_n] \in o(2^n)$ (стоимость вычисления самой функции растёт с ростом $n$ полиномиально) и $M^*[f_n^{-1}] \in \Theta(2^n)$ (стоимость вычисления обратной функции растёт с ростом $n$ экспоненциально). Кроме этого, пусть имеется семейство двухместных функций $h_n : \mathbb{N}_{<2^n} \times \mathbb{N}_{<2^n} \rightarrow \mathbb{N}_{<2^n}$ таких, что
\begin{itemize}
	\item $\forall x, y \in \mathbb{N}_{<2^n}, h_n(f_n(x), y) = h_n(x, f_n(y))$;
	\item $\forall x, y, z \in \mathbb{N}_{<2^n}, h_n(h_n(x, y), z) = h_n(x, h_n(y, z))$;
	\item $h_n(x_1, y_1) = h_n(x_2, y_2) \Rightarrow x_1 = x_2 \cap y_1 = y_2 \cup x_1 \neq x_2 \cap y_1 \neq y_2$.;
	\item $M^*[h_n] \in o(2^n)$.
\end{itemize}

Alice chooses a random natural number $0 \le x < 2^n$ as her private key and computes $X = f_n(x)$ as her public key. At the other end, Bob similarly generates a pair of keys $y$ and $Y = f_n(y)$. Alice and Bob exchange public keys over the communication channel that Carol is listening to. Now Alice, knowing her private key $x$ and Bob's public key $Y$, can calculate $h_n(x, Y)$, and Bob, respectively, $h_n(X, y)$. Due to the properties of the function $h_n$, the values ​​calculated by them can be considered as the desired shared secret key $K = h_n(x, Y) = h_n(X, y)$. In this case, for Carol, who knows only the public keys $X$ and $Y$, the calculation of the shared secret requires the calculation of either $f_n^{-1}(X)$ or $f_n^{-1}(Y)$. Due to the difference between the asymptotic complexity of the direct and inverse functions, it is always possible to choose $n$ such that the cost of calculating $f_n$ and $h_n$ is acceptable, while calculating $f_n^{-1}$ is prohibitively expensive. Also note that due to the associativity of $h_n$ functions can be considered polyadic, and arbitrary sized groups of agents can combine shared secret keys with publishing each member's public key "--- for example, $K = h_n(x, Y, Z ) = h_n(X, y, Z) = h_n(X, Y, z)$ for three sides. %Алиса выбирает случайное натуральное число $0 \le x < 2^n$, выполняющее роль её закрытого ключа, и вычисляет $X = f_n(x)$, выполняющее роль её открытого ключа. На другом конце Боб аналогичным образом генерирует пару ключей $y$ и $Y = f_n(y)$. Алиса и Боб обмениваются открытыми ключами через прослушиваемый Кэрол канал связи. Теперь Алиса, зная свой закрытый ключ $x$ и открытый ключ Боба $Y$, может вычислить $h_n(x, Y)$, а Боб, соответственно, $h_n(X, y)$. В силу свойств функции $h_n$, вычисленные ими значения можно считать искомым общим секретным ключом $K = h_n(x, Y) = h_n(X, y)$. При этом для Кэрол, знающей только открытые ключи $X$ и $Y$, вычисление общего секретного ключа требует вычисления либо $f_n^{-1}(X)$, либо $f_n^{-1}(Y)$. Благодаря разнице между асимптотической сложностью прямой и обратной функции всегда можно подобрать такое $n$, что стоимости вычисления $f_n$ и $h_n$ оказываются приемлемы, тогда как вычисление $f_n^{-1}$ "--- непозволительно дорогой процесс. Также заметим, что вследствие ассоциативности функции $h_n$ можно считать многоместными, и члены группы агентов любого размера могут комбинировать с их помощью общие секретные ключи, если каждый опубликовал свой открытый ключ "--- например, $K = h_n(x, Y, Z) = h_n(X, y, Z) = h_n(X, Y, z)$ для трёх сторон.

The second cryptographic primitive required for the punishment strategy is \emph{cryptographically strong pseudo-random number generator} \cite{Gutmann}, henceforth referred to as CSPRNG. It can be represented as a family of functions $G_n : \mathbb{N}_{<2^n} \times \mathbb{N} \rightarrow \{0, 1\}$, whose first argument is called the seed, and the second "--- position. A program that calculates for a given $K \in \mathbb{N}_{<2^n}$ the successive values of $G_n(K, i), i = 1, 2, \ldots$, must perform each step over a polynomial in $n$ number of operations, while the generator must pass the test for the next bit, i.e. there must not exist an algorithm polynomially complex in $n$ that can, without knowing $K$ and having the first $i$ bits of generated sequence, to guess $G_n(K, i+1)$ with a probability different from $\frac{1}{2}$. %Вторым криптографическим примитивом, необходимым для стратегии наказания, является \emph{криптографически стойкий генератор псевдослучайных чисел} \cite{Gutmann}, далее называемый CSPRNG. Его можно представить в виде семейства функций $G_n : \mathbb{N}_{<2^n} \times \mathbb{N} \rightarrow \{0, 1\}$, первый аргумент которых называется зерном (или seed), а второй "--- позицией. Программа, вычисляющая для заданного $K \in \mathbb{N}_{<2^n}$ последовательные значения $G_n(K, i), i = 1, 2, \ldots$, должна совершать каждый шаг за полиномиальное от $n$ число операций. При этом генератор обязан проходить тест на следующий бит, т.е. не должно существовать полиномиально сложного от $n$ алгоритма, способного без знания $K$ по первым $i$ битам генерируемой последовательности угадать $G_n(K, i+1)$ с вероятностью, отличной от $\frac{1}{2}$.

Now, using the primitives described above, we can construct three new types of strategies for repeating three-way even"~odd. Imagine that the players are sitting at a round table so that player 1 sits to the right of player 2, player 2 "--- to the right of player 3, and player 3 "--- to the right of player 1. Let's call the first of the new strategies $\mathfrak {s}^L_n$ <<left handshake>>: %Теперь, используя вышеописанные примитивы, можно сконструировать три новых типа стратегий для повторяющегося трёхстороннего чёт-нечета. Представим, что игроки сидят за круглым столом так, что игрок 1 сидит справа от игрока 2, игрок 2 "--- справа от игрока 3, а игрок 3 "--- справа от игрока 1. Назовём первую из новых стратегией $\mathfrak{s}^L_n$ <<рукопожатие влево>>:
\begin{enumerate}
	\item Choose a random number $x \in \mathbb{N}_{<2^n}$. %Выбрать случайное число $x \in \mathbb{N}_{<2^n}$.
	\item Calculate $X = f_n(x)$ and represent it as a bit sequence $(X_i) \in \{0, 1\}^n$. %Вычислить $X = f_n(x)$ и представить в виде битовой последовательности $(X_i) \in \{0, 1\}^n$.
	\item For each $i = 1 \ldots n$ play one round of the game, picking tails if $X_i = 1$ and heads otherwise. Store the strategy chosen by the player sitting on the left (with the same comparison) as the next element of the bit sequence $(Y_i) \in \{0, 1\}^n$ corresponding to the number $Y \in \mathbb{N}_{<2 ^n}$. %Для каждого $i = 1 \ldots n$ совершить один ход игры, выбирая решку при $X_i = 1$ и орла в противном случае. Выбранную сидящим слева игроком стратегию (с тем же сопоставлением) запомнить в качестве очередного элемента битовой последовательности $(Y_i) \in \{0, 1\}^n$, соответствующей числу $Y \in \mathbb{N}_{<2^n}$.
	\item Calculate $K = h_n(x, Y)$. %Вычислить $K = h_n(x, Y)$.
	\item Play all subsequent rounds choosing a strategy in accordance with the sequentially generated CSPRNG values $G_n(K, i), i = 1, 2, \ldots$. %Все последующие ходы совершать, выбирая стратегию в соответствии с последовательно генерируемыми CSPRNG значениями $G_n(K, i), i = 1, 2, \ldots$.
\end{enumerate}

We build the strategy $\mathfrak{s}^R_n$ <<right handshake>> in a similar way, replacing <<left>> with <<right>> and swapping $x$ with $y$, $X$ with $Y$ and $h_n(x, Y)$ with $h_n(X, y)$. These paired strategies with equal key length allow any two players to turn the first $n$ rounds of the game into a sort of <<synching dance>>, producing a shared secret seed for a pseudo-random bit generator whose output on subsequent rounds is used as a correlation mechanism. The third player, if this occurs, has to use the $\mathfrak{s}^*_n$ <<cracking>> strategy to join the agreed upon choice: %Стратегию $\mathfrak{s}^R_n$ <<рукопожатие вправо>> строим аналогичным образом, заменяя <<слева>> на <<справа>> и меняя местами $x$ с $y$, $X$ с $Y$ и $h_n(x, Y)$ с $h_n(X, y)$. Такие парные стратегии с равной длиной ключа позволяют любым двум игрокам превратить первые $n$ ходов игры в своеобразный <<танец синхронизации>>, вырабатывая общее секретное зерно для генератора псевдослучайных битов, чей вывод на последующих ходах используется в качестве механизма корреляции. Третьему игроку, при этом, для присоединения к согласованному выбору приходится применять стратегию $\mathfrak{s}^*_n$ <<взлом>>:
\begin{enumerate}
	\item For the first $n$ rounds, play a mixed strategy of equiprobable choice and memorize opponents' moves to get their public keys $X$ and $Y$. %Первые $n$ ходов играть смешанную стратегию равновероятного выбора и запоминать ходы оппонентов для получения их открытых ключей $X$ и $Y$.
	\item Calculate $K = h_n(f_n^{-1}(X), Y)$ or $K = h_n(X, f_n^{-1}(Y))$. %Вычислить $K = h_n(f_n^{-1}(X), Y)$ или $K = h_n(X, f_n^{-1}(Y))$.
	\item Play all subsequent rounds choosing a strategy in accordance with the sequentially generated CSPRNG values $G_n(K, i), i = 1, 2, \ldots$. %Все последующие ходы совершать, выбирая стратегию в соответствии с последовательно генерируемыми CSPRNG значениями $G_n(K, i), i = 1, 2, \ldots$.
\end{enumerate}

We also denote the strategy $\mathfrak{s}^{\varnothing}$ <<fold>>, when using which the player at each iteration simply chooses between heads and tails randomly and equiprobably. It is easy to see that if we confine ourselves to considering only the four above-listed classes of strategies, then almost all their combinations are indistinguishable in payoffs from the canonical equilibrium point in mixed strategies $u(\mathfrak{s}^{\varnothing}, \mathfrak{s}^{\varnothing}, \mathfrak{s}^{\varnothing}) = (4, 4, 4)$. The only exception is when any two players apply the corresponding <<handshakes>> to each other with the same $n$, and the third player does not apply the <<cracking>> with the same key length "--- for example, $u(\mathfrak{s}^L_n, \mathfrak{s}^R_n, \mathfrak{s}^{\varnothing}) = (4 + \delta^n, 4 + \delta^n, 4 - 2 \delta^n)$: Here, the first two players spend their first $n$ rounds on a key exchange, which is indistinguishable from a random choice in terms of payoffs, and after that they use the common CSPRNG as a correlation mechanism, taking away half of his winnings from the third. If the third could not answer them with a <<cracking>> strategy, then, applying the folk theorem, profiles with two <<handshakes>> could be used as his punishment equilibrium. Since a mutual handshake is possible in any pair of players, cracking prohibition would provide this game with an equilibrium minimax point $(4 - 2 \delta^n, 4 - 2 \delta^n, 4 - 2 \delta^n)$, which for $\ delta^n > \frac{1}{2}$ would allow, for example, to construct perfect subgame equilibria with the payoff vector $(6, 3, 3)$, which is unattainable in any single three-way even"~odd Nash equilibria. %Обозначим также стратегию $\mathfrak{s}^{\varnothing}$ <<пас>>, при использовании которой игрок на каждой итерации просто выбирает между орлом и решкой случайно и равновероятно. Несложно заметить, что если мы ограничимся рассмотрением только четырёх вышеперечисленных классов стратегий, то почти все комбинации любых из них по выплатам неотличимы от классической точки равновесия в смешанных стратегиях $u(\mathfrak{s}^{\varnothing}, \mathfrak{s}^{\varnothing}, \mathfrak{s}^{\varnothing}) = (4, 4, 4)$. Единственным исключением оказываются ситуации, в которой любые два игрока применяют друг на друга соответствующие <<рукопожатия>> с одним и тем же $n$, а третий игрок не применяет <<взлома>> с той же длиной ключа "--- например, $u(\mathfrak{s}^L_n, \mathfrak{s}^R_n, \mathfrak{s}^{\varnothing}) = (4 + \delta^n, 4 + \delta^n, 4 - 2 \delta^n)$. Здесь первые два игрока первые $n$ ходов тратят на обмен ключами, что с точки зрения выплат неотличимо от случайного выбора, а после этого пользуются общим CSPRNG в качестве механизма корреляции, забирая у третьего половину его выигрыша. Если бы третий не мог ответить им стратегией <<взлома>>, то, применяя народную теорему, наборы с двумя <<рукопожатиями>> можно было бы использовать для его равновесного наказания. Поскольку взаимное рукопожатие возможно в любой паре игроков, запрет взломов обеспечил бы этой игре точку равновесного минимакса $(4 - 2 \delta^n, 4 - 2 \delta^n, 4 - 2 \delta^n)$, что при $\delta^n > \frac{1}{2}$ позволяло бы, например, конструировать совершенные подыгровые равновесия с вектором выплат $(6, 3, 3)$, недостижимым ни в одном равновесии по Нэшу однократного трёхстороннего чёт-нечета.

We now show how taking into account the cost of computations allows us to achieve the necessary ban on the <<cracking>> strategy by choosing the key length $n$ correctly. For each of the proposed strategies, we write out the discounted costs of strategy selection: %Покажем теперь, как учёт стоимости вычислений позволяет правильным подбором длины ключа $n$ достичь необходимого запрета на стратегию <<взлома>>. Выпишем для каждой из предложенных стратегий дисконтированные затраты на выбор ходов:
\begin{itemize}
	\item $M^a[\mathfrak{s}^{\varnothing}] = 0$, since for any reasonable computing device, the basic mixed strategies can obviously be considered free or almost free; %поскольку для любого разумно устроенного вычислительного устройства обычные смешанные стратегии, очевидно, можно считать бесплатными или почти бесплатными;
	\item $M^a[\mathfrak{s}^L_n] = M^a[\mathfrak{s}^R_n] = (1 - \delta) M^a[f_n] + \delta ^ n ((1 - \delta) M^a[h_n] + M_a[G_n])$, since for handshake strategies it is necessary to create a pair of keys once before the first move, after $n$ moves calculate the shared secret key, and then generate one CSPRNG bit each round; %поскольку для стратегий рукопожатия необходимо один раз перед первым ходом создать пару ключей, по прошествии $n$ ходов вычислить общий секретный ключ, а потом каждый ход генерировать по одному биту CSPRNG;
	\item $M^a[\mathfrak{s}^*_n] = \delta ^ n ((1 - \delta) (M^a[f_n^{-1}] + M^a[h_n]) + M_a[G_n])$, because for the cracking strategy it is necessary to calculate the secret key once after $n$ moves, having only a pair of public keys, and then generate one bit of CSPRNG every round. %поскольку для стратегии взлома необходимо один раз по прошествии $n$ ходов, имея только пару публичных ключей, вычислить секретный ключ, а потом каждый ход генерировать по одному биту CSPRNG.
\end{itemize}

Let us now check the situation $(\mathfrak{s}^L_n, \mathfrak{s}^R_n, \mathfrak{s}^{\varnothing})$ for Nash equilibrium, taking into account the cost of computations. For the first two players, it is required that the costs of cryptographic synchronization do not exceed the income from the tail of the rounds, i.e. $\frac{1 - \delta}{\delta^n} M^a[f_n] + (1 - \delta) M^a[h_n] + M^a[G_n] \le 1$. It is easy to see that as long as $M^a[G_n] < 1$, you can always choose $\delta$ large enough to level out one-time preparatory costs. For the third player, on the contrary, it is necessary to select a sufficiently large bit length of the key so that the procedure for cracking it turns out to be more expensive than the potential income in the tail of the rounds, i.e. $(1 - \delta) (M^a[f_n^{-1}] + M^a[h_n]) + M_a[G_n] \ge 2$. Here, the exponentially growing cost of inverting the one-way function "--- for $M^a[f_n^{-1}] \ge \frac{2}{1 - \delta}$, joining the correlated strategy completely loses meaning. Thus, for the point under consideration to be a Nash equilibrium, it is sufficient that the following set of conditions be satisfied: %Проверим теперь ситуацию $(\mathfrak{s}^L_n, \mathfrak{s}^R_n, \mathfrak{s}^{\varnothing})$ на равновесие по Нэшу с учётом расходов на вычисления. Для первых двух игроков требуется, чтобы затраты на криптографическую синхронизацию не превысили доход от хвоста розыгрыша, т.е. $\frac{1 - \delta}{\delta^n} M^a[f_n] + (1 - \delta) M^a[h_n] + M^a[G_n] \le 1$. Несложно заметить, что до тех пор, пока $M^a[G_n] < 1$, всегда можно подобрать $\delta$ достаточно большое для нивелирования разовых подготовительных расходов. Для третьего же игрока наоборот, приходится подбирать достаточно большую битовую длину ключа, чтобы процедура его взлома оказалась дороже, чем потенциальный доход в хвосте розыгрыша, т.е. $(1 - \delta) (M^a[f_n^{-1}] + M^a[h_n]) + M_a[G_n] \ge 2$. Здесь уже в качестве главного компонента выступает экспоненциально растущая стоимость обращения односторонней функции "--- при $M^a[f_n^{-1}] \ge \frac{2}{1 - \delta}$ присоединение к коррелированной стратегии полностью теряет смысл. Таким образом, чтобы рассматриваемая точка была равновесием по Нэшу, достаточно выполнения следующего набора условий:% для некоторого $0 < \gamma < 1$:
\begin{equation*}
	\begin{cases}
		(1 - \delta)(\delta^{-n} M^1[f_n] + M^1[h_n]) + M^1[G_n] < 1; \\
		(1 - \delta)(\delta^{-n} M^2[f_n] + M^2[h_n]) + M^2[G_n] < 1; \\
		(1 - \delta) M^3[f_n^{-1}] \ge 2.
	\end{cases}
\end{equation*}
%\begin{equation*}
%	\begin{cases}
%		M^{1,2}[G_n] < 1 - \gamma; \\
%		\frac{M^{1,2}[f_n]}{\delta^n} + M^{1,2}[h_n] \le \frac{\gamma}{1 - \delta}; \\
%		M^3[f_n^{-1}] \ge \frac{2}{1 - \delta}.
%	\end{cases}
%\end{equation*}

Since we are talking about comparing the performance of abstract computing devices with dimensionless quantities characterizing the preferences of rational agents, attempts to prove any formal statements regarding the compatibility of this system of inequalities seem unproductive. Nevertheless, we may still try to map the range of admissible values $n$ and $\delta$ marked out by inequations onto the corresponding objects of the real world. In practice, cryptosystems that use discrete logarithms on elliptic curves are considered secure already with 256-bit keys (Curve25519 \cite{Bernstein}, for example), i.e. the cost of breaking them certainly exceeds the capabilities available to human civilization at the current stage of technological development. At the same time, pseudo-random number generators with 256-bit seeds exist and are widely used, while being considered cryptographically secure (CTR-DRBG \cite{Hoang}, for example). This gives the discount factor an acceptability range of $0 < \epsilon \le 1 - \delta \le \frac{1}{370}$, and since the calculation of $f_{256}^{-1}$ is currently considered impossible, $\epsilon$ can be considered infinitely small. Thus, if players who have modern computing devices at their disposal play repeated three-way even-odd with real stakes, then the length of the series starting from several hundred rounds will be enough for the use of cryptographic strategy syncing to become a real way to gain an advantage. %Поскольку речь идёт о сравнении производительности абстрактных вычислительных устройств с безразмерными величинами, характеризующими предпочтения рациональных агентов, попытки доказательства каких-либо формальных утверждений относительно совместимости этой системы неравенств представляются малопродуктивными. Тем не менее, мы вполне можем попробовать отобразить выделенную неравенствами область допустимых величин $n$ и $\delta$ на соответствующие объекты реального мира. На практике криптосистемы, использующие дискретное логарифмирование на эллиптических кривых, считаются надёжными уже при 256-битных ключах (Curve25519 \cite{Bernstein}, например), т.е. стоимость их взлома заведомо превосходит возможности, доступные человеческой цивилизации на текущем этапе технологического развития. Одновременно с этим существуют и широко используются генераторы псевдослучайных чисел с 256-битным зерном, считающиеся криптографически стойкими (CTR-DRBG \cite{Hoang}, например). Это задаёт для дисконтирующего коэффициента диапазон приемлемости $0 < \epsilon \le 1 - \delta \le \frac{1}{370}$, причём, поскольку вычисление $f_{256}^{-1}$ на данный момент считается невозможным, $\epsilon$ можно считать бесконечно малым. Таким образом, если игроки, в распоряжении которых находятся современные вычислительные устройства, будут играть с реальными ставками в повторяющийся трёхсторонний чёт-нечет, то протяжённости серий от нескольких сотен розыгрышей окажется достаточно, чтобы применение криптографического согласования стратегий стало реальным способом получить преимущество.

\section{Folk theorem for games considering the cost of computation}\label{sec:ch3/sect5}

Using a refined version of the <<folk>> theorem, the trick demonstrated in the previous section can be generalized to expand the set of perfect subgame equilibria of any repeated game, individual iterations of which are sensitive to additional information asymmetry. To this end, sets correlated in a conspiracy space consisting of a single group including all players except the one being punished can be used as punishments for a player who deviates from the prescribed strategy. Since, in this case, the strategies depend on no more than one correlation mechanism, we can simplify the reasoning by passing to probability distributions on the payoff matrix. Considering the game $\Gamma = \langle A, S^a, u^a(s), a \in A \rangle$ with sets of participants $A = \{1, \ldots, m\}$ and outcomes $S = S^1 \times \ldots \times S^m$ respectively, let's introduce the notation: %При помощи уточнённого варианта <<народной>> теоремы продемонстрированный в предыдущем разделе фокус можно обобщить для пополнения множества совершенных подыгровых равновесий любой повторяющейся игры, отдельные итерации которой чувствительны к дополнительной информационной асимметрии. С этой целью в качестве наказаний для игрока, отклоняющегося от предписанной стратегии, могут использоваться наборы, коррелированные в пространстве заговоров, состоящем из единственной группы, включающей всех игроков кроме самого наказываемого. Поскольку при этом стратегии зависят не более чем от одного корреляционного механизма, можно упростить рассуждения, перейдя к вероятностным распределениям на платёжной матрице. Рассматривая игру $\Gamma = \langle A, S^a, u^a(s), a \in A \rangle$ с множествами участников $A = \{1, \ldots, m\}$ и исходов $S = S^1 \times \ldots \times S^m$ соответственно, введём обозначения:
\begin{align*}
	\mathbf{P}_S &= \{\mu : S \rightarrow [0, 1] \mid \sum_{s \in S} \mu(s) = 1\}; \\
	\mathbf{P}_S^{\setminus a} &= \{\mu \in \mathbf{P}_S \mid \forall s_1, s_2 \in S, s^a \in S^a, \mu(s_1) \mu(s_2 | s^a) = \mu(s_2) \mu(s_1 | s^a)\}.
\end{align*}

Here $\mathbf{P}_S$ represents all possible probability measures on the set of outcomes $S$, and $\mathbf{P}_S^{\setminus a}$ "--- all probability measures guaranteeing the pairwise independence of the strategy choice between player $a$ and everyone else. Obviously, the payouts are calculated according to the expectation formula: %Здесь $\mathbf{P}_S$ представляет собой всевозможные вероятностные меры на множестве исходов $S$, а $\mathbf{P}_S^{\setminus a}$ "--- все вероятностные меры, гарантирующие попарную независимость выбора стратегии игроком $a$ с действиями всех остальных. Очевидно, выплаты при этом вычисляются по формуле математического ожидания:
\begin{equation*}
	u^a(\mu) = \sum_{s \in S} \mu(s) u^a(s).
\end{equation*}

In addition, for convenience, we denote the deviation of the player $a$ in favor of the pure strategy $s^a_0$ in a similar way to the classical notation: %Кроме того, для удобства обозначим девиацию игрока $a$ в пользу чистой стратегии $s^a_0$ аналогичным классической нотации образом:
\begin{equation*}
	\mu | s^a_0(s) =
	\begin{cases}
		\sum_{s^a_* \in S^a} \mu(s | s^a_*), & s^a = s^a_0; \\
		0, & s^a \neq s^a_0.
	\end{cases}
\end{equation*}

Now we can finally introduce the notion of reserve payoff refined for the model under consideration: %Теперь можно наконец ввести уточнённое для рассматриваемой модели понятие о резервном выигрыше:
\begin{definition}
	The blind reserve payoff of player $a$ in the game $\Gamma$ is his reserve payoff $u^a(\check{\mu}^a)$ in the game $\Gamma | \{A \setminus \{a\}\}$, i.e. with a conspiracy uniting all players except him: %Слепым резервным выигрышем игрока $a$ в игре $\Gamma$ называется его резервный выигрыш $u^a(\check{\mu}^a)$ в игре $\Gamma | \{A \setminus \{a\}\}$, т.е. с заговором, объединяющим всех игроков кроме него:
	\begin{equation*}
		\check{\mu}^a \in \arg\min_{\mu \in \check{\mathbf{P}}} u^a(\mu),
	\end{equation*}
	where $\check{\mathbf{P}} = \{\mu \in \mathbf{P}_S^{\setminus a} \mid u^a(\mu) \ge u^a(\mu | s^a), \forall s^a \in S^a\}$.
\end{definition}
%\begin{definition}
%	Равновесным слепым резервным выигрышем игрока $a$ в игре $\Gamma$ называется его равновесный резервный выигрыш $u^a(\bar{\mu}^a)$ в игре с тем же заговором:
%	\begin{equation*}
%		\bar{\mu}^a \in \arg\min_{\mu \in \bar{\mathbf{P}}} u^a(\mu),
%	\end{equation*}
%	где $\bar{\mathbf{P}}$ "--- множество распределений, достижимых в равновесиях по Нэшу игры $\Gamma | \{A \setminus \{a\}\}$.
%\end{definition}

%Поскольку для наказания слепыми резервными выигрышами используется незнание наказываемым игроком общего секретного ключа, необходимо также учитывать его возможный доход при <<взломе>> процедуры DH путём обращения односторонней функции. Введём дополнительные обозначения:
%\begin{align*}
%	\Delta \check{u}^a &= \max_{s \in S, \check{\mu}^a(s) > 0} u^a(s) - u^a(\check{\mu}^a); \\
%	\Delta \bar{u}^a &= \max_{s \in S, \bar{\mu}^a(s) > 0} u^a(s) - u^a(\bar{\mu}^a);
%\end{align*}
%для наибольшего увеличения выигрыша, которого может достигнуть наказываемый игрок, взламывая ключи обычного и равновесного слепого наказания.

For the classical folk theorem, reserve payoffs directly determine the corresponding minimax point, but in our case, things are a little more complicated. Since CSPRNGs are used to synchronize both the prescribed strategies and the punishments, the cost of calculating the sequence of pseudo-random bits required to select the strategy profile must be taken into account. Let $\mathfrak{b}(\mu) \in \mathbb{R}_{\ge 0}$ denote the average number of bits required to select a correlated set of strategies using the following procedure. We enumerate all outcomes $\{s_1, \ldots, s_k\} \subseteq S$ participating in $\mu$ with nonzero probability, and construct a grid of non-decreasing numbers $\rho = (\rho_0 = 0, \rho_1, \ldots, \rho_{k - 1}, \rho_k = 1)$ in the unit interval $\left[0, 1\right)$ splitting it so that $\rho_j - \rho_{j-1} = \mu(s_j), j = \overline{1,k}$. %Для классической народной теоремы резервные выигрыши напрямую определяют соответствующую точку минимакса, однако в нашем случае всё немного сложнее. Поскольку для синхронизации как предписанных стратегий, так и наказаний используются CSPRNG, необходимо учитывать стоимость вычисления необходимой для выбора стратегического набора последовательности псевдослучайных битов. Обозначим символом $\mathfrak{b}(\mu) \in \mathbb{R}_{\ge 0}$ среднее количество бит, необходимое для выбора коррелированного набора стратегий по следующей процедуре. Занумеруем все исходы $\{s_1, \ldots, s_k\} \subseteq S$, участвующие в $\mu$ с ненулевой вероятностью, и построим в единичном интервале $\left[0, 1\right)$ сетку неубывающих чисел $\rho = (\rho_0 = 0, \rho_1, \ldots, \rho_{k - 1}, \rho_k = 1)$ разбивающую его таким образом, что $\rho_j - \rho_{j-1} = \mu(s_j), j = \overline{1,k}$.

\begin{enumerate}
	\item Let $\mathcal{X}_{min} = 0$ and $\mathcal{X}_{max} = 1$. %Положим $\mathcal{X}_{min} = 0$ и $\mathcal{X}_{max} = 1$.
	\item Check if there is $j$ such that $\rho_{j-1} \le \mathcal{X}_{min} < \mathcal{X}_{max} \le \rho_j$. If there is, we stop the algorithm by settling on the choice of the strategic profile $s_j$. %Проверим, нет ли такого $j$, что $\rho_{j-1} \le \mathcal{X}_{min} < \mathcal{X}_{max} \le \rho_j$. Если есть, остановим алгоритм, приняв решение о выборе стратегического набора $s_j$.
	\item Generate the next bit of the pseudo-random sequence. The value $\frac{\mathcal{X}_{min} + \mathcal{X}_{max}}{2}$ in the case of $0$ is assigned to the variable $\mathcal{X}_{max}$, and in the case of $1$ "--- to the $\mathcal{X}_{min}$. %Сгенерируем очередной бит псевдослучайной последовательности. Значение $\frac{\mathcal{X}_{min} + \mathcal{X}_{max}}{2}$ в случае $0$ присвоим переменной $\mathcal{X}_{max}$, а в случае $1$ "--- $\mathcal{X}_{min}$.
	\item Move back to step 2. %Перейдём к шагу 2.
\end{enumerate}

If all players use a CSPRNG with the same seed, it is obvious that they will end up in the same strategy profile utilizing the same number of pseudo-random bits, depending on the average only on the probability distribution $\mu$. Therefore, the expected income of player $a$, taking into account the cost of calculations, can be represented as $u_{M,n}^a(\mu) = u^a(\mu) - \mathfrak{b}(\mu) M^a[G_n]$, where $M^a[G_n]$ is the cost of generating one pseudo-random bit. Note that the value obtained also depends on $n$, i.e. the bit length of the used CSPRNG seed, which begs to replace the concept of a minimax point with a more complex definition: %Если все игроки используют CSPRNG с одним и тем же зерном, очевидно, что они выберут один и тот же набор стратегий, использовав при этом одно и то же количество псевдослучайных битов, в среднем зависящее только от распределения вероятностей $\mu$. Следовательно, ожидаемый доход игрока $a$ с учётом стоимости вычислений можно представить как $u_{M,n}^a(\mu) = u^a(\mu) - \mathfrak{b}(\mu) M^a[G_n]$, где $M^a[G_n]$ "--- стоимость генерации одного псевдослучайного бита. Заметим, что полученное значение зависит ещё и от $n$, т.е. битовой длины используемого зерна CSPRNG, что приводит к необходимости заменять понятие о точке минимакса более сложным определением:

\begin{definition}
%	Для каждого распределения $\mu$ на множестве исходов игры в нормальной форме $\Gamma = \langle A, S^a, u^a(s), a \in A \rangle$ 
	A probability distribution $\mu$ on the set of outcomes in normal form game $\Gamma = \langle A, S^a, u^a(s), a \in A \rangle$ is called $M,n$-acceptable if $u_{M,n}^a(\mu) > u^a(\check{\mu}^a)$ for each player $a \in A$. %Распределение вероятностей $\mu$ на множестве исходов игры в нормальной форме $\Gamma = \langle A, S^a, u^a(s), a \in A \rangle$ называется $M,n$-приемлемым, если $u_{M,n}^a(\mu) > u^a(\check{\mu}^a)$ для каждого игрока $a \in A$. %В случае $u_{M,n}^a(\mu) > u^a(\bar{\mu}^a)$, его можно называть равновесно $M,n$-приемлемым.
\end{definition}

Note that we have so far talked about how players use CSPRNGs with a common seed to synchronize their actions, without specifying how exactly this common seed is generated. Similar to the example from the previous section, in this guise we will use the shared secret keys calculated using the DH protocol. Let us describe the procedure for generating and publishing keys. First, each player $a$ chooses a random real number $\chi^a$ uniformly distributed over the range $\left[0, 2^n\right)$. The rounding of this number $x^a = \lfloor\chi^a\rfloor \in \mathbb{N}_{<2^n}$ is used by him as a private key. Using a one-way function, the player calculates the public key $X^a = f(x^a) \in \mathbb{N}_{<2^n}$. To exchange $X^a$ values, players can use any distinctive \emph{totally mixed} strategy profile: %Заметим, что мы пока говорили о том, как игроки используют для синхронизации действий CSPRNG с общим зерном, не уточняя, как именно это общее зерно вырабатывается. Аналогично примеру из предыдущего раздела в этом качестве будем использовать общие секретные ключи, вычисляемые по протоколу DH. Опишем процедуру для генерации и публикации ключей. Сперва каждый игрок $a$ выбирает случайное вещественное число $\chi^a$, равномерно распределённое в диапазоне $\left[0, 2^n\right)$. Округление этого числа $x^a = \lfloor\chi^a\rfloor \in \mathbb{N}_{<2^n}$ используется им далее в качестве закрытого ключа. При помощи односторонней функции игрок вычисляет открытый ключ $X^a = f(x^a) \in \mathbb{N}_{<2^n}$. Для обмена значениями $X^a$ игроки могут использовать любой условленный \emph{тотально смешанный} набор стратегий:

\begin{definition}
	A mixed strategy profile is said to be totally mixed when it does not contain a single pure strategy. %Набор смешанных стратегий назовём тотально смешанным, когда в его составе нет ни одной чистой стратегии.
\end{definition}

Since $f$ is a bijection, the random variable $\mathcal{X}^a = \chi^a - x^a + X^a$ is also uniformly distributed in the range $\left[0, 2^n\right)$. In order to reveal his value of $X^a$ to other players, each player uses the <<fractal>> method of encoding the number $\mathcal{X}^a$ in the sequence of moves he makes, indistinguishable in probability distribution from a mixed strategies $s_0^a = (p^a_1, \ldots, p^a_{\lvert S^a \rvert})$ from the distinctive totally mixed profile $s_0$. Let us construct in the unit interval $\left[0, 1\right)$ a grid of non-decreasing numbers $\rho^a = (\rho^a_0 = 0, \rho^a_1, \ldots, \rho^a_{\lvert S^a \rvert - 1}, \rho^a_{\lvert S^a \rvert} = 1)$ splitting it in such a way that $\rho^a_j - \rho^a_{j-1} = p^a_j, j = \overline{1,\lvert S^a \rvert}$. This allows the following encoding algorithm to be applied: %Поскольку $f$ "--- биекция, случайная величина $\mathcal{X}^a = \chi^a - x^a + X^a$ также равномерно распределена в диапазоне $\left[0, 2^n\right)$. Для того, чтобы раскрыть другим игрокам своё значение $X^a$, каждый игрок использует метод <<фрактального>> кодирования числа $\mathcal{X}^a$ в последовательности совершаемых им ходов, неотличимых по вероятностному распределению от смешанной стратегии $s_0^a = (p^a_1, \ldots, p^a_{\lvert S^a \rvert})$ из условленного тотально смешанного набора $s_0$. Построим в единичном интервале $\left[0, 1\right)$ сетку неубывающих чисел $\rho^a = (\rho^a_0 = 0, \rho^a_1, \ldots, \rho^a_{\lvert S^a \rvert - 1}, \rho^a_{\lvert S^a \rvert} = 1)$ разбивающую его таким образом, что $\rho^a_j - \rho^a_{j-1} = p^a_j, j = \overline{1,\lvert S^a \rvert}$. Это позволяет применить следующий алгоритм кодирования:

\begin{enumerate}
	\item Before making the first move, other players know that $\mathcal{X}^a$ is uniformly distributed in the interval $\left[0, 2^n\right)$. Let $\mathcal{X}^a_{min} = 0$ and $\mathcal{X}^a_{max} = 2^n$. %До совершения первого хода другие игроки знают, что $\mathcal{X}^a$ равномерно распределено в интервале $\left[0, 2^n\right)$. Положим $\mathcal{X}^a_{min} = 0$ и $\mathcal{X}^a_{max} = 2^n$.
	\item Let us scale $\rho^a$ over the interval $\left[\mathcal{X}^a_{min}, \mathcal{X}^a_{max}\right)$, getting the embedded in it mesh $\mathcal{P}^a = (\mathcal{X}^a_{min} (1 - \rho^a_j) + \mathcal{X}^a_{max} \rho^a_j, j = \overline{0, \lvert S^a \rvert})$. %Отмасштабируем $\rho^a$ на интервал $\left[\mathcal{X}^a_{min}, \mathcal{X}^a_{max}\right)$, получив вложенную в него сетку $\mathcal{P}^a = (\mathcal{X}^a_{min} (1 - \rho^a_j) + \mathcal{X}^a_{max} \rho^a_j, j = \overline{0, \lvert S^a \rvert})$.
	\item At the next iteration, choose $s^a_j$ such that $\mathcal{P}^a_{j-1} \le \mathcal{X}^a < \mathcal{P}^a_j$. %Выберем на очередной итерации $s^a_j$ такое, что $\mathcal{P}^a_{j-1} \le \mathcal{X}^a < \mathcal{P}^a_j$.
	\item Now the other players know that $\mathcal{X}^a$ is uniformly distributed over the interval $\left[\mathcal{P}^a_{j-1}, \mathcal{P}^a_j\right)$. Let's go back to step 2 by setting $\mathcal{X}^a_{min} = \mathcal{P}^a_{j-1}$ and $\mathcal{X}^a_{max} = \mathcal{P}^ a_j$. %Теперь другие игроки знают, что $\mathcal{X}^a$ равномерно распределено в интервале $\left[\mathcal{P}^a_{j-1}, \mathcal{P}^a_j\right)$. Вернёмся к шагу 2, положив $\mathcal{X}^a_{min} = \mathcal{P}^a_{j-1}$ и $\mathcal{X}^a_{max} = \mathcal{P}^a_j$.
\end{enumerate}

This algorithm can be executed indefinitely, gradually decreasing the other players' lack of knowledge about the value of $\mathcal{X}^a$. Moreover, at each individual iteration, the distribution of outcome probabilities is indistinguishable from the set of mixed strategies $s_0$. At the moment when the inequality $X^a \le \mathcal{X}^a_{min} < \mathcal{X}^a_{max} \le X^a + 1$ begins to hold, other players gain confidence about the value of $X^a$, and the public key of player $a$ is reputed as published. If all players start publishing keys at the same time, then the expected number of iterations until the publication of the last one is completed depends only on the utilized strategy profile $s_0$ and the value of $n$, so it can be denoted by the symbol $\mathfrak{t}(s_0, n) \in \mathbb{N}$. %Этот алгоритм может выполняться бесконечно, постепенно уменьшая меру незнания других игроков относительно величины $\mathcal{X}^a$. При этом на каждой отдельной итерации распределение вероятностей исходов неотличимо от набора смешанных стратегий $s_0$. В тот момент когда начинает выполняться неравенство $X^a \le \mathcal{X}^a_{min} < \mathcal{X}^a_{max} \le X^a + 1$, другие игроки получают уверенность относительно значения $X^a$, и открытый ключ игрока $a$ можно считать опубликованным. Если все игроки начинают публикацию ключей одновременно, то ожидаемое количество итераций до завершения публикации последнего из них зависит только от используемого стратегического набора $s_0$ и величины $n$, так что его можно обозначить символом $\mathfrak{t}(s_0, n) \in \mathbb{N}$.

Before proceeding to the analogue of the folk theorem for repeated games, taking into account the cost of calculations, it is necessary to introduce one more notation. The vector $\Delta u = (\Delta u^a, a \in A) \in \mathbb{R}_{\ge 0}^m$, where %Прежде чем переходить к аналогу народной теоремы для повторяющихся игр с учётом стоимости вычислений, необходимо ввести ещё одно обозначение. Вектор $\Delta u = (\Delta u^a, a \in A) \in \mathbb{R}_{\ge 0}^m$, где
\begin{equation*}
	\Delta u^a = \max_{s \in S, s^a_* \in S^a} (u^a(s | s^a_*) - u^a(s)),
\end{equation*}
consists of the maximum income that each player can receive by deviating from a strategy out of arbitrary prescribed profile. %состоит из максимальных доходов, которые может получить каждый игрок, отклоняясь от стратегии из произвольного предписанного набора.

\begin{theorem}
	Let $\Gamma = \langle A, S^a, u^a(s), a \in A \rangle$ be an arbitrary matrix game of $m$ players that has at least one totally mixed equilibrium $s_0$. Let $M = (M^1, \ldots, M^m)$ be a collection of universal computing devices that the respective players can use to select the next step of a strategy in a repeated game. Let $(\Gamma)_M^{\delta}$ be an infinitely repeated game with $\Gamma$ iteration, $\delta$ discounting factor and taking into account the cost of operating computing devices $M$. Any $M,n$-acceptable probability distribution $\mu$ on the set of the game $\Gamma$ outcomes can be associated with a strategy profile for the game $(\Gamma)_M^{\delta}$ with the payoffs of each player $a$ equal to %Пусть $\Gamma = \langle A, S^a, u^a(s), a \in A \rangle$ "--- произвольная матричная игра $m$ участников, имеющая хотя бы одно тотально смешанное равновесие $s_0$. Пусть $M = (M^1, \ldots, M^m)$ "--- набор универсальных вычислительных устройств, которые соответствующие игроки могут использовать для выбора очередного шага стратегии в повторяющейся игре. Пусть $(\Gamma)_M^{\delta}$ "--- бесконечно повторяющаяся игра с итерацией $\Gamma$, дисконтирующим коэффициентом $\delta$ и учётом стоимости эксплуатации вычислительных устройств $M$. Любому $M,n$-приемлемому распределению вероятностей $\mu$ на множестве исходов игры $\Gamma$ можно поставить в соответствие набор стратегий игры $(\Gamma)_M^{\delta}$ с выплатами каждого игрока $a$, равными %$v^a_{SYNC} + \delta^{\mathfrak{t}(s_0, n)} u_{M,n}^a(\mu)$, где
	\begin{equation*}
		(1 - \delta^{\mathfrak{t}(s_0, n)}) u^a(s_0) + \delta^{\mathfrak{t}(s_0, n)} u_{M,n}^a(\mu) - (1 - \delta) (M^a[f_n] + \delta^{\mathfrak{t}(s_0, n)} (m - 1) M^a[h_n]).
	\end{equation*}
	
	Upon that, in order for this profile to be a Nash equilibrium, it is sufficient to satisfy the following conditions for each $a \in A$: %При этом для того, чтобы этот набор оказался равновесием по Нэшу, достаточно выполнения следующих условий для каждого $a \in A$:
	\begin{enumerate}
		\item $(1 - \delta) (M^a[f_n] + \delta^{\mathfrak{t}(s_0, n)} (m - 1) M^a[h_n]) < \delta^{\mathfrak{t}(s_0, n)}(u_{M,n}^a(\mu) - u^a(\check{\mu}^a))$;
		\item $(1 - \delta) \Delta u^a < \delta (u_{M,n}^a(\mu) - u^a(\check{\mu}^a))$;
		\item $(1 - \delta) M^a[f_n^{-1}] > \delta \Delta u^a$.
	\end{enumerate}
%
%	При замене в условиях обычного слепого наказания $\check{\mu}^a$ на равновесное слепое наказание $\bar{\mu}^a$, результирующее равновесие становится совершенным подыгровым.
\end{theorem}

\begin{proof}[Proof]
	The equilibrium corresponding to the $M,n$-acceptable probability distribution $\mu$ is constructed as a three-stage process: %Равновесие, соответствующее $M,n$-приемлемому распределению вероятностей $\mu$ строится как трёхэтапный процесс:
	\begin{itemize}
		\item \emph{Synchronization.} First, each player $a$ creates a key pair of length $n$, incurring a loss equal to $(1 - \delta) M^a[f_n]$. Then, using the fractal coding algorithm described above over a totally mixed equilibrium $s_0$, he publishes his public key. This phase continues until all keys have been published, which takes $\mathfrak{t}(s_0, n)$ moves on average, giving a total payoff of $(1 - \delta^{\mathfrak{t}(s_0 , n)}) u^a(s_0)$. The stage ends with the calculation of the shared secret key, for which the function $h_n$ needs to be calculated $m - 1$ times by each player, which corresponds to a loss of $(1 - \delta) \delta^{\mathfrak{t}(s_0, n)} (m - 1) M^a[h_n]$. %\emph{Синхронизация.} Сперва каждый игрок $a$ создаёт пару ключей длины $n$, терпя при этом убыток равный $(1 - \delta) M^a[f_n]$. Затем, используя вышеописанный алгоритм фрактального кодирования в тотально смешанном равновесии $s_0$, публикует свой открытый ключ. Эта фаза продолжается до тех пор, пока не будут опубликованы все ключи, что в среднем займёт $\mathfrak{t}(s_0, n)$ ходов, давая суммарный выигрыш $(1 - \delta^{\mathfrak{t}(s_0, n)}) u^a(s_0)$. Завершается стадия вычислением общего секретного ключа, для чего каждому игроку необходимо $m - 1$ раз вычислить функцию $h_n$, что соответствует убытку размером $(1 - \delta) \delta^{\mathfrak{t}(s_0, n)} (m - 1) M^a[h_n]$.
		\item \emph{Playout.} Using a CSPRNG initiated by a shared secret, the players at each iteration pseudo-randomly choose a new pure strategy profile according to the distribution $\mu$, so that each player $a$ gets on infinite repetition the expected total payoff $\delta^{\mathfrak{t}(s_0, n)} u_{M,n}^a(\mu)$. If none of the players deviated from the prescribed behavior either at the previous stage or at this stage, then the final payoffs in the limit correspond to those predicted in the statement of the theorem. %\emph{Розыгрыш.} Используя CSPRNG, инициируемое общим секретным ключом, игроки на каждой итерации псевдослучайно выбирают в соответствии с распределением $\mu$ новый набор чистых стратегий, так что каждый игрок $a$ получает при бесконечном повторении ожидаемый суммарный выигрыш $\delta^{\mathfrak{t}(s_0, n)} u_{M,n}^a(\mu)$. Если ни один из игроков не отклонился от предписанного поведения ни на предыдущей стадии, ни на этой, то итоговые выплаты в пределе соответствуют предсказанным в формулировке теоремы.
		\item \emph{Punishment.} If any of the players in the playout phase choose a pure strategy that does not align with the prescribed by CSPRNG, the other players switch to his punishment mode. The same thing happens immediately after the synchronization stage, if through it one of the players ignores the key generation procedure. To do this, they calculate a new shared secret key, this time excluding the public key of the penalized player $a$. Initiating the CSPRNG with this new key, they pseudo-randomly select a new pure strategy profile at each iteration according to the $\check{\mu}^{a}$ distribution. %\emph{Наказание.} Если любой из игроков на стадии розыгрыша выбирает чистую стратегию, не соответствующую предписанной CSPRNG, остальные игроки переключаются в режим его наказания. То же самое происходит сразу после стадии синхронизации, если на ней кто-то из игроков игнорирует процедуру создания ключей. Для этого они вычисляют новый общий секретный ключ, на этот раз исключая публичный ключ наказываемого игрока $a$. Инициировав CSPRNG этим новым ключом, они на каждой итерации псевдослучайно выбирают новый набор чистых стратегий в соответствии с распределением $\check{\mu}^{a}$. %или $\bar{\mu}^{a_*}$, в зависимости от необходимости получить обычное или совершенное подыгровое равновесие по Нэшу.
	\end{itemize}

	Several kinds of individual deviations are possible from this scheme of prescribed actions. First, at the synchronization stage, any player $a$ can try to cut corners by forgoing creation of a key pair and calculation of a shared secret key. Since the profile $s_0$ is a Nash equilibrium, it is not possible to improve the payoff comparing to $(1 - \delta^{\mathfrak{t}(s_0, n)}) u^a(s_0)$, but you can use a simple mixed strategy instead to avoid cryptography costs of $(1 - \delta) (M^a[f_n] + \delta^{\mathfrak{t}(s_0, n)} (m - 1) M^a[h_n])$. The reaction to this decision is the transition of the other players to the stage of player $a$ punishment immediately after the publication of the keys is completed, so that instead of $\delta^{\mathfrak{t}(s_0, n)} u_{M,n}^a(\mu)$ at the end of the round, the player receives $\delta^{\mathfrak{t}(s_0, n)} u^a(\check{\mu}^a)$. Such a deviation is made unfavorable by the restriction on $\delta$ imposed by condition 1 of the statement of the theorem. %От этой схемы предписанных действий возможны несколько видов индивидуальных отклонений. Во-первых, на стадии синхронизации любой игрок $a$ может попытаться сэкономить путём отказа от создания пары ключей и вычисления общего секретного ключа. Поскольку набор $s_0$ равновесен по Нэшу, улучшить выигрыш по сравнению с $(1 - \delta^{\mathfrak{t}(s_0, n)}) u^a(s_0)$ не получится, но можно используя простую смешанную стратегию избежать расходов на криптографию в размере $(1 - \delta) (M^a[f_n] + \delta^{\mathfrak{t}(s_0, n)} (m - 1) M^a[h_n])$. Реакцией на это решение становится переход остальных игроков к стадии наказания игрока $a$ сразу по завершении публикации ключей, так что вместо $\delta^{\mathfrak{t}(s_0, n)} u_{M,n}^a(\mu)$ в хвосте розыгрыша игрок получает $\delta^{\mathfrak{t}(s_0, n)} u^a(\check{\mu}^a)$. Такое отклонение делает невыгодным ограничение на $\delta$, накладываемое условием 1 формулировки теоремы.
	
	Secondly, at the main stage of the playout, any player $a$ can, having calculated the next pseudo-random profile $s_i$, refuse to play the prescribed strategy $s_i^a$ in favor of a more profitable one, receiving a one-time income not exceeding $(1 - \delta) \delta^i \Delta u^a$. Noticing this, the rest of the players go to the punishment stage, which reduces his income in the tail of the draw from $\delta^{i+1} u_{M,n}^a(\mu)$ to $\delta^{i+1} u^a(\check{\mu}^a)$. Such a deviation is made unfavorable by the restriction on $\delta$ imposed by condition 2 of the statement of the theorem. %Во-вторых, на основной стадии розыгрыша любой игрок $a$ может, вычислив очередной псевдослучайный набор $s_i$ отказаться играть предписанную стратегию $s_i^a$ в пользу более выгодной, получив разовый доход, не превосходящий $(1 - \delta) \delta^i \Delta u^a$. Заметив это, остальные игрокаи переходят к стадии наказания, что уменьшает его доход в хвосте розыгрыша с $\delta^{i+1} u_{M,n}^a(\mu)$ до $\delta^{i+1} u^a(\check{\mu}^a)$. Такое отклонение делает невыгодным ограничение на $\delta$, накладываемое условием 2 формулировки теоремы.
	
	Third, since blind punishments rely on the fact that punished player $a$ cannot predict the bits of a CSPRNG initiated by a shared secret that was computed without using his own key pair, he can try to weaken the punishment by <<cracking>> the secret key by invoking a one-way function on one of the public keys. If this happens at the $i$-th iteration of the game, then he must spend $(1 - \delta) \delta^i M^a[f_n^{-1}]$ on it, receiving at most $\delta^{i+1} \Delta u^a$ of income from the playout tail. Such a deviation is made unfavorable by the restriction on $\delta$ imposed by condition 3 of the theorem statement. %В-третьих, поскольку слепые наказания опираются на то, что наказываемый игрок $a$ не может предсказать биты CSPRNG, инициированного общим секретным ключом, вычисление которого производилось без использования его собственной пары ключей, он может попытаться ослабить наказание, <<взломав>> секретный ключ путём обращения односторонней функции на одном из открытых ключей. Если это происходит на $i$-й итерации игры, то он должен потратить на это $(1 - \delta) \delta^i M^a[f_n^{-1}]$, получив в результате не более чем $\delta^{i+1} \Delta u^a$ дохода от хвоста розыгрыша. Такое отклонение делает невыгодным ограничение на $\delta$, накладываемое условием 3 формулировки теоремы.
	
	Thus, the prescribed procedure for playing the infinitely repeated game $(\Gamma)_M^{\delta}$ actually turns out to be a Nash equilibrium with the required expected payoffs. %Таким образом предписанная процедура розыгрыша бесконечной повторяющейся игры $(\Gamma)_M^{\delta}$ действительно оказывается равновесием по Нэшу с искомыми ожидаемыми выигрышами. %Для того, чтобы она оказалась ещё и совершенной по подыграм достаточно дополнить стадию наказания, предписав, что любой из наказывающих игроков, отклонившись от вычисленной в соответствии с CSPRNG %Остаётся заметить, что использование в качестве наказания равновесных по Нэшу в каждой итерации распределений $\bar{\mu}^a$ не даёт также и наказывающим игрокам получать дополнительную выгоду путём отказа участвовать в предписанном 
\end{proof}

It is easy to see that the proved assertion is rather analogous to the very first formulations of the <<folk>> theorem, in which the subgame-perfect equilibria were not yet discussed. Alas, the application of methods by which perfect subgame equilibria are constructed in the conventional case becomes difficult for objective reasons, when we start taking into account the cost of calculations. As already mentioned at the beginning of the chapter, a scheme of endless punishment of the last deviant from the prescribed strategy, which is also used in the process of punishing the previous deviant, is a most common method. Here such a naive approach runs into an obstacle "--- consider the situation in which player $a$ decided to cut corners on creating keys and instead of the prescribed procedure at the synchronization stage, he simply played the mixed strategy $s_0^a$. Noticing this, the other players, upon completion of key exchange begin his blind punishment with the correlated strategy profile $\check{\mu}^a$. Now imagine what happens if one of the punishers decides at the next iteration to use a strategy that is more beneficial for himself than the CSPRNG prescribes as a punishment. Such a player must himself be punished starting from the next iteration, and player $a$ should also take part in his punishment. However, since player $a$ saved on creating his key pair, he simply does not have the ability to calculate the shared secret key required for it, so any punishment he must participate in ceases to be an effective threat. %Несложно заметить, что доказанное утверждение является аналогом скорее самых первых формулировок <<народной>> теоремы, в которых речь ещё не шла о равновесиях, совершенных по подыграм. Увы, но методы, при помощи которых строятся совершенные подыгровые равновесия в классическом случае, по объективным причинам сложно перенести на игры с учётом стоимости вычислений. Как уже было упомянуто в начале главы, обычно для этого используется схема бесконечного наказания последнего отклонившегося от предписанной стратегии, применяющаяся в том числе и в процессе наказания предыдущего отклонившегося. Здесь же такой наивный подход натыкается на препятствие "--- рассмотрим ситуацию, в которой игрок $a$ решил сэкономить на создании ключей и вместо предписанной процедуры на стадии синхронизации просто играл смешанную стратегию $s_0^a$. Заметив это, остальные игроки по завершении обмена ключами начинают его слепое наказание коррелированным набором стратегий $\check{\mu}^a$. Представим теперь, что будет, если один из наказывающих решит на очередной итерации использовать стратегию более выгодную для себя, чем предписывает в качестве наказания CSPRNG. По классической схеме такой игрок должен быть сам назначен наказываемым начиная со следующей итерации, причём в его наказании должен принимать участие в том числе и игрок $a$. Однако, поскольку игрок $a$ сэкономил на создании своей пары ключей, он просто не имеет возможности вычислить общий секретный ключ, требующийся для этого, так что любое наказание, в котором он должен участвовать, перестаёт быть эффективной угрозой.

Another noticeable drawback of the proved theorem is that it implicitly relies on the observability of the strategies used by the players. It is understood that the only secret that players hide from their opponents is the specific values ​​of the keys, while the algorithms they use are publicly known. However, the claim could become much stronger and more convincing if we considered only the specific pure strategies played by the participants to be publicly known. This matters, for example, when we say that a player who decides to cut corners on creating keys is subject to punishment at the end of the synchronization stage, because if players can judge whether someone created keys or not, only by the moves they make, then during some number of first iterations of the playout stage, the deviant could randomly guess which strategy the CSPRNG prescribes, even without a shared secret key, by simply choosing the most probable strategy according to the $\mu$ distribution. Moreover, if the $\mu$ distribution is such that someone must play the same pure strategy in it with a probability of $1$, then it does not make sense for him to create keys at all, since forgoing their creation will never be disclosed. %Ещё одним заметным недостатком доказанной теоремы можно считать то, что она неявно опирается на наблюдаемость стратегий, используемых игроками. Подразумевается, что единственная тайна, которую игроки скрывают от своих оппонентов - это конкретные значения ключей, тогда как применяемые ими алгоритмы известны публично. Однако, утверждение могло бы стать намного сильнее и убедительнее, если бы мы считали публично известными только конкретные чистые стратегии, играемые участниками. Это имеет значение, например, когда мы говорим, что игрок, решивший сэкономить на создании ключей, назначается наказываемым по окончании стадии синхронизации "--- ведь если игроки могут судить о том, создавал кто-то ключи или нет, только по совершаемым ходам, то в течение некоторого количества первых итераций стадии розыгрыша отклонившийся мог бы случайно угадывать, какую стратегию предписывает CSPRNG, даже без общего секретного ключа, просто выбирая наиболее вероятную в соответствии с распределением $\mu$ стратегию. Причём, если распределение $\mu$ таково, что в нём кто-то должен играть одну и ту же чистую стратегию с вероятностью $1$, то ему вообще не имеет смысла создавать ключи, поскольку отказ от их создания никогда не будет раскрыт.

The same vulnerability can be exploited in an even more subtle way if player $a$'s income from the synchronizing mixed strategy profile $s_0$ exceeds his income from the target distribution $\mu$. If, instead of randomly choosing the value of $\chi^a$, when creating keys, the player will <<tamper>> with its fractional part so that it approaches $0$ or $1$, then thereby he can arbitrarily increase the duration of the synchronization stage and, accordingly, his total income. The described problems arising from the rejection of the algorithms' observability by the other players can hardly be called insurmountable, however, attempts to solve them within the framework of this study would significantly complicate the formal reasoning, without adding anything valuable to understanding its central ideas. %Эту же уязвимость можно использовать ещё более тонким образом, если доход игрока $a$ от синхронизационного набора смешанных стратегий $s_0$ превышает его доход от целевого распределения $\mu$. Если вместо случайного выбора значения $\chi^a$ при создании ключей игрок будет <<подкручивать>> его дробную часть так, чтобы она была близка к $0$ или $1$, то тем самым он может произвольно увеличивать продолжительность стадии синхронизации и, соответственно, свой итоговый доход. Описанные проблемы, возникающие при отказе от наблюдаемости используемых игроками алгоритмов, вряд ли можно назвать непреодолимыми, однако попытки их решения в рамках данной работы значительно усложнили бы формальные рассуждения, не привнеся при этом ничего ценного для понимания центральных её идей.

In addition, one should pay attention to the fact that since the conditions of the theorem limit the value of the discount coefficient $\delta$ both from below and from above, it cannot be formulated in a more elegant form for arbitrarily small $\epsilon$-approximations to the payout vector $u_{M,n}(\mu)$. However, we can map its parameters to real world objects in order to be able to judge its practical implications. Let's imagine that the collection $M$ of computing devices used by the players consists of modern processing units, and $n = 256$, which coincides with the most common key length in modern cryptography. For well-chosen\footnote{This assumes that none of the players selects one of his pure strategies with a probability close to $1$.} mixed equilibrium $s_0$, we can expect that the average duration of the key exchange stage $\mathfrak{t}(s_0, n)$ will coincide in order of magnitude with the value of $n$, that is, measured in hundreds of iterations, which means that in a series of draws with at least one hundred thousand significant iterations, the contribution of the synchronization stage will certainly not exceed one percent of the final result. Given that, for example, systems for automated stock trading can easily make hundreds of thousands of transactions per day, for many practical applications this can be considered a good approximation. %Кроме того следует обратить внимание на то, что, поскольку условия теоремы ограничивают значение дисконтирующего коэффициента $\delta$ как снизу, так и сверху, её невозможно сформулировать в более изящной форме для сколь угодно малых $\epsilon$-приближений к вектору выплат $u_{M,n}(\mu)$. Однако мы можем отобразить её параметры на объекты реального мира, чтобы иметь возможность судить о её практических следствиях. Представим себе, что используемый игроками набор вычислительных устройств $M$ "--- это современные компьютеры, а $n = 256$, что совпадает с наиболее распространённой в современной криптографии длинной ключей. Для удачно подобранных\footnote{Здесь подразумевается, что никто из игроков не выбирает одну из своих чистых стратегий с вероятностью близкой к $1$.} смешанных равновесий $s_0$ можно ожидать, что средняя продолжительность стадии обмена ключами $\mathfrak{t}(s_0, n)$ по порядку величины будет совпадать со значением $n$, то есть измеряться сотнями итераций. Это значит, что в сериях розыгрышей с хотя бы ста тысячами значимых итераций вклад стадии синхронизации уже заведомо не будет превышать одного процента от итогового результата. Учитывая, что, к примеру, системы для автоматизированного трейдинга на биржах вполне могут совершать сотни тысяч транзакций в день, для многих практических применений это можно считать неплохим приближением.

Further, about the cost of calculating the functions used to generate the shared secret keys, i.e. $M^a[f_{256}]$ and $M^a[h_{256}]$ "--- although it cannot be considered negligible, but as an estimate it can be noted that each opening of a web page by a modern browser in the vast majority of cases implies generation of several key pairs and corresponding shared secret keys. Finally, the cost of generating pseudo-random sequences by modern CSPRNG, i.e. $M^a[G_{256}]$ on a scale of millions of bits can already be considered negligible, since, say, rendering an image from a video card to a modern computer monitor via the digital HDMI interface implies encryption of a stream measured in tens of gigabits per second, while the algorithm used in this encryption process can also be used to generate pseudo-random sequences. %Далее, стоимость вычисления функций, использующихся при создании общих секретных ключей, т.е. $M^a[f_{256}]$ и $M^a[h_{256}]$ хотя и нельзя считать пренебрежимо малой, но для её оценки можно заметить, что каждое открытие интернет-страницы современным браузером в подавляющем большинстве случаев подразумевает генерацию нескольких ключевых пар и соответствующих общих секретных ключей. Наконец, стоимость генерации псевдослучайных последовательностей современными $CSPRNG$, т.е. $M^a[G_{256}]$ на масштабе в миллионы битов уже можно считать пренебрежимо малой, так как, скажем, передача изображения с видеокарты на монитор современного компьютера по цифровому интерфейсу HDMI подразумевает шифрование потока, измеряющегося десятками гигабит в секунду, а алгоритм, использующийся в процессе этого шифрования, может использоваться и для генерации псевдослучайных последовательностей.

Finally, it remains to note that the inversion of a one-way function with a 256-bit argument is currently considered impossible and is expected to remain so until the creation of functioning quantum computers. This means that the value of $M^a[f_{256}^{-1}]$ for practical applications can be considered almost infinite, which allows $\delta$ to approach $1$ by an arbitrarily small (in the sense of real conflicts) distance. %Наконец, остаётся заметить, что обращение односторонней функции с 256-битным аргументом считается на данный момент невозможным и предполагается, что оно останется таковым вплоть до создания функционирующих квантовых компьютеров. Это означает, что значение $M^a[f_{256}^{-1}]$ для практических применений можно считать почти бесконечным, что позволяет $\delta$ приближаться к $1$ на сколь угодно малое (в смысле реальных конфликтов) расстояние.

%\begin{proof}
%	Логика доказательства во многом повторяет рассуждения теоремы \ref{the:folk}. Игроки придерживаются предписанной последовательности стратегий, пока на итерации $i$ игрок $a$ не решит отклониться, получив конечную прибыль $u^a(s_i | \hat{s}^a_i) - u^a(s_i)$. В ответ на это остальные игроки переключаются на его наказание соответствующим минимаксным набором стратегий. Проблема заключается в том, что наказание игрока $a$ в пространстве заговоров $\mathfrak{A}$, может использовать недоступность ему тайн заговоров $\mathfrak{A}^{\setminus a} = \{A_* \in \mathfrak{A} \mid a \notin A_*\}$, тогда как в повторяющейся игре $[\Gamma, M]^{\infty}_{\delta}$ отдельные итерации разыгрываются без пространств корреляции вообще. Для решения этой проблемы алгоритм поведения игроков немного усложняется и проходит в три этапа, предваряясь дополнительной стадией синхронизации.
%	
%	В начале первой стадии каждый игрок $a$ выбирает случайное вещественное число $\chi^a$, равномерно распределённое в диапазоне $\left[0, 2^n\right)$. Округление этого числа $x^a = \lfloor\chi^a\rfloor \in \mathbb{N}_{<2^n}$ используется им далее в качестве закрытого ключа. При помощи односторонней функции игрок вычисляет открытый ключ $X^a = f(x^a) \in \mathbb{N}_{<2^n}$. Поскольку $f$ "--- биекция, случайная величина $\mathcal{X}^a = \chi^a - x^a + X^a$ также равномерно распределена в диапазоне $\left[0, 2^n\right)$. Для того, чтобы раскрыть другим игрокам своё значение $X^a$, игрок использует метод <<фрактального>> кодирования числа $\mathcal{X}^a$ в последовательности совершаемых им ходов, неотличимых по вероятностному распределению от стратегии участия в смешанном равновесии $s_0$, где ни один из игроков не играет чистой стратегии (см. требование существования такого равновесия для игры $\Gamma$ в условии теоремы). Пусть $(p^a_1, \ldots, p^a_{\lvert S^a \rvert})$ "--- вероятности выбора в этом равновесии соответствующих стратегий из $S^a = \{s^a_j, j = \overline{1, \lvert S^a \rvert}\}$. Начнём с построения в единичном интервале $\left[0, 1\right)$ сетки неубывающих чисел $\rho^a = (\rho^a_0 = 0, \rho^a_1, \ldots, \rho^a_{\lvert S^a \rvert - 1}, \rho^a_{\lvert S^a \rvert} = 1)$ разбивающей его таким образом, что $\rho^a_j - \rho^a_{j-1} = p^a_j, j = \overline{1,\lvert S^a \rvert}$. Это позволяет применить следующий алгоритм кодирования:
%	
%	\begin{enumerate}
%		\item До совершения первого хода другие игроки знают, что $\mathcal{X}^a$ равномерно распределено в интервале $\left[0, 2^n\right)$. Положим $\mathcal{X}^a_{min} = 0$ и $\mathcal{X}^a_{max} = 2^n$.
%		\item Отмасштабируем $\rho^a$ на интервал $\left[\mathcal{X}^a_{min}, \mathcal{X}^a_{max}\right)$ получив вложенную в него сетку $\mathcal{P}^a = (\mathcal{X}^a_{min} (1 - \rho^a_j) + \mathcal{X}^a_{max} \rho^a_j, j = \overline{0, \lvert S^a \rvert})$.
%		\item Выберем на очередной итерации $s^a_j$ такое, что $\mathcal{P}^a_{j-1} \le \mathcal{X}^a < \mathcal{P}^a_j$.
%		\item Теперь другие игроки знают, что $\mathcal{X}^a$ равномерно распределено в интервале $\left[\mathcal{P}^a_{j-1}, \mathcal{P}^a_j\right)$. Вернёмся к шагу 2, положив $\mathcal{X}^a_{min} = \mathcal{P}^a_{j-1}$ и $\mathcal{X}^a_{max} = \mathcal{P}^a_j$.
%	\end{enumerate}
%
%	Этот алгоритм может выполняться бесконечно, постепенно уменьшая меру незнания других игроков относительно величины $\mathcal{X}^a$. На каждой итерация вероятность выбора всех стратегий совпадает с соответствующими вероятностями из одного и того же смешанного равновесия по Нэшу игры $\Gamma$, причём решения из разных итераций попарно независимы, так что единственный способ улучшить свой выигрыш для любого игрока на этом этапе "--- экономить на вычислениях, используя вместо генерации пары ключей простую смешанную стратегию. Однако, такая экономия предотвращается угрозой наказания на следующих стадиях игры. В тот момент, когда начинает выполняться неравенство $X^a \le \mathcal{X}^a_{min} < \mathcal{X}^a_{max} \le X^a + 1$ другие игроки получают уверенность относительно значения $X^a$ и открытый ключ игрока $a$ можно считать опубликованным. Когда все игроки завершили процесс публикации открытых ключей, каждый игрок $a$ вычисляет общий секретный ключ $K^A = h(X^1, \ldots, x^a, \ldots, X^m)$, комбинируя свой закрытый ключ с открытыми ключами других игроков, на чём стадия синхронизации завершается.
%	
%	В начале второй стадии каждый игрок инициирует один CSPRNG зерном $K^A$. С использованием следующего детерминированного псевдослучайного алгоритма игроки вычисляют последовательность ходов, которая в игре $(\Gamma)^{\infty}_{\delta}$ сошлась бы к вектору выплат $v$. Пусть $v^a = p_1 u^a(s_1) + \ldots + p_k u^a(s_k), a = \overline{1,m}$, т.е. $v$ представляет собой линейную комбинацию выплат в наборах чистых стратегий $s_1, \ldots, s_k$. Построим в единичном интервале $\left[0, 1\right)$ сетку неубывающих чисел $\rho = (\rho_0 = 0, \rho_1, \ldots, \rho_{k - 1}, \rho_k = 1)$ разбивающую его аналогично предыдущей фазе таким образом, что $\rho_j - \rho_{j-1} = p_j, j = \overline{1,k}$.
%	
%	\begin{enumerate}
%		\item Положим $\mathcal{X}_{min} = 0$ и $\mathcal{X}_{max} = 1$.
%		\item Проверим, нет ли такого $j$, что $\rho_{j-1} \le \mathcal{X}_{min} < \mathcal{X}_{max} \le \rho_j$. Если есть, остановим алгоритм, приняв решение о выборе стратегического набора $s_j$.
%		\item Сгенерируем очередной бит псевдослучайной последовательности. Значение $\frac{\mathcal{X}_{min} + \mathcal{X}_{max}}{2}$ в случае $0$ присвоим переменной $\mathcal{X}_{max}$, а в случае $1$ "--- $\mathcal{X}_{min}$.
%		\item Перейдём к шагу 2.
%	\end{enumerate}
%	
%	Выбор набора стратегий в соответствии с этим алгоритмом детерминирован для всех, знающих секретный ключ $K^A$, и в силу свойств CSPRNG без знания зерна неотличим от случайного выбора в соответствии с необходимым распределением $(p_1, \ldots, p_k)$. Если один из игроков отклоняется от предписанной таким образом стратегии (из желания увеличить выигрыш или вследствие экономии на генерации ключей во время фазы синхронизации), остальные игроки немедленно это замечают и переходят к применению против него стратегии наказания.
%	
%	На этой стадии против наказываемого игрока $\check{a}$ играют минимаксный набор коррелированных стратегий в семействе заговоров $\mathfrak{A}^{\setminus \check{a}} = \{A_* \in \mathfrak{A} \mid \check{a} \notin A_*\}$ (поскольку тайны заговоров, которые наказываемый игрок знает, очевидно, не могут быть использованы для уменьшения его гарантированного выигрыша). Каждому заговору $A_* = \{a_1, \ldots, a_{\lvert A_* \rvert}\} \in \mathfrak{A}^{\setminus \check{a}}$ ставится в соответствие собственный секретный ключ $K^{A_*} = h(X_{a_1}, \ldots, x_{a_j}, \ldots, X_{a_{\lvert A_* \rvert}})$, который может быть скомбинирован каждым его членом из собственного закрытого ключа и открытых ключей остальных заговорщиков. Каждый игрок инициализирует соответствующими зёрнами по одному CSPRNG на каждый заговор из $\mathfrak{A}^{\setminus \check{a}}$, в который он сам входит, и применяет ту же процедуру псевдослучайного выбора стратегии с помощью детерминированного алгоритма. Из этого складывается набор стратегий, который с точки зрения наказываемого игрока $\check{a}$, не знающего секретных ключей, неотличим от минимаксного набора в пространстве заговоров $\mathfrak{A}^{\setminus \check{a}}$.
%	
%	Единственным свободным параметром в вышеописанной схеме является битовый размер ключа $n$. Для игрока $a$ от него зависят:
%	\begin{itemize}
%		\item стоимость вычислений при создании игроком пары закрытого и открытого ключей $M^a[f_n] \in o(2^n)$;
%		\item среднее количество раундов публикации ключа $\mathfrak{t}(n) \in \Theta(n)$;
%		\item стоимость комбинирования одной пары ключей $M^a[h_n] \in o(2^n)$;
%		\item стоимость генерации одного бита псевдослучайной последовательности $M^a[G_n] \in o(2^n)$;
%		\item стоимость обращения односторонней функции $M^a[f_n^{-1}] \in \Theta(2^n)$.
%	\end{itemize}
%
%	Как и ранее, под $o(2^n)$ здесь понимается множество функций полиномиальной сложности, а под $\Theta(n)$ и $\Theta(2^n)$ "--- множества линейно и экспоненциально сложных соответственно. Таким образом общий доход игрока $a$ при следовании предписанной стратегии можно записать так:
%	\begin{align*}
%		u^a_{SYNC} &= (1 - \delta^{\mathfrak{t}(n)}) u^a(s_0) - (1 - \delta) (M^a[f_n] + \delta^{\mathfrak{t}(n)} (m - 1) M^a[h_n]); \\
%		u^a_{PLAY} &= v^a - M^a[G_n]; \\
%		u^a_{TOTAL} &= u^a_{SYNC} + \delta^{\mathfrak{t}(n)} u^a_{PLAY}.
%	\end{align*}
%
%	Здесь $u^a_{SYNC}$ "--- доход от стадии синхронизации, а $u^a_{PLAY}$ "--- недисконтированный доход от <<рабочего хвоста>> розыгрышей. Рассмотрим возможные девиации, которые могли бы принести игроку дополнительный доход. На стадии синхронизации следование процедуре выбора очередной стратегии приводит к равновесию по Нэшу в смешанных стратегиях, так что из доступных способов оптимизации остаётся экономия на $\mathfrak{w}^a_{KG}(n)$ "--- можно, не создавая ключей, использовать простую смешанную стратегию $s_0^a$, что краткосрочно даёт тот же выигрыш. Это, однако, приводит к невозможности присоединиться к псевдослучайной коррелированной стратегии без траты $\delta^{\mathfrak{t}^a(n)} (1 - \delta) \mathfrak{w}^a_{IR}(n)$ на <<взлом>> общего секретного ключа. Игроку также может оказаться выгодно намеренное затягивание фазы синхронизации путём специального подбора $\mathcal{X}^a$ вблизи от целых чисел, если $u^a(s_0) > v^a - \mathfrak{w}^a_{SG}$, то есть если его доход от смешанного равновесия используемого в синхронизации превосходит целевой доход. Однако, такое отклонение может быть предотвращено при помощи следующей угрозы "--- в тот момент, когда все игроки кроме $a$ завершают публикацию своих ключей, они вычисляют секретный ключ $K^{A \setminus \{a\}}$ и используют CSPRNG с ним в качестве зерна для того, чтобы, до тех пор пока он не завершит публикацию, на каждой итерации с некоторой заданной вероятностью $p^a_{SU}$ назначить отстающего наказываемым и перейти к его вечному минимаксу.
%	
%	В хвосте розыгрышей игрок $a$ может получить дополнительный доход, не превосходящий константы $u^a_{GM}$, однократным отклонением от предписанного псевдослучайным алгоритмом выбора, что автоматически переводит игру на стадию его наказания. На этой стадии он может либо смириться со своим наказанием и получать до конца игры соответствующий минимакс, либо тратить $(1 - \delta) \mathfrak{w}^a_{IR}(n)$ на <<взлом>> каждого ключа, необходимого для предсказания играемого против него коррелированного набора. При этом, очевидно, для любого $\delta$ можно подобрать достаточно большое $n$, чтобы ограниченный константой выигрыш от предсказания ходов оппонентов был перекрыт стоимостью обращения односторонней функции. Сам же $\delta$ следует выбирать в соответствии с тем же принципом, что и в классической <<народной>> теореме "--- так, чтобы ущерб от вечного минимакса превысил верхнюю границу возможного дохода от однократного отклонения.
%	
%	Для доказательства теоремы достаточно показать, что с при $\delta$, стремящемся к $1$, выигрыш $u^a_{TOTAL}$ будет стремиться к $v^a - \mathfrak{w}^a_{SG}$. Заметим, что при увеличении $n$ на $1$, стоимость обращения односторонней функции $\mathfrak{w}^a_{IR}(n)$ увеличивается вдвое. Это значит, что при уменьшении $1 - \delta$ вдвое, продолжительность стадии синхронизации достаточно увеличить не более чем на константу, и следовательно $\delta^{\mathfrak{t}^a(n)}$ также стремится к $1$. При этом, очевидно, пренебрежимо малыми становится $(1 - \delta^{\mathfrak{t}^a(n)}) (u^a(s_0) - \mathfrak{w}^a_{KP})$ и 
%	
%	а значит асимптотически $u^a_{TOTAL}$ ведёт себя так же как $u^a_{PLAY}$. Остаётся указать на то, что $\mathfrak{w}^a_{KG}(n)$
%	
%	основные : с одной стороны увеличение веса <<хвоста>> позволяет окупаться взлому ключей большей длины, так что $n$ растёт, а вслед за ним растут и 
%	
%%	\begin{enumerate}
%%		\item Если в игре есть наказываемый игрок, перейти к шагу 4.
%%		\item Сравнить стратегии, сыгранные игроками на предыдущем раунде с $s_{i-1}$. Если какой-либо игрок отклонился от предписанной стратегии, назначить его наказываемым и перейти к шагу 4.
%%		\item Вычислить набор $s_i$, запомнить его и завершить ход сыграв стратегию $s_i^a$.
%%		\item Вычислить и сыграть стратегию наказания.
%%	\end{enumerate}
%%
%%	Прежде чем полноценно разворачивать шаг 4 остановимся заметить, что в случае, когда угроза, создаваемая стратегией наказания для каждого из игроков, достаточно велика, чтобы её ущерб превысил прибыль однократного уклонения от предписанной стратегии, фактически шаг 4 не исполняется никогда, так что под $\mathfrak{w}^a$ мы понимаем дисконтированную сумму стоимости вычислений на шагах 1, 2 и 3. Обозначим также символом $s_*$ равновесие по Нэшу игры $\Gamma$, не включающее чистых стратегий.
%%	
%%	\begin{enumerate}
%%		\item[4.] Вычислить и сыграть стратегию наказания:
%%		\begin{enumerate}
%%			\item Если это первый ход после первого отклонения, сгенерировать случайный закрытый ключ $x^a \in \{0,1\}^n$, вычислить при помощи односторонней функции открытый ключ $X^a = f(x^a) \in \{0,1\}^n$ и построить для открытого ключа $X^a$ кодирующую последовательность стратегий $\check{s}^a = \operatorname{enc}(s_*^a, X^a) \in S^a \times \ldots \times S^a$. Начать процедуру обмена ключами со счётчиком $j = 0$.
%%			\item Иначе, если процедура обмена ключами не закончена, запомнить стратегии, сыгранные другими игроками в предыдущем раунде, в качестве $\check{s}^1_{j-1}, \ldots, \check{s}^m_{j-1}$.
%%			\item Если процедура обмена ключами не закончена
%%		\end{enumerate}
%%	\end{enumerate}
%\end{proof}

%Заметим, что с ростом $n_{PK}^a$, растёт и минимальный выигрыш игрока, при котором последовательность розыгрышей $(s_i)$ образует совершенное подыгровое равновесие. То есть, чем дешевле игроку обходятся вычисления, тем сложнее остальным принудить его к принятию невыгодного исхода повторяющейся игры. Это создаёт картину, неожиданную для казалось бы элементарного конфликта с матрицей платежей размером $2 \times 2 \times 2$ "--- поскольку из известных моделей асимметричной криптографии наименьшую длину ключа при равной стойкости обеспечивает дискретное логарифмирование на эллиптической кривой, получается, что для реализации успешных стратегий приходится применять математический аппарат переднего края теории групп. Более того, доход игроков напрямую зависит от их способности производить сложные вычисления на пределе любых доступных возможностей.

%\begin{theorem}
%	Пусть $\Gamma$ "--- игра в нормальной форме, чувствительная к дополнительной информационной асимметрии. Пусть $\mathbf{s}$ "--- равновесие по Нэшу в коррелированных стратегиях игры $\Gamma | \Phi$, где $\Phi = \{A_*\}$ "--- невырожденное семейство заговоров из одного элемента. Пусть $s$ "--- такое равновесие по Нэшу в смешанных стратегиях, что вероятности реализации отдельных стратегий в $\mathbf{s}^a$ и $s^a$ попарно совпадают для каждого игрока $a$. Тогда в повторяющейся игре с коэффициентом дисконтирования $\delta$ найдётся совершенное подыгровое равновесие по Нэшу в смешанных стратегиях
%\end{theorem}

\section{Generalization of results, prospects and suppositions}\label{sec:ch3/sect6}

In order to appreciate the significance of this phenomenon, one should drop back a couple of steps from the specifics of the described game and try to glance over the larger picture. First, by generalizing the folk theorem, it becomes clear that the three"~way even"~odd itself is nothing more than a relatively arbitrarily constructed example of a game that is sensitive to additional information asymmetry. The cryptographic punishment strategies described above use virtually no other properties of a given conflict, and there is no reason to think that they cannot be generalized to many other games that exhibit the same property. For example, if we take the game $\Gamma^3_n$ from the second chapter of this work as a single iteration, then it turns out that when it is repeated, it is possible to encode public keys in a similar way with an alphabet consisting of $n$ characters according to the number of computers in the computer center, and then use the resulting shared secret key as the seed of the generator, pseudo-randomly choosing from same $n$ elements. %Для того, чтобы оценить значение этого феномена, следует отступить на пару шагов от конкретики описанной игры и попытаться охватить взглядом более широкую картину. Во-первых, благодаря обобщению народной теоремы становится очевидно, что сам по себе трёхсторонний чёт-нечет выступает в роли не более чем относительно произвольно сконструированного примера игры, чувствительной к дополнительной информационной асимметрии. Вышеописанные криптографические стратегии наказания не используют фактически никаких других свойств данного конфликта и нет причин думать, что они не могут быть обобщены на множество других игр, проявляющих то же свойство. К примеру, если мы возьмём в качестве отдельной итерации игру $\Gamma^3_n$ из второй главы этой работы, то окажется, что при её повторении можно аналогичным образом кодировать открытые ключи алфавитом, состоящим из $n$ символов по числу компьютеров в вычислительном центре, а потом использовать полученный общий секретный ключ в качестве зерна генератора, псевдослучайно выбирающего из опять же $n$ элементов.

Secondly, it makes sense to ask whether the described scheme of cryptographic punishment strategies exhausts all possibilities for expanding the set of perfect subgame equilibria. Common sense suggests that it is not, at least because both cryptographic primitives used here (the distributed key-agreement protocol and the cryptographically secure pseudo-random number generator alike) have many implementations based on a variety of mathematical formalisms, the list of which is replenished year by year due to the rapid developments in the relevant areas of knowledge. Moreover, building a punishment strategy from the DH protocol followed by utilizing the resulting key as a CSPRNG seed is itself quite arbitrary "--- we used tools that were originally created in a completely different context for other purposes, simply because they already exist and have proven properties convenient for solving our problem. %Во-вторых, имеет смысл задаться вопросом о том, исчерпывает ли описанная схема криптографических стратегий наказания все возможности для пополнения множества совершенных подыгровых равновесий. Здравый смысл подсказывает, что нет хотя бы потому, что оба использованных здесь криптографических примитива (и протокол совместной выработки ключа, и криптографически стойкий генератор псевдослучайных чисел) имеют немало реализаций, опирающихся на самые разные математические формализмы, список которых год от года пополняется благодаря бурному развитию соответствующих областей знания. Более того, построение стратегии наказания из протокола DH с последующим использованием полученного ключа в качестве зерна CSPRNG само по себе достаточно произвольно "--- мы использовали инструменты, изначально создававшиеся в совершенно ином контексте для других целей, просто потому, что они уже есть и имеют доказанные свойства, удобные для решения нашей задачи.

These considerations allow us to reasonably assume that both the three"~way even"~odd itself and the presented cryptographic punishment strategies are just the most obvious representatives of a wider class of mathematical formalisms that have not yet been explored. In the most general terms, rational agents, participating in repeated conflicts, can develop secret correlated strategies of behavior, using only specially selected public actions and observing a similarly acting counterparty. The secrecy is ensured due to the fact that joining the correlation requires cognitive efforts that exceed capabilities of any third party observing the same sequence of public actions. In addition, generalizing the relationship between the normalized cost of computation and the required key length, it can be assumed that the more cognitive effort the party from which the conspirators are trying to hide their shared strategy can apply, the more difficult this process is and the less income (due to the growing discounting in the tail rounds) brings such secrecy. %Эти рассуждения позволяют обоснованно предположить, что и сам трёхсторонний чёт-нечет, и представленные криптографические стратегии наказания "--- всего лишь наиболее очевидные представители более широкого класса пока ещё не исследованных математических формализмов. Говоря максимально общим языком, рациональные агенты, участвуя в повторяющихся конфликтах, могут вырабатывать секретные коррелированные стратегии поведения, используя лишь специальным образом выбираемые публичные действия и наблюдая за аналогично действующим контрагентом. Секретность при этом обеспечивается за счёт того, что присоединение к корреляции требует от наблюдающей ту же последовательность публичных действий третьей стороны когнитивных усилий, превосходящих её возможности. Кроме того, обобщая связь между удельной стоимостью вычислений и требуемой длиной ключей, можно предположить, что чем большие когнитивные усилия способна приложить сторона, от которой заговорщики пытаются скрыть свою общую стратегию, тем сложнее этот процесс и тем меньший доход (за счёт растущего дисконтирования в хвосте розыгрышей) приносит такая секретность.

Indeed, if we imagine ordinary people playing a game sensitive to additional information asymmetry without the use of special technical means, we can hardly expect that they will perform the mental calculations necessary for the DH+CSPRNG routine. At the same time, it is likely that there are ubiquitous examples of how people can achieve the necessary secret synchronization unconsciously, perceiving the result as a self-evident, self-explanatory fact. In this case, we think of experienced gamblers who specialize in complex intellectual games, such as bridge or preference. Among them, it is considered undeniable that, in addition to individual skills, the outcome of the draws is strongly influenced by the joint playing experience "--- a pair of players who individually are no great shakes can turn out to be formidable opponents if they have many games at the same table behind them. If the above assumptions about the rather general nature of the constructed model are correct, then the phenomenon of such <<cohesion>> can find a satisfactory explanation within its framework. %В самом деле, если представить себе обычных людей, играющих в чувствительную к дополнительной информационной асимметрии игру без применения специальных технических средств, мы вряд ли можем ожидать, что они будут производить в уме вычисления, необходимые для связки DH+CSPRNG. При этом, вполне вероятно, что повсеместно распространены примеры того, как люди могут добиваться необходимой тайной синхронизации неосознанно, воспринимая результат как самоочевидный, не требующий объяснений факт. В данном случае имеются в виду опытные картёжники, специализирующиеся на сложных интеллектуальных играх, таких как бридж или преферанс. В их среде считается неоспоримым, что помимо индивидуальных навыков на исход розыгрышей сильно влияет опыт именно совместной игры "--- пара игроков, по отдельности не хватающих звёзд с небес, могут оказаться грозными соперниками, если у них за плечами много партий за одним столом. Если верны вышеизложенные предположения о достаточно общем характере построенной нами модели, то феномен такой <<сыгранности>> может найти удовлетворительное объяснение в её рамках.

It should be noted that while aiming to analyze from this point of view the strategies of players in already existing parlor games, we may encounter difficulties related to the fact that the rules of those that can be suspected of being sensitive to additional information asymmetry are complex even without taking into account this property. For example, bridge or preference will obviously remain very non-trivial, even if you play them in separate draws, each time choosing the composition of anonymous participants randomly from a large pool of candidates (remotely over the network, for example). To facilitate the task of future researchers, it would be nice to design a special card game in which the use of the <<cohesion>> effect would be a necessary element of any successful strategy. An attempt to create such a new game called <<Tesseract>> is in the Appendix~\cref{app:D} "--- hopefully in the future it will be useful for both scientific and entertainment purposes. %Следует заметить, что если мы захотим исследовать с этой точки зрения стратегии игроков в уже существующие салонные игры, на нашем пути могут встать затруднения, связанные с тем, что правила тех из них, что можно заподозрить в чувствительности к дополнительной информационной асимметрии, сложны даже без учёта этого их свойства. Скажем, бридж или преферанс останутся, очевидно, весьма нетривиальными, даже если играть в них отдельными партиями, каждый раз подбирая состав анонимных участников случайно из большого пула кандидатов (удалённо по сети, например). Для облегчения задачи будущих исследователей неплохо было бы сконструировать специальную карточную игру, в которой использование эффекта <<сыгранности>> было бы необходимым элементом любой успешной стратегии. Попытка создания такой новой игры под названием <<Тессеракт>> вынесена в Приложение~\cref{app:D} "--- будем надеяться, что в будущем она окажется полезна как в научных, так и в развлекательных целях.

It would be fancy to complete this work by formulating a rather bold informal hypothesis that continues the line of reasoning of the last chapter in line with population games: %Завершить данную работу хотелось бы формулировкой достаточно смелой неформальной гипотезы, продолжающей линию рассуждений последней главы в русле популяционных игр:
\begin{conjecture}
	If conflict situations, the model of which is sensitive to additional information asymmetry, periodically (many times during the life of one individual) arise in a population and the probability of the genus proliferation by individual specimens significantly depends on their success in these conflicts, then evolutionary pressure on the population fortifies traits that contribute to an increase in the cognitive potential of the next generations (understood in a general sense as the ability to perform Turing-complete calculations on arbitrary data). %Если в популяции периодически (много раз на протяжении жизни одной особи) возникают конфликтные ситуации, модель которых чувствительна к дополнительной информационной асимметрии, и вероятность продолжения рода отдельными особями существенно зависит от их успеха в этих конфликтах, то давление отбора закрепляет в популяции признаки, способствующие увеличению когнитивного потенциала следующих поколений (понимаемого в общем смысле, как способность производить Тьюринг-полные вычисления над произвольными данными).
\end{conjecture}

If this hypothesis is correct, then the sensitivity of games to additional information asymmetry may turn out to be the <<Holy Grail>> of evolutionary game theory "--- a factor that generates an unrestrained arms race in the field of complex behavior abilities. Any games with this property, even being very simple on its own, encourage the cognitive potential of participants with the need to build and unravel conspiracies, and therefore its study can both enrich our understanding of the intelligence evolution in our ancestors, and become a tool for improving artificial intelligence technologies. %Если эта гипотеза верна, то чувствительность игр к дополнительной информационной асимметрии может оказаться <<Святым Граалем>> эволюционной теории игр "--- фактором, порождающим неограниченную гонку вооружений в сфере способностей к сложному поведению. Любые игры с этим свойством, даже будучи очень просты сами по себе, поощряют когнитивный потенциал участников необходимостью строить и раскрывать заговоры, так что его изучение может как обогатить наше понимание эволюции интеллекта наших предков, так и стать инструментом совершенствования технологий искусственного разума.

\clearpage