\chapter{Коллективная рациональность в играх с заговорами}\label{ch:ch2}

\section{Проблема планирования заданий}\label{sec:ch2/sec1}

Концепция равновесия по Нэшу, будучи фундаментом классических моделей теории игр, сама по себе зачастую оказывается недостаточно сильным формализмом. При анализе многосторонних конфликтов нередко возникают ситуации, когда множество равновесий по Нэшу слишком велико, чтобы считать его полноценным решением игры. В этом случае на помощь исследователям приходят критерии коллективной рациональности "--- выбирая среди равновесных точек оптимальные по Парето или Слейтеру, иногда можно значительно сузить пространство решений за счёт вполне естественного исключения заведомо невыгодных для всех участников. Присутствие дополнительной информационной асимметрии при этом создаёт дополнительные затруднения, поскольку предлагаемая модель подразумевает неизбежный элемент антагонизма интересов "--- в новых точках равновесия увеличение выигрышей участвующих в корреляции происходит за счёт сокращения выплат тех, кто не может к ней присоединиться, тем самым делая непродуктивными классические критерии коллективной рациональности. Для демонстрации этого эффекта рассмотрим тривиальное обобщение классической проблемы планирования заданий \cite{Koutsoupias} занимающей важное место в концептуальном ландшафте теории игр. При помощи этого конфликта хорошо иллюстрируются понятия \emph{цены анархии} и \emph{цены стабильности}, давая вероятно самый выразительный пример того, насколько равновесия Нэша в одной и той же игре могут различаться в смысле их глобальной оптимальности. Нам, однако, необходимо взглянуть на эту игру под другим углом, при котором понятие цен анархии и стабильности теряет смысл, уступая место чувствительности к дополнительной информационной асимметрии.

Начнём с классической модели планирования заданий. В вычислительном центре работают $m$ сотрудников, каждому из которых поручено произвести некое вычисление. В их распоряжении находятся $n$ компьютеров, на каждом из которых может быть запущена одна или несколько программ, производящих вычисления сотрудников. Машины отличаются архитектурными особенностями, что задаётся матрицей констант $t_i^a \ge 0$, обозначающих время выполнения программы сотрудника $a=\overline{1,\ldots,m}$ на компьютере $i=\overline{1,\ldots,n}$. Каждое вычисление может производиться только одним устройством. Несколько программ на одном компьютере выполняются последовательно, но результаты их работы выводятся одновременно после остановки последней из них. Таким образом, выгода сотрудника заключается в выборе такого компьютера для своего вычисления, что для него оказывается минимальным суммарное время выполнения всех запущенных программ. Опишем происходящее в терминах игры нормальной формы
\begin{equation}\label{intro:game}
	\Gamma = \langle A, S^a, u^a(s), a \in A \rangle
\end{equation}
с параметрами:
\begin{itemize}
	\item $A = \{ 1, \ldots, m \}$;
	\item $S^1 = \ldots = S^m = \{ 1, \ldots, n \}$;
	\item $u^a(s) = -t_{s^a}(s)$, где $t_i(s) = \sum\limits_{a \in A, s^a = i} t_i^a$.
\end{itemize}

Здесь следует заострить внимание на определении функции выплат. Выбрав $u^a(s) = -t_{s^a}(s)$, мы моделируем ситуацию, когда все вычисления должны были быть готовы ещё вчера, и сотрудники напрямую штрафуются за каждую лишнюю секунду, пока их результаты не лягут на стол начальству. Однако, можно смоделировать и менее напряжённый рабочий момент, взяв, например, ступенчатую функцию выплат:
\begin{equation*}%\label{intro:stairs}
	u^a(s) = \begin{cases}
		u^a_{GOOD}, &t_{s^a}(s) < t^a_{DEADLINE};\\
		u^a_{LATE}, &t_{s^a}(s) \ge t^a_{DEADLINE}.
	\end{cases}
\end{equation*}

При этом получается, что для каждого игрока $a$ назначен срок успешного выполнения задания $t^a_{DEADLINE}$, уложившись в который, он получает фиксированную выплату $u^a_{GOOD}$ (с учётом премии), а не уложившись "--- $u^a_{LATE}$ (обычную ставку). Можно придумать и более сложные схемы поощрения сотрудников, так что сформулируем сразу в общем виде:
\begin{equation}\label{intro:rewards}
	u^a(s) = v^a(t_{s^a}(s)),
\end{equation}
где $v^a(t)$ "--- монотонно невозрастающая функция оплаты за срочность по заданию сотрудника $a$. Любая игра в нормальной форме, построенная по схеме \ref{intro:game} с платёжной функцией вида \ref{intro:rewards}, в сущности является проблемой планирования задач. При этом условие монотонного невозрастания $v^a(t)$ необходимо, поскольку на него в явном виде опирается доказательство считающегося важным свойства этой игры "--- равенство $1$ цены стабильности \cite{Agussurja}. Напомним, в оптимизационных задачах с эгоистичными агентами цена стабильности представляет собой соотношение $\frac{t_{NASH}}{t_{BEST}}$, где $t_{NASH}$ "--- значение наилучшего из равновесий Нэша, а $t_{BEST}$ "--- значение глобально оптимального решения. Это означает, что в проблеме планирования задач среди всех ситуаций, минимизирующих время до остановки последнего компьютера, обязательно найдутся равновесия по Нэшу. Однако, в данной работе предлагается на время забыть о минимизации общей продолжительности вычислений и вместо этого проанализировать, какие новые свойства модели могут проявиться в отсутствие такого ограничения на монотонность.

\section{Штраф за индивидуализм}\label{sec:ch2/sec2}

Представим вычислительный центр с компьютерами, требующими сложного техобслуживания после смены, если на них запускали хотя бы одну задачу. Если поощрять укладывающихся в дедлайны сотрудников невзирая на это, несложно представить ситуацию, когда они, в стремлении любой ценой гарантировать себе премию, будут раскидывать задачи по неразумно большому количеству компьютеров. Перед лицом такой перспективы у руководства может возникнуть соблазн стимулировать своих сотрудников избегать систематической недозагрузки машин при помощи штрафов. Это может быть смоделировано ступенчатой функцией оплаты за срочность следующего вида:
\begin{equation*}
	v^a(t) = \begin{cases}
		\begin{aligned}
			u^a_{HAST}, \qquad & & & \ t < t^a_{BREAKAWAY} \hspace{-10pt} & ;\\
			u^a_{GOOD}, \qquad & t^a_{BREAKAWAY} \hspace{-8pt} & \le & \ t < t^a_{DEADLINE} & ;\\
			u^a_{LATE}, \qquad & t^a_{DEADLINE} & \le & \ t & .
		\end{aligned}
	\end{cases}
\end{equation*}

Здесь для каждого сотрудника $a$ зафиксирован не только дедлайн $t^a_{DEADLINE}$, к которому требуется успеть, чтобы получить премию $u^a_{GOOD} > u^a_{LATE}$, но и минимальная загруженность используемого компьютера $t^a_{BREAKAWAY}$, которой нужно достигнуть, чтобы не нарваться на штраф за нерациональное расходование вычислительных ресурсов $u^a_{HAST} < u^a_{GOOD}$. Размер минимальной загруженности может устанавливаться, например, в зависимости от важности соответствующей задачи "--- если срочное получение результата окупает использование дополнительных машин, то его можно сделать пониже или вовсе приравнять к нулю. Если же наоборот задача не так уж и важна, то большая минимальная загруженность заставит соответствующего сотрудника вспомнить об интересах фирмы и скооперироваться с коллегами.

Как видно, сотрудникам в данном случае приходится руководствоваться немонотонной функцией оплаты за срочность, что создаёт некоторые эффекты, несвойственные для классической формулировки проблемы планирования заданий. Во-первых, при такой постановке ожидаемо не во всякой игре цена стабильности обязана равняться $1$. Достаточно рассмотреть игру с $2$ сотрудниками и $2$ одинаковыми компьютерами:
\begin{itemize}
	\item $t_1^1 = t_2^1 = 8,\\ t_1^2 = t_2^2 = 2$;
	\item $t^1_{DEADLINE} = t^2_{DEADLINE} = 9,\\ t^1_{BREAKAWAY} = t^2_{BREAKAWAY} = 3$;
	\item $u^1_{HAST} < u^1_{LATE} < u^1_{GOOD},\\ u^2_{HAST} < u^2_{LATE} < u^2_{GOOD}$.
\end{itemize}

Поскольку первый игрок, заведомо не имеющий проблем с недозагрузкой, укладывается в дедлайн только если компьютер будет в его безраздельном пользовании, то очевидно, что сочетания стратегий, в которых оба игрока выбирают одну машину, равновесиями Нэша быть не могут. Похожим образом, поскольку второму игроку выгоднее опоздать с расчётами нежели быть наказанным за использование отдельного компьютера для недостаточно большой задачи ($u^a_{HAST} < u^a_{LATE}$), равновесиями Нэша не могут быть и те ситуации, где каждый из сотрудников использует свою машину. По структуре выплат игра оказывается неотличима от игры в чёт-нечет, вовсе не имеющей решений в чистых стратегиях и с единственным равновесием Нэша в точке независимого равновероятного выбора между альтернативами обоими игроками. При этом максимально загруженная машина с вероятностью $\frac{1}{2}$ проработает либо $10$ часов при совпадении их выбора, либо $8$ при несовпадении, что даёт математическое ожидание цены стабильности равное $\frac{9}{8}$. По сути, при отказе от монотонности функции оплаты за срочность вряд ли имеет смысл вообще рассуждать о ценах стабильности и анархии, поскольку класс игр теперь начинает включать и такие, которые явно не имеют отношения к поискам минимума продолжительности вычислений.

\section{Смешанные равновесия игры $\Gamma^3_n$}\label{sec:ch2/sec3}

Планирование заданий с немонотонной отдачей представляет собой довольно обширный класс конфликтов, анализ которого в общем виде выходит за рамки данной работы. Для наглядной демонстрации необходимого эффекта вполне достаточно будет специально сконструированного примера.  Рассмотрим игру $\Gamma^3_n$ той же общей схемы, что в предыдущем разделе, но чуть боле сложную, с $3$ однотипными заданиями и $n \ge 2$ одинаковыми компьютерами:
\begin{itemize}
	\item $t_i^1 = t_i^2 = t_i^3 = 2, i = \overline{1,n}$;
	\item $t^1_{DEADLINE} = t^2_{DEADLINE} = t^3_{DEADLINE} = 5,\\ t^1_{BREAKAWAY} = t^2_{BREAKAWAY} = t^3_{BREAKAWAY} = 3$;
	\item $u^1_{HAST} = u^2_{HAST} = u^3_{HAST} = 0,\\ u^1_{GOOD} = u^2_{GOOD} = u^3_{GOOD} = 3,\\ u^1_{LATE} = u^2_{LATE} = u^3_{LATE} = 2$
	%	\item $u^1_{HAST} < u^1_{LATE} < u^1_{GOOD},\\ u^2_{HAST} < u^2_{LATE} < u^2_{GOOD},\\ u^3_{HAST} < u^3_{LATE} < u^3_{GOOD}$.
\end{itemize}

Проще говоря, в игре $\Gamma^3_n$ выгоднее всего использовать компьютер вдвоём "--- $4$ часа суммарной продолжительности работы оказываются как раз в оптимальном промежутке между границей недогруза и дедлайном. Следующий по выгоде вариант "--- использование одной машины втроём, что приводит к штрафу за опоздание. Наименее привлекателен выбор компьютера, на котором задача оказывается одна "--- за такое расходование общественного ресурса игрок не получает вообще ничего. На первый взгляд эта игра не выглядит слишком необычно. В ней без особого труда находятся равновесия Нэша в чистых стратегиях "--- все наборы $(i, i, i), i = \overline{1,n}$, причём очевидно и то, что других решений в чистых стратегиях быть не может. Со смешанными стратегиями дело становится чуть интереснее.

\begin{lemma}
	Пусть $T \subseteq \{1, \ldots, n\}$ "--- произвольное непустое подмножество компьютеров. Тогда в игре $\Gamma^3_n$ набор одинаковых смешанных стратегий $s^1 = s^2 = s^3 = \left(\frac{[1 \in T]}{\left| T \right|}, \ldots, \frac{[n \in T]}{\left| T \right|}\right)$, где каждый игрок независимо и равновероятно выбирает одну из машин множества $T$, является равновесием по Нэшу.\footnote{Здесь и далее для упрощения и сокращения записи используется нотация <<скобка Айверсона>>: $[P]$ вычисляется в $1$, если предикат $P$ истинен, и в $0$, если ложен.}
\end{lemma}

\begin{proof}
	Воспользуемся тем, что достаточно проверить отклонения только в пользу чистых стратегий. Обозначим символом $\left. s \right|^a_i$ отклонение от набора $s$ игроком $a$ в пользу стратегии $i$ и заметим, что 
	\begin{align*}
		u^a(\left. s \right|^a_i) &= [i \in T] \left(\frac{(\left| T \right| - 1)^2}{\left| T \right|^2} u^a_{HAST} + 2 \frac{\left| T \right| - 1}{\left| T \right|^2} u^a_{GOOD} + \frac{1}{\left| T \right|^2} u^a_{LATE}\right)\\
		&= [i \in T] \frac{6 \left| T \right| - 4}{\left| T \right|^2}.
	\end{align*}
	
	Таким образом, для каждого игрока максимум ожидаемого выигрыша достигается при отклонении в пользу любого из компьютеров, входящих в $T$.
\end{proof}

Соответственно без отклонений математическое ожидание выигрышей предстаёт в виде $u^a(s) = \frac{6 \left| T \right| - 4}{\left| T \right|^2}, a = \overline{1,3}$. Для доказательства того, что других равновесий по Нэшу в смешанных стратегиях нет, нам понадобятся ещё пара лемм:

\begin{lemma}
	В игре $\Gamma^3_n$ набор смешанных стратегий $s = (s^1, s^2, s^3)$ может быть равновесием по Нэшу только в том случае, когда $s^1 = s^2 = s^3$.
\end{lemma}

\begin{proof}
	Пусть $s^a = (p_1^a, \ldots, p_n^a), a = \overline{1,3}$. Если стратегии игроков не совпадают, то найдётся компьютер $i$, для которого (без потери общности) вероятности выбора первым и вторым игроком $p_i^1 > p_i^2$. В силу элементарных свойств вероятностей, найдётся также и компьютер $j$, где $p_j^1 < p_j^2$. Выпишем математическое ожидание выигрышей тех же игроков при выборе ими $i$"~го компьютера (для $j$"~го всё совпадает с точностью до индекса, очевидно):
	\begin{align*}
		u^1(\left. s \right|^1_i) &= (1 - p_i^2) (1 - p_i^3) u^1_{HAST} + (p_i^2 + p_i^3 - 2 p_i^2 p_i^3) u^1_{GOOD} + p_i^2 p_i^3 u^1_{LATE}\\ &= 3 p_i^2 + 3 p_i^3 - 4 p_i^2 p_i^3;\\
		u^2(\left. s \right|^2_i) &= 3 p_i^1 + 3 p_i^3 - 4 p_i^1 p_i^3;\\
		u^3(\left. s \right|^3_i) &= 3 p_i^1 + 3 p_i^2 - 4 p_i^1 p_i^2.
	\end{align*}
	
	Про функцию $f(x,y) = 3x + 3y - 4xy$ на области определения $0 \le x \le 1, 0 \le y \le 1$ можно заметить следующее "--- если $f(x_0, y_0) < 2$, то для любых $x_1 > x_0, y_1 \ge y_0$ или $x_1 \ge x_0, y_1 > y_0$ выполняется $f(x_0, y_0) < f(x_1, y_1)$. Предположим, что $p_i^3 \le p_j^3$ (если $p_i^3 \ge p_j^3$, рассуждения аналогичны с точностью до индексов). Рассмотрим следующие случаи:
	\begin{itemize}
		\item $p_i^2 < p_j^2$. В силу элементарных свойств вероятностей мы можем быть уверены, что $p_i^2 < \frac{1}{2}$ и $p_i^3 \le \frac{1}{2}$, откуда $u^1(\left. s \right|^1_i) < 2$, а значит $u^1(\left. s \right|^1_i) < u^1(\left. s \right|^1_j)$. Поскольку $p_i^1 > p_i^2 \ge 0$, первый игрок выбирает неоптимальную стратегию с ненулевой вероятностью. $\bot$
		\item $p_i^2 \ge p_j^2$, из чего следует $p_i^1 > p_j^1$, а значит аналогично предыдущему пункту $u^3(\left. s \right|^3_j) < u^3(\left. s \right|^3_i)$. Если $p_j^3 > 0$, то третий игрок выбирает неоптимальную стратегию с ненулевой вероятностью. $\bot$
		\item $p_i^2 \ge p_j^2$, как и в предыдущем случае, но теперь $p_i^3 = p_j^3 = 0$. Из $p_j^1 < p_i^1$ аналогичным образом следует $u^2(\left. s \right|^2_j) < u^2(\left. s \right|^2_i)$, и поэтому $p_j^2 > p_j^1 \ge 0$ влечёт выбор неоптимальной стратегии с ненулевой вероятностью уже вторым игроком. $\bot$
	\end{itemize}
	
	Таким образом предположение о существовании компьютера, для которого вероятность выбора его одним игроком отличается от вероятности выбора другим, в любом случае противоречит необходимому условию равновесия Нэша.
\end{proof}

\begin{lemma}
	В игре $\Gamma^3_n$ набор одинаковых смешанных стратегий может быть равновесием по Нэшу только в том случае, когда все компьютеры, выбираемые с ненулевой вероятностью, выбираются с равными вероятностями.
\end{lemma}

\begin{proof}
	Возьмём любой набор, состоящий из одинаковых стратегий $(p_1, \ldots, p_n)$, где $0 < p_i < p_j$. Пользуясь формулой выплат из предыдущей леммы, $u^a(\left. s \right|^a_i) = 2 p_i (3 - 2 p_i)$. Опять же, из $p_i < \frac{1}{2}$ следует $u^a(\left. s \right|^a_i) < u^a(\left. s \right|^a_j)$, а значит все игроки выбрали неоптимальную стратегию с ненулевой вероятностью, что противоречит необходимому условию равновесия по Нэшу.
\end{proof}

Доказав, что предложенные точки равновесия исчерпывают пространство решений в смешанных стратегиях, мы можем сконструировать выпуклую оболочку множества достижимых векторов выплат. Поскольку множество целиком лежит на прямой $(u, u, u)$, достаточно найти минимум и максимум ожидаемых выигрышей:

\begin{align*}
	\min_{\emptyset \subset T \subseteq \{1,\ldots,n\}} \frac{6 \left| T \right| - 4}{\left| T \right|^2} &= \frac{6 n - 4}{n^2};\\
	\max_{\emptyset \subset T \subseteq \{1,\ldots,n\}} \frac{6 \left| T \right| - 4}{\left| T \right|^2} &= 2.
\end{align*}

Таким образом искомая выпуклая оболочка представляет собой отрезок, соединяющий точки $(2, 2, 2)$ и $(\frac{6 n - 4}{n^2}, \frac{6 n - 4}{n^2}, \frac{6 n - 4}{n^2})$. Если бы рассматриваемая игра не была чувствительна к дополнительной информационной асимметрии, на этом её анализ можно было бы закончить "--- все игроки находятся в равном положении и, действуя оптимально, могут ожидать равных выигрышей из указанного промежутка. Однако, взгляд на этот конфликт через призму модели заговоров делает картину происходящего куда интереснее.

\section{Коррелированные равновесия игры $\Gamma^3_n$ в пространстве заговоров}\label{sec:ch2/sec4}

Проанализируем этот же конфликт с позиций теории заговоров, перейдя к игре $\Gamma^3_n | \{\{1,2\}\}$. При этом игра $\Gamma^3_n$ дополняется одной вещественной рулеткой, результат вращения которой перед выбором стратегии узнают игроки $1$ и $2$, но не $3$. Для получения равновесного набора коррелированных стратегий, выводящего платежи за выпуклую оболочку множества решений в смешанных стратегиях, заговорщикам достаточно взять любую из классических точек равновесия по Нэшу с $\left| T \right| \ge 2$, но вместо того, чтобы выбирать между элементами $T$ независимо, они должны разделить тайную рулетку на $\left| T \right|$ равных секторов и делать свой выбор синхронно, в зависимости от выпавшего сектора. Опишем это более формально, используя пространство корреляции
\begin{equation*}
	\Phi = \langle A, \Omega, \mathfrak{I}^a, \mathbb{P}, a \in A \rangle
\end{equation*}

В данном случае множество состояний природы $\Omega = \left[0, 1\right)$, $\sigma$"~алгебры информированности игроков $\mathfrak{I}^1 = \mathfrak{I}^2$ "--- борелевские, $\mathfrak{I}^3 = \{\emptyset, \Omega\}$ и мера $\mathbb{P}(X) = \left| X \right|$. Вышеописанные стратегии в игре $\Gamma^3_n | \Phi$ можно представить в виде функций, отображающих множество состояний природы в пространство смешанных стратегий:
\begin{align*}
	\mathbf{s}^1(\omega) = \mathbf{s}^2(\omega) &= ([i_\omega = 1], \ldots, [i_\omega = n]); \\ \mathbf{s}^3(\omega) &= \left(\frac{[1 \in T]}{\left| T \right|}, \ldots, \frac{[n \in T]}{\left| T \right|}\right).
\end{align*}

\FloatBarrier
