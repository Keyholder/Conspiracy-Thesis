\chapter{Краткий обзор литературы, посвящённой коррелированному расширению игр в нормальной форме}\label{app:A}

Концепция коррелированного расширения стала важным общеупотребимым инструментом во многих областях теории игр, и в частности на неё опирается знаменитый дизайн механизмов. В связи с этим нельзя не упомянуть статью Роджера Майерсона <<Optimal coordination mechanisms in generalized principal"~agent problems>> \cite{Myerson82}. В ней формулируется обобщённая задача принципал"~агентов, в которой агенты обладают как тайной информацией, так и возможностью принимать решения, неподконтрольные принципалу. Показывается, что принципал может ограничиваться целенаправленно побуждающими прямыми механизмами координации, в которых агенты докладывают свою информацию принципалу, рекомендующему в ответ стратегии, образующие коррелированное равновесие. В конечном случае оптимальные механизмы координации могут быть найдены при помощи линейного программирования. Кроме того обсуждается проблематика систем с многими принципалами, в которых может не существовать некооперативного равновесия, так что вводится определение и показывается существование квази"~равновесия.

Коррелированное расширение нашло своё место и применительно к исследованию игр в развёрнутой форме. Ещё одна статья Роджера Майерсона <<Multistage Games with Communication>> \cite{Myerson86} рассматривает многостадийные игры с коммуникационным механизмом, функционирующим по принципу централизованного посредника. В коммуникационном равновесии ни один игрок не должен иметь возможность в одиночку увеличить свой выигрыш, манипулируя своими отчётами или действиями. Последовательное коммуникационное равновесие "--- это коммуникационное равновесие с системой условных вероятностей при которой ни один игрок не может получить выгоду от подобных манипуляций, даже если случаются события нулевой вероятности. Кодоминируемые действия определяются таким образом, что любое коммуникационное равновесие последовательно в том и только том случае, когда никто не использует кодоминируемых действий. Преобладающее коммуникационное равновесие определяется как результат последовательного исключения кодоминируемых действий, и показывается его существование.

Ещё одной важной вехой стала статья <<Correlated equilibrium as an expression of Bayesian rationality>> \cite{Aumann87}, в которой Ауман показал, что формализм коррелированного равновесия снимает противоречие между <<байесовским>> и <<теоретико"~игровым>> взглядом на мир. С байесовской позиции вероятности могут быть сопоставлены с чем угодно, даже с возможностью для игрока выбрать какую"~либо стратегию в некоторой игре. С точки зрения самой теории игр, напротив, традиционно считается, что нельзя говорить о вероятностях событий, происходящих по воле рациональных агентов, нужно вместо этого использовать понятие равновесности (или другие теоретико-игровые конструкты). Предложенный формализм же объединяет две эти точки зрения "--- на коррелированное равновесие можно смотреть как на следствие байесовской рациональности, поскольку условие равновесности представляет собой простую максимизацию выгоды каждым из игроков с учётом известной им информации. При таком подходе не требуется явной рандомизации в действиях игроков. Даже если игрок выбирает конкретную чистую стратегию без элемента случайности, вероятностная природа стратегий отражает неуверенность остальных игроков в его выборе, что и показывается на примерах.

Вопросы совместимости коррелированных равновесий с более строгими принципами оптимальности поднимались в статье Амриты Дхиллона и Жана Франсуа Мертенса <<Perfect Correlated Equilibria>> \cite{Dhillon}. В ней вводится понятие $(\epsilon)$"~совершенных кореллированных равновесий (PCE), обусловленных $(\epsilon)$"~совершенным равновесием некоторого корреляционного устройства. Показывается, что <<принцип выявления>> для этой концепции теряет силу "--- прямой механизм может и не обеспечивать совершенного равновесия. Так называемые приблизительно совершенные коррелированные равновесия (APCE) оказываются пределами $\epsilon$"~PCE, и авторы достигают для них полной характеризации. В ходе рассуждений о <<приемлемости>> APCE в некотором смысле, приводятся однако иллюстрированные доводы в пользу того, что среди них именно PCE представляются <<хорошими>>.

Динамический аспект формализма коррелированного расширения тоже не оставался без внимания исследователей. Предлагалось немало процедур разыгрывания для итеративных игр, обеспечивающих сходимость к коррелированным равновесиям. Среди множества работ на эту тему выделяется статья Серджиу Харта и Андреу Мас"~Колелла <<A simple adaptive procedure leading to correlated equilibrium>> \cite{Hart}, в которой авторы предложили так называемую процедуру сопоставления потерь. Применяя её, игроки каждый раз отклоняются от своих текущих стратегий пропорционально мере понесённого ими на предыдущих ходах ущерба от не использования иных стратегий. Показывается, что такая адаптивная процедура гарантирует в любой игре сходимость с вероятностью $1$ эмпирического распределения розыгрышей к множеству коррелированных равновесий.

\chapter{Доказательство теоремы об изоморфизме пространств корреляции}\label{app:B}

Прежде чем перейти к доказательству основного утверждения потребуется ввести дополнительный инструментарий:

\begin{definition}
	Измельчением множества исходов $X = X^1 \times \ldots \times X^m$ до конечного множества исходов $Y = Y^1 \times \ldots \times Y^m$ называется любое отображение $\rho = (\rho^1, \ldots, \rho^m)$, где каждая компонента $\rho^a$ отображает $Y^a$ в $X^a$.
\end{definition}

При помощи измельчений можно задавать связи между разбиениями с различными кодоменами. Если разбиения $f : \Omega \rightarrow X$ и $g : \Omega \rightarrow Y$ таковы, что $f = \rho \circ g$, то $f^{-1}(x) = \bigcup_{y \in \rho^{-1}(x)} g^{-1}(y), \forall x \in X$. При этом $f$ можно называть измельчимым до $g$.

Разбиения одного и того же пространства можно комбинировать. Например, из разбиений $g_i : \Omega \rightarrow Y_i = Y_i^1 \times \ldots \times Y_i^m, i=\overline{1,n}$ можно построить их комбинацию $g_1 \diamond \ldots \diamond g_n : \Omega \rightarrow Y_{(n)}$, где $Y_{(n)}^a = Y_1^a \times \ldots \times Y_n^a$ и $(g_1 \diamond \ldots \diamond g_n)^a(\omega) = (g_1^a(\omega), \ldots, g_n^a(\omega)), \forall \omega \in \Omega, a =\overline{1,m}$. Эта комбинация разбиений связана со своими компонентами измельчениями"~проекциями: $g_i  = \pi_i \circ (g_1 \diamond \ldots \diamond g_n), \pi_i^a(x_1^a, \ldots, x_n^a) = x_i^a$.

Аналогично комбинируются и измельчения с общим кодоменом. Например, из измельчений $\rho_i : Y_i \rightarrow X, i=\overline{1,n}$ можно построить комбинацию $\rho_1 \wr \ldots \wr \rho_n : Y_{[n]} \rightarrow X$, где $Y_{[n]}^a = \{(y_1^a, \ldots, y_n^a) \in Y_{(n)}^a \mid \rho_1^a(y_1^a) = \ldots = \rho_n^a(y_n^a)\}, a =\overline{1,m}$, причём на своей области определения $\rho_1 \wr \ldots \wr \rho_n$ совпадает со всеми $\rho_i \circ \pi_i$. Заметим, что
\begin{equation*}
	f = \rho_i \circ g_i, i=\overline{1,n} \;\Leftrightarrow\; f = (\rho_1 \wr \ldots \wr \rho_n) \circ (g_1 \diamond \ldots \diamond g_n).
\end{equation*}

\begin{definition}
	В пространстве корреляции $\Phi = \langle A, \Omega, \mathfrak{I}^a, \mathbb{P}, a \in A \rangle$ структурой разбиения $f : \Omega \rightarrow X$, порождённой измельчением $\rho : Y \rightarrow X$, называется множество $H_{\Phi,\rho}(f) = \{\mathbb{P} \circ g^{-1} \mid g \models \Phi, f = \rho \circ g\}$, состоящее из мер $\mu : Y \rightarrow \mathbb{R}_{\ge 0}$. Также обозначим $H_{\Phi,\rho}^{-1}(\mu) = \{f \models \Phi \mid \mu \in H_{\Phi,\rho}(f)\}$.
\end{definition}

\begin{lemma} \label{lemma:tyhon}
	Для всех $\rho : Y \rightarrow X$ и $\mu : Y \rightarrow \mathbb{R}_{\ge 0}$ множество $H_{\Phi,\rho}^{-1}(\mu) \subseteq X^{\Omega}$ компактно в полуметрике
	\begin{equation*}
		\operatorname{dis}(f_1, f_2) = \frac{1}{2} \sum_{x \in X} \left| \mathbb{P}(f_1^{-1}(x)) - \mathbb{P}(f_2^{-1}(x)) \right|.
	\end{equation*}
\end{lemma}

\begin{proof}
	Переформулируем $H_{\Phi,\rho}^{-1}(\mu) = \rho \circ H_{\Phi}^{-1}(\mu)$, определив для этого отображение $H_{\Phi}^{-1}(\mu) = \{g \models \Phi \mid \mathbb{P} \circ g^{-1} = \mu\}$. Докажем сперва компактность $H_{\Phi}^{-1}(\mu)$, вводя $\operatorname{dis}(g_1, g_2)$ аналогично $\operatorname{dis}(f_1, f_2)$. Полуметрика $\operatorname{dis}$ вполне ограниченна, так как $\operatorname{dis}(g_1, g_2) = d(\mu^Y_1, \mu^Y_2)$, где $\mu^Y_k = \mathbb{P} \circ g_k^{-1}, k=1,2$, а пространство вероятностных мер на любом конечном множестве вполне ограниченно. Замкнутость $H_{\Phi}^{-1}(\mu)$ очевидно следует из $\operatorname{dis}(g_1, g_2) = 0 \Leftrightarrow \mathbb{P} \circ g_1^{-1} = \mathbb{P} \circ g_2^{-1}$. Таким образом $H_{\Phi}^{-1}(\mu)$ компактно в полуметрике $\operatorname{dis}$. Докажем непрерывность отображения $\rho\ \circ : Y^\Omega \rightarrow X^\Omega$, выразив ту же полуметрику по-другому:
	\begin{equation*}
		\operatorname{dis}(f_1, f_2) = 1 - \sum_{x \in X} \min \left[\mathbb{P}(f_1^{-1}(x)), \mathbb{P}(f_2^{-1}(x))\right].
	\end{equation*}
	
	Пусть теперь $f_1 = \rho \circ g_1$ и $f_2 = \rho \circ g_2$:
	\begin{align*}
		\operatorname{dis}(\rho \circ g_1, \rho \circ g_2) &= 1 - \sum_{x \in X} \min \left[\mathbb{P}(g_1^{-1}(\rho^{-1}(x))), \mathbb{P}(g_2^{-1}(\rho^{-1}(x)))\right] \\
		&= 1 - \sum_{x \in X} \min \left[\sum_{y \in \rho^{-1}(x)} \mathbb{P}(g_1^{-1}(y)), \sum_{y \in \rho^{-1}(x)} \mathbb{P}(g_2^{-1}(y))\right] \\
		&\le 1 - \sum_{x \in X} \sum_{y \in \rho^{-1}(x)} \min \left[\mathbb{P}(g_1^{-1}(y)), \mathbb{P}(g_2^{-1}(y))\right] \\
		&= 1 - \sum_{y \in Y} \min \left[\mathbb{P}(g_1^{-1}(y)), \mathbb{P}(g_2^{-1}(y))\right] = \operatorname{dis}(g_1, g_2).
	\end{align*}
	
	Отображение $\rho\ \circ$ непрерывно, поскольку $\operatorname{dis}(\rho \circ g_1, \rho \circ g_2) \le \operatorname{dis}(g_1, g_2)$. Так как непрерывные отображения сохраняют компактность\cite[с.~199]{Engelking}, $H_{\Phi,\rho}^{-1}(\mu) = \rho \circ H_{\Phi}^{-1}(\mu)$ компактно в полуметрике $\operatorname{dis}$.
\end{proof}

\begin{definition}
	Разбиение $f_2 \models \Phi_2$ называется точным образом разбиения $f_1 \models \Phi_1$ (далее $f_1 \precsim f_2$), если их кодомены совпадают ($X_1 = X_2 = X$) и $H_{\Phi_1,\rho}(f_1) \subseteq H_{\Phi_2,\rho}(f_2)$ для всех измельчений $\rho$ с тем же кодоменом. Множество всех точных образов далее будем обозначать $\widehat{\Phi}_2(f_1) = \{f_2 \models \Phi_2 \mid f_1 \precsim f_2\}$.
\end{definition}

Отношение $f_1 \precsim f_2$ можно понять так "--- на какие бы измеримые части мы не делили компоненты разбиения $f_1$, в разбиении $f_2$ соответствующие компоненты всегда можно разделить на равные им по мере части.

\begin{note}
	Очевидно, что $f_1 \precsim f_2 \wedge f_2 \precsim f_3 \Rightarrow f_1 \precsim f_3$.
\end{note}

\begin{lemma} \label{lemma:up}
	Пусть в пространствах корреляции $\Phi_1$ и $\Phi_2$ разбиения $g_1 : \Omega_1 \rightarrow Y$ и $g_2 : \Omega_2 \rightarrow Y$ таковы, что $g_1 \precsim g_2$. Тогда $\rho \circ g_1 \precsim \rho \circ g_2$ для всех измельчений $\rho : Y \rightarrow X$.
\end{lemma}

\begin{proof}
	Возьмём любые $\rho_* : Y_* \rightarrow X$ и $\mu \in H_{\Phi_1,\rho_*}(\rho \circ g_1)$. По определению структуры разбиения, $\exists g_{1*}: \rho_* \circ g_{1*} = \rho \circ g_1, \mathbb{P}_1 \circ g_{1*}^{-1} = \mu$, а доказать требуется, по определению точного образа, что $\exists g_{2*}: \rho_* \circ g_{2*} = \rho \circ g_2, \mathbb{P}_2 \circ g_{2*}^{-1} = \mu$. Рассмотрим комбинацию $g_{1+} = g_1 \diamond g_{1*}$, где $g_1 = \pi \circ g_{1+}$ и $g_{1*} = \pi_* \circ g_{1+}$. Здесь $g_{1+} : \Omega_1 \rightarrow Y_+, Y_+^a = Y^a \times Y_*^a, a=\overline{1,m}$. По определению структуры разбиения, $\mathbb{P}_1 \circ g_{1+}^{-1} \in H_{\Phi_1,\pi}(g_1)$, а значит, поскольку $g_1 \precsim g_2$, существует $g_{2+} : \Omega_2 \rightarrow Y_+$ такое, что $\mathbb{P}_1 \circ g_{1+}^{-1} = \mathbb{P}_2 \circ g_{2+}^{-1} \in H_{\Phi_2,\pi}(g_2)$, т.е. $\pi \circ g_{2+} = g_2$. Из этого с очевидностью следует, что и $\mathbb{P}_2 \circ (\pi_* \circ g_{2+})^{-1} = \mathbb{P}_1 \circ (\pi_* \circ g_{1+})^{-1}$, а значит $g_{2*} = \pi_* \circ g_{2+}$ искомое.
\end{proof}

\begin{lemma} \label{lemma:down}
	Пусть в пространствах корреляции $\Phi_1$ и $\Phi_2$ разбиения $f_1 : \Omega_1 \rightarrow X$ и $f_2 : \Omega_2 \rightarrow X$ таковы, что $f_1 \precsim f_2$. Тогда для каждого измельчения $\rho : Y \rightarrow X$ и каждого разбиения $g_1 : \Omega_1 \rightarrow Y$ такого, что $f_1 = \rho \circ g_1$ существует разбиение $g_2 : \Omega_2 \rightarrow Y$ такое, что $f_2 = \rho \circ g_2$ и $g_1 \precsim g_2$.
\end{lemma}

\begin{proof}
	Сформулируем требуемое как $\exists g_2 \in \widehat{\Phi}_2(g_1) : f_2 = \rho \circ g_2$ и выразим $\widehat{\Phi}_2$ через структуры разбиений:
	\begin{equation*}% \label{eq:goal1}
		\widehat{\Phi}_2(g_1) = \bigcap_{\forall Z, \xi : Z \rightarrow Y, \mu \in H_{\Phi_1,\xi}(g_1)} H_{\Phi_2,\xi}^{-1}(\mu).
	\end{equation*}
	
	По лемме \ref{lemma:tyhon} множество $\widehat{\Phi}_2(g_1)$ является пересечением семейства компактов. Следовательно, для доказательства содержания в нём элемента $g_2 : f_2 = \rho \circ g_2$, достаточно доказать, что такой элемент содержится в пересечении каждого конечного подсемейства тех же компактов:
	\begin{equation*}% \label{eq:goal1}
		\exists g_{2*} \in \bigcap_{i=1}^n H_{\Phi_2,\xi_i}^{-1}(\mu_i) : f_2 = \rho \circ g_{2*},
	\end{equation*}
	где $\xi_i : Z_i \rightarrow Y$ "--- произвольные измельчения с произвольными доменами $Z_i$ и $\mu_i \in H_{\Phi_1,\xi_i}(g_1)$ также выбраны произвольно.
	
	По определению структуры разбиения $\exists h_{1,i} \models \Phi_1 : g_1 = \xi_i \circ h_{1,i}, \mathbb{P} \circ h_{1,i}^{-1} = \mu_i$. Построим их комбинацию $h_1 = h_{1,1} \diamond ... \diamond h_{1,n}$, где $h_{1,i} = \pi_i \circ h_1$, и обозначим $\xi = \xi_1 \wr ... \wr \xi_n$. По определению точного отображения $\exists h_2 \models \Phi_2 : f_2 = \rho \circ \xi \circ h_2, \mathbb{P}_1 \circ h_1^{-1} = \mathbb{P}_2 \circ h_2^{-1}$, а значит можно взять $g_{2*} = \xi \circ h_2$. По построению $f_2 = \rho \circ g_{2*}$ и $\mathbb{P}_1 \circ h_{1,i}^{-1} = \mathbb{P}_1 \circ (\pi_i \circ h_1)^{-1} = \mathbb{P}_2 \circ (\pi_i \circ h_2)^{-1} = \mathbb{P}_2 \circ h_{2,i}^{-1}$, следовательно $g_{2*}$ "--- искомое.
\end{proof}

\begin{corollary} \label{cor:down}
	Если пространства корреляции $\Phi_1 \precsim \Phi_2$, то для каждого разбиения $f_1 \models \Phi_1$ существует $f_2 \models \Phi_2$ такое, что $f_1 \precsim f_2$.
\end{corollary}

\begin{corollary}
	Леммы \ref{lemma:up}, \ref{lemma:down} и следствие \ref{cor:down} также верны для строгого отношения $f_1 \prec f_2 \equiv f_1 \precsim f_2 \cap \neg (f_1 \succsim f_2)$.
\end{corollary}

\begin{lemma}
	$f_1 \precsim f_2 \Leftrightarrow f_1 \succsim f_2$ для любых разбиений одного и того же пространства корреляции.
\end{lemma}

\begin{proof}
	Предположим обратное "--- существование $f_1 \prec f_2$ с кодоменом $X$. Тривиальное измельчение $\theta(x) = (0, \ldots, 0), \forall x \in X$ очевидно даёт $\theta \circ f_1 = \theta \circ f_2$. Это противоречит $\theta \circ f_1 \prec \theta \circ f_2$, следующему из леммы \ref{lemma:up}.
\end{proof}

\begin{corollary} \label{cor:sym}
	$f_1 \precsim f_2 \Leftrightarrow f_1 \succsim f_2$ для любых разбиений изоморфных пространств корреляции.
\end{corollary}

\begin{proof}[Доказательство теоремы об изоморфных пространствах]
	Рассмотрим в игре $\Gamma | \Phi_1$ произвольный профиль стратегий $\mathbf{s}_1$. Этот профиль, очевидно, является разбиением пространства корреляции $\Phi_1$. По следствию \ref{cor:down} существует разбиение $\mathbf{s}_2$ пространства корреляции $\Phi_2$ такое, что $\mathbf{s}_1 \precsim \mathbf{s}_2$, причём, аналогично, $\mathbf{s}_2$ является ещё и профилем стратегий в игре $\Gamma | \Phi_2$. Докажем вложения в обоих направлениях: 1. $U_{\Gamma | \Phi_1}^{A_*}(\mathbf{s}_1) \subseteq U_{\Gamma | \Phi_2}^{A_*}(\mathbf{s}_2)$ и 2. $U_{\Gamma | \Phi_1}^{A_*}(\mathbf{s}_1) \supseteq U_{\Gamma | \Phi_2}^{A_*}(\mathbf{s}_2)$ для любой группы игроков $A_*$:
	\begin{enumerate}
		\item Рассмотрим произвольный профиль $\mathbf{s}_{1*} \models \Phi_1$, отличающийся от $\mathbf{s}_1$ стратегиями группы $A_*$. Обозначим $\mathbf{s}_{1+} = \mathbf{s}_1 \diamond \mathbf{s}_{1*}$, где $\mathbf{s}_1 = \pi \circ \mathbf{s}_{1+}$ и $\mathbf{s}_{1*} = \pi_* \circ \mathbf{s}_{1+}$. По определению точного образа $H_{\Phi_1,\pi}(\mathbf{s}_1) \subseteq H_{\Phi_2,\pi}(\mathbf{s}_2)$, т.е. $\exists \mathbf{s}_{2+} \models \Phi_2 : \mathbb{P}_1 \circ \mathbf{s}_{1+} = \mathbb{P}_2 \circ \mathbf{s}_{2+}, \mathbf{s}_2 = \pi \circ \mathbf{s}_{2+}$. По построению $\mathbf{s}_{2*} = \pi_* \circ \mathbf{s}_{2+}$ отличается от $\mathbf{s}_2$ ходами тех же игроков, что отличают $\mathbf{s}_{1*}$ от $\mathbf{s}_1$, и $\mathbb{P}_1 \circ \mathbf{s}_{1*}^{-1} = \mathbb{P}_2 \circ \mathbf{s}_{2*}^{-1}$, а значит аналогичным образом $u^a(\mathbf{s}_{1*}) = u^a(\mathbf{s}_{2*})$. В силу произвольности выбора $\mathbf{s}_{1*}$ это влечёт $U_{\Gamma | \Phi_1}^{A_*}(\mathbf{s}_1) \subseteq U_{\Gamma | \Phi_2}^{A_*}(\mathbf{s}_2)$.
		\item Так как $\mathbf{s}_1 \succsim \mathbf{s}_2$ по следствию \ref{cor:sym}, рассуждения предыдущего пункта применимы и в обратном направлении.
	\end{enumerate}
\end{proof}

\chapter{Доказательство теоремы о пространствах заговоров одной структуры}\label{app:C}

Для доказательства теоремы об изоморфизме пространств заговоров так же понадобится несколько лемм.

\begin{lemma}\label{lemma:card}
	Для любого счётного семейства множеств $\mathfrak{F}$ найдётся цепь множеств $\mathfrak{T}$ такая, что $\sigma(\mathfrak{F}) = \sigma(\mathfrak{T})$.
\end{lemma}

\begin{proof}
	Пусть $\mathfrak{F} = \{F_1, F_2, \ldots\}$. Построим индуктивно последовательность цепей $(\mathfrak{T}_i)$, где каждая следующая цепь включает в себя предыдущую и $\sigma(\mathfrak{T}_i) = \sigma(\{F_1, \ldots, F_i\})$. В качестве базы возьмём $\mathfrak{T}_1 = \{F_1\}$. Шаг индукции: пусть $\mathfrak{T}_{i-1} = \{T_1, \ldots, T_n\}, T_1 \subset \ldots \subset T_n$ и $\sigma(\mathfrak{T}_{i-1}) = \sigma(\{F_1, \ldots, F_{i-1}\})$. Разложим следующий элемент $\mathfrak{F}$ на непересекающиеся дизъюнкты: $F_i = (F_i \cap T_1) \cup (F_i \cap T_2 \setminus T_1) \cup \ldots \cup (F_i \cap T_n \setminus T_{n-1}) \cup (F_i \setminus T_n)$. В этой записи $j$"~й дизъюнкт вложен в соответствующую разность $T_j \setminus T_{j-1}$ соседних элементов цепи. Следовательно, для его порождения достаточно пополнить $\mathfrak{T}_{i-1}$ множеством $T_{j-} = F_i \cap T_j \cup T_{j-1}$, сохраняющим структуру цепи, поскольку $T_{j-1} \subseteq T_{j-} \subseteq T_j$. Таким образом, чтобы получить $F_i$ целиком,
	\begin{equation*}
		\mathfrak{T}_i = \mathfrak{T}_{i-1} \cup \left\{
		\begin{aligned}
			&F_i \cap T_1,\\
			&F_i \cap T_2 \cup T_1,\\
			&\cdots\\
			&F_i \cap T_n \cup T_{n-1},\\
			&F_i \cup T_n
		\end{aligned}
		\right\}
	\end{equation*}
	
	Покажем, что предел последовательности $(\mathfrak{T}_i)$ "--- искомая цепь. В самом деле, любой элемент из $\sigma(\mathfrak{F})$ "--- это счётное объединение конечных пересечений множеств $F_i$. Поэтому
	\begin{equation*}
		\sigma(\mathfrak{F}) = \bigcup_{i=1}^{\infty} \sigma(\{F_1, \ldots, F_i\}) = \bigcup_{i=1}^{\infty} \sigma(\mathfrak{T}_i) = \sigma(\mathfrak{T}).
	\end{equation*}
\end{proof}

\begin{lemma} \label{lemma:max}
	Максимальная цепь измеримых множеств в безатомическом пространстве порождает безатомическую $\sigma$"~алгебру.
\end{lemma}

\begin{proof}
	Пусть максимальная цепь $\mathfrak{T}$ измеримых множеств безатомического пространства $\langle \Omega, \mathfrak{B}, \mathbb{P} \rangle$ порождает алгебру $\sigma(\mathfrak{T})$. Докажем, что для любого $B \in \sigma(\mathfrak{T})$ меры $\mathbb{P}(B) > 0$ найдётся $B' \in \sigma(\mathfrak{T})$ такое, что $B' \subset B$ и $\mathbb{P}(B) > \mathbb{P}(B') > 0$. Для этого, очевидно, достаточно доказать, что в цепи $\mathfrak{T}$ найдётся множество $T$ такое, что $0 < \mathbb{P}(T \cap B) < \mathbb{P}(B)$. Рассмотрим множества
	\begin{equation*}
		\underline{T} = \bigcup_{T_- \in \mathfrak{T} : \mathbb{P}(T_- \cap B) = 0} T_- \quad\text{и}\quad \overline{T} = \bigcap_{T_+ \in \mathfrak{T} : \mathbb{P}(T_+ \cap B) = \mathbb{P}(B)} T_+,
	\end{equation*}
	по построению вложенные $\underline{T} \subset \overline{T}$ так, что $\mathbb{P}(\overline{T}) - \mathbb{P}(\underline{T}) \ge \mathbb{P}(B)$. Поскольку цепь $\mathfrak{T}$ максимальна в безатомическом пространстве, существует $T_0 \in \mathfrak{T}$ такое, что $\underline{T} \subset T_0 \subset \overline{T}$. Так как $\underline{T} \subset T_0 \Rightarrow \mathbb{P}(T_0 \cap B) > 0$ и $T_0 \subset \overline{T} \Rightarrow \mathbb{P}(T_0 \cap B) < \mathbb{P}(B)$, значит $T_0$ искомое.
\end{proof}

\begin{definition}
	Для любых семейств измеримых множеств $\mathfrak{T} \subseteq 2^\Omega$ и мер $\mathbb{P} : \mathfrak{T} \rightarrow \mathbb{R}_{\ge 0}$ определим отображение $\operatorname{mim}\langle\mathfrak{T}, \mathbb{P}\rangle : \Omega \rightarrow \mathbb{R}_{\ge 0}$, называемое наименьшей мерой включения и вычисляемое по формуле $\operatorname{mim}\langle\mathfrak{T}, \mathbb{P}\rangle(\omega) = \inf\{\mathbb{P}(T) \mid \omega \in T \in \mathfrak{T}\}$.
\end{definition}

\begin{lemma}
	Если $\mathfrak{T} \subset 2^\Omega$ "--- цепь множеств, порождающая безатомическую $\sigma$"~алгебру, то $\mathbb{P} \circ \operatorname{mim}\langle\mathfrak{T}, \mathbb{P}\rangle^{-1}$ совпадает с мерой Лебега на отрезке $[0, \mathbb{P}(\Omega)]$.
\end{lemma}

\begin{proof}
	Поскольку $\mathfrak{T}$ "--- цепь, $\omega \in T \Leftrightarrow \operatorname{mim}\langle\mathfrak{T}, \mathbb{P}\rangle(\omega) \le \mathbb{P}(T), \forall \omega \in \Omega, T \in \mathfrak{T}$. Так как $\mathfrak{T}$ вдобавок порождает безатомическую $\sigma$"~алгебру, то для каждого $0 < t < \mathbb{P}(\Omega)$ найдётся $T \in \mathfrak{T}$ такое, что $\mathbb{P}(T) = t$. Следовательно, функция $\operatorname{mim}\langle\mathfrak{T}, \mathbb{P}\rangle$ отображает множества $T \in \mathfrak{T}$ на отрезки $[0, \mathbb{P}(T)]$, что очевидно влечёт цель доказательства.
\end{proof}

\begin{lemma} \label{lemma:consp}
	Пусть $\langle \Omega, \mathfrak{B}, \mathbb{P} \rangle$ "--- любое безатомическое вероятностное пространство с $\sigma$"~алгеброй, разложимой на $n$ безатомических компонент $\mathfrak{B} = \sigma(\mathfrak{B}_1 \cup \ldots \cup \mathfrak{B}_n)$ таких, что все события из разных компонент совместно независимы, т.е. $\mathbb{P}(B_1 \cap \ldots \cap B_n) = \mathbb{P}(B_1) \ldots \mathbb{P}(B_n)$ для любых $B_i \in \mathfrak{B}_i, i=\overline{1,n}$. Тогда любая измеримая функция с конечным кодоменом $f : \Omega \rightarrow X$ может быть представлена в виде $f = \varphi \circ \mathfrak{r}$, где $\mathfrak{r} : \Omega \rightarrow [0,1]^n$ такова, что $\mathbb{P} \circ \mathfrak{r}^{-1}$ совпадает с мерой Лебега, а $\varphi : [0,1]^n \rightarrow X$ "--- борелевская.
\end{lemma}

\begin{proof}
	Рассмотрим обратную функцию $f^{-1} : X \rightarrow \mathfrak{B}$. В силу разложимости $\mathfrak{B}$ её можно представить как предел последовательности конъюнкций:
	\begin{equation*}
		f^{-1}(x) = \bigcup_{j=1}^\infty F_1^j(x) \cap \ldots \cap F_n^j(x), \; F_i^j : X \rightarrow \mathfrak{B}_i.
	\end{equation*}
	
	Обозначим семейства множеств $\mathfrak{F}_i = \{F_i^j(x) \mid j \in \mathbb{N}, x \in X\}$ и заметим, что $f$ измерима по $\sigma(\mathfrak{F}_1 \cup \ldots \cup \mathfrak{F}_n)$. По лемме \ref{lemma:card}, существуют цепи множеств $\mathfrak{T}_i \subset \mathfrak{B}_i$ такие, что $\sigma(\mathfrak{F}_i) = \sigma(\mathfrak{T}_i)$. Согласно принципу максимума Хаусдорфа каждая такая цепь вложена в максимальную цепь $\overline{\mathfrak{T}}_i \subset \mathfrak{B}_i$, порождающую безатомическую $\sigma$"~алгебру по лемме \ref{lemma:max}. Построим искомые функции: $\mathfrak{r} = (\operatorname{mim}\langle\overline{\mathfrak{T}}_1, \mathbb{P}\rangle, \ldots, \operatorname{mim}\langle\overline{\mathfrak{T}}_n, \mathbb{P}\rangle)$ и $\varphi = f \circ \mathfrak{r}^{-1}$. Необходимые свойства соблюдаются по построению.
\end{proof}

\begin{proof}[Доказательство теоремы \ref{the:struct}]
	Применим лемму \ref{lemma:consp} к произвольному пространству заговоров $\Phi_1$ структуры $\mathfrak{A} = \{A_1, \ldots, A_n\}$, используя в качестве компонент разложения $\mathfrak{B}_1, \ldots, \mathfrak{B}_n$ $\sigma$"~алгебры тайны соответствующих групп заговорщиков. Это даёт для любого разбиения $f_1 \models \Phi_1$ разложение $f_1 = \varphi \circ \mathfrak{r}$. В любом другом пространстве заговоров $\Phi_2$ той же структуры $\mathfrak{A}$ соответствующее разбиение $f_2 \models \Phi_2$ построим похожим образом: $f_2 = \varphi \circ \mathfrak{u}$. Здесь $\varphi$ то же самое, а $\mathfrak{u} = (\operatorname{mim}\langle\mathfrak{W}_1, \mathbb{P}_2\rangle, \ldots, \operatorname{mim}\langle\mathfrak{W}_n, \mathbb{P}_2\rangle)$, где $\mathfrak{W}_i$ - произвольные максимальные цепи, вложенные в $\sigma$"~алгебры соответствующих тайн пространства заговоров $\Phi_2$. Поскольку и $\mathbb{P}_1 \circ \mathfrak{r}^{-1}$, и $\mathbb{P}_2 \circ \mathfrak{u}^{-1}$ обе совпадают с мерой Лебега, то и $\mathbb{P}_1 \circ f_1^{-1} = \mathbb{P}_2 \circ f_2^{-1}$, а значит теорема доказана.
\end{proof}

\chapter{Карточная игра <<Тессеракт>>}\label{app:D}

\section{Правила}\label{app:D1}

\begin{figure}[ht]
	\centerfloat{
		\ifdefmacro{\tikzsetnextfilename}{\tikzsetnextfilename{tikz_tess_compiled}}{}
		\begin{tikzpicture}[scale=4]
			\path (0,{sqrt(1+1/sqrt(2))}) node(As) {Т$\spadesuit$};
			\path ({sqrt(1+1/sqrt(2))/sqrt(2)},{sqrt(1+1/sqrt(2))/sqrt(2)}) node(Js) {В$\spadesuit$};
			\path ({sqrt(1+1/sqrt(2))},0) node(Jh) {В$\heartsuit$};
			\path ({sqrt(1+1/sqrt(2))/sqrt(2)},{-sqrt(1+1/sqrt(2))/sqrt(2)}) node(Jd) {В$\diamondsuit$};
			\path (0,{-sqrt(1+1/sqrt(2))}) node(Qd) {Д$\diamondsuit$};
			\path ({-sqrt(1+1/sqrt(2))/sqrt(2)},{-sqrt(1+1/sqrt(2))/sqrt(2)}) node(Kd) {К$\diamondsuit$};
			\path ({-sqrt(1+1/sqrt(2))},0) node(Kc) {К$\clubsuit$};
			\path ({-sqrt(1+1/sqrt(2))/sqrt(2)},{sqrt(1+1/sqrt(2))/sqrt(2)}) node(Ks) {К$\spadesuit$};
			\path (0,{sqrt(1-1/sqrt(2))}) node(Qs) {Д$\spadesuit$};
			\path ({sqrt(1-1/sqrt(2))/sqrt(2)},{sqrt(1-1/sqrt(2))/sqrt(2)}) node(Ah) {Т$\heartsuit$};
			\path ({sqrt(1-1/sqrt(2))},0) node(Jc) {В$\clubsuit$};
			\path ({sqrt(1-1/sqrt(2))/sqrt(2)},{-sqrt(1-1/sqrt(2))/sqrt(2)}) node(Qh) {Д$\heartsuit$};
			\path (0,{-sqrt(1-1/sqrt(2))}) node(Ad) {Т$\diamondsuit$};
			\path ({-sqrt(1-1/sqrt(2))/sqrt(2)},{-sqrt(1-1/sqrt(2))/sqrt(2)}) node(Qc) {Д$\clubsuit$};
			\path ({-sqrt(1-1/sqrt(2))},0) node(Kh) {К$\heartsuit$};
			\path ({-sqrt(1-1/sqrt(2))/sqrt(2)},{sqrt(1-1/sqrt(2))/sqrt(2)}) node(Ac) {Т$\clubsuit$};
			\draw[double] (As) -- (Ks) (Ah) -- (Kh) (Ad) -- (Kd) (Ac) -- (Kc) (Qs) -- (Js) (Qh) -- (Jh) (Qd) -- (Jd) (Qc) -- (Jc);
			\draw[dashed] (As) -- (Ac) (Ks) -- (Kc) (Qs) -- (Qc) (Js) -- (Jc) (Ah) -- (Ad) (Kh) -- (Kd) (Qh) -- (Qd) (Jh) -- (Jd);
			\draw[dotted] (As) -- (Ah) (Ks) -- (Kh) (Qs) -- (Qh) (Js) -- (Jh) (Ad) -- (Ac) (Kd) -- (Kc) (Qd) -- (Qc) (Jd) -- (Jc);
			\draw[solid] (As) -- (Js) (Ah) -- (Jh) (Ad) -- (Jd) (Ac) -- (Jc) (Ks) -- (Qs) (Kh) -- (Qh) (Kd) -- (Qd) (Kc) -- (Qc);
		\end{tikzpicture}
		\legend{}
		\caption[Тессеракт парных карт]{Тессеракт парных карт}\label{fig:tess}
	}
\end{figure}

Для игры в тессеракт необходимы:
\begin{itemize}
	\item $4$ игрока;
	\item преферансная колода ($4$ масти с достоинствами от семёрки до туза, всего $32$ карты);
	\item фишки или иной способ подсчёта очков;
	\item игрокам, только знакомящимся с игрой, поначалу может быть полезна распечатка диаграммы на рис.~\ref{fig:tess}.
\end{itemize}

Игра состоит из любого (заранее обговорённого и/или по достижении лимита выигрышей/проигрышей) числа независимых раздач. Результатом одной раздачи может стать перераспределение между игроками (с нулевой суммой) некоторого количества фиксированных ставок. Ни один игрок не может проиграть или выиграть более 3 ставок за раздачу.

Раздача начинается с деления колоды на старшие (В, Д, К, Т) и младшие (7, 8, 9, 10) карты.\footnote{Можно перемешивать и раздавать колоду целиком, не разделяя, по 8 карт каждому лицом вверх, однако в таком случае будут нередко случаться расклады, существенно благоволящие одним игрокам в ущерб другим. Например, если кому-либо будет сдана рука из одних только младших карт, то он фактически превратится в болванчика, не имеющего возможности влиять на исход игры вообще. Игрок с одной старшей картой в руке, хотя и будет иметь возможность один раз за розыгрыш повлиять на игровую ситуацию, не сможет совершать тайных от других игроков осмысленных ходов, что сделает его стратегию более предсказуемой, и т.д.. Впрочем, если участники готовы мириться с усилением элемента случайности в игре, то подобный <<ленивый>> способ раздачи использовать не возбраняется.} Старшая колода перемешивается и сдаётся игрокам в открытую (лицом вверх), по 4 карты каждому. Младшая колода раздаётся без перемешивания (тут масти и достоинства не имеют значения), также по 4 карты на игрока. После того как все увидели расклад, каждый игрок подбирает сданные ему старшие и младшие карты, объединяя их в закрытой руке. После этого начинается розыгрыш, состоящий из четырёх кругов.

В течение каждого круга ходов игроки должны в произвольном порядке совершить по два действия: а) сыграть одну карту перед собой рубашкой вверх и б) сбросить одну карту в общую стопку сброса рубашкой вверх. После того как все закончат, сыгранные (но не сброшенные) карты раскрываются. По завершении всех четырёх кругов у игроков не остаётся карт в руках, перед каждым лежат лицом вверх по 4 сыгранные карты, и подводится итог розыгрыша. Каждый игрок должен сосчитать вскрытые непарные карты и, соответственно, свой штраф.

С точки зрения каждого игрока 16 старших карт по своему разбиваются на 8 пар. Способ разбиения определяется в зависимости от его порядкового номера за столом:
\begin{enumerate}
	\item парны валеты и дамы одной масти, парны короли и тузы одной масти;
	\item парны трефы и пики одного достоинства, парны червы и бубны одного достоинства;
	\item парны пики и червы одного достоинства, парны бубны и трефы одного достоинства;
	\item парны валеты и тузы одной масти, парны дамы и короли одной масти.
\end{enumerate}

На рис. \ref{fig:tess} парность карт для разных игроков обозначена линиями различной штриховки. При этом легко заметить, что 16"~ти старшим картам можно поставить в соответствие вершины четырёх"~мерного гиперкуба (отсюда название <<Тессеракт>>) таким образом, что для каждого игрока отношение парности соответствует своему набору параллельных рёбер.

В контексте подсчёта штрафов непарной картой для игрока считается вскрытая старшая карта, не образующая по его правилам пары с другими вскрытыми картами. Штраф игрока считается по формуле $\left|2l-8\right|$, где $l$ "--- количество непарных с его точки зрения карт. Желающему избежать штрафа игроку следует ходить таким образом, чтобы к концу розыгрыша было сыграно ровно $4$ непарные для него карты, так как каждая карта отклонения в большую или меньшую сторону увеличивает его штраф на $2$. Средний штраф определяется как среднее арифметическое суммарных штрафов каждого из игроков. При окончательном расчёте игроки, чей штраф больше среднего, вносят в банк фишки кол"~ом равным разнице между своим штрафом и средним. Те же игроки, чей штраф меньше среднего, наоборот, забирают из банка разницу между средним и своим штрафами.

\section{Пример расклада}\label{app:D2}

Поскольку младшие карты не используются при подсчёте штрафов, начальная раздача определяется раскладом старших карт.

\begin{table}[htbp]
	\centering
	\caption{Расклад}
	\label{tab:cards1}
	\begin{SingleSpace}
		\begin{tabular}{|c|cccc|}
			\hline
			Игрок & \multicolumn{4}{c|}{Рука} \\
			\hline
			$1$ & В$\diamondsuit$ & Д$\clubsuit$ & К$\clubsuit$ & Т$\clubsuit$ \\
			$2$ & К$\spadesuit$ & К$\heartsuit$ & К$\diamondsuit$ & В$\clubsuit$ \\
			$3$ & Д$\spadesuit$ & В$\heartsuit$ & Д$\heartsuit$ & Д$\diamondsuit$ \\
			$4$ & В$\spadesuit$ & Т$\spadesuit$ & Т$\heartsuit$ & Т$\diamondsuit$ \\
			\hline
		\end{tabular}
	\end{SingleSpace}
\end{table}

Дальнейший процесс разыгрывания можно записывать так, как это демонстрируется в таблице \ref{tab:cards2}.

\begin{table}[htbp]
	\centering
	\caption{Розыгрыш}
	\label{tab:cards2}
	\begin{SingleSpace}
		\newcolumntype{a}{>{\centering}m{1.5em}}
		\newcolumntype{d}{>{\centering\columncolor{lightgray}}m{1.5em}}
		\begin{tabular}{|c|ad|ad|ad|ad|}
			\hline
			Игрок & \multicolumn{8}{c|}{Круги ходов} \\
			\hline
			& \multicolumn{2}{c|}{1} & \multicolumn{2}{c|}{2} & \multicolumn{2}{c|}{3} & \multicolumn{2}{c|}{4} \\
			$1$ & Д$\clubsuit$ & Т$\clubsuit$ & & & & К$\clubsuit$ & & В$\diamondsuit$ \tabularnewline
			$2$ & К$\spadesuit$ & & & В$\clubsuit$ & & К$\heartsuit$ & К$\diamondsuit$ & \tabularnewline
			$3$ & В$\heartsuit$ & & Д$\diamondsuit$ & & & Д$\heartsuit$ & Д$\spadesuit$ & \tabularnewline
			$4$ & Т$\heartsuit$ & & Т$\diamondsuit$ & & Т$\spadesuit$ & & & В$\spadesuit$ \tabularnewline
			\hline
		\end{tabular}
	\end{SingleSpace}
\end{table}

Здесь, опять же, младшие карты не показаны в силу их неразличимости с точки зрения правил, на белом фоне показаны сыгранные старшие карты, а на сером "--- сброшенные. Например, первый игрок на первом круге сыграл перед собой даму треф и сбросил туза треф, на втором круге сыграл и сбросил по младшей карте и т.д.. Посчитаем непарные карты с точки зрения каждого из игроков, записывая в скобках соответствующую сброшенную парную карту:

\begin{enumerate}
	\item Д$\clubsuit$ (В$\clubsuit$), В$\heartsuit$ (Д$\heartsuit$), Т$\heartsuit$ (К$\heartsuit$), Д$\diamondsuit$ (В$\diamondsuit$), Д$\spadesuit$ (В$\spadesuit$)
	\item К$\spadesuit$ (К$\clubsuit$), В$\heartsuit$ (В$\diamondsuit$), Д$\diamondsuit$ (Д$\heartsuit$), Т$\spadesuit$ (Т$\clubsuit$), К$\diamondsuit$ (К$\heartsuit$)
	\item К$\spadesuit$ (К$\heartsuit$), В$\heartsuit$ (В$\spadesuit$), Т$\diamondsuit$ (Т$\clubsuit$), К$\diamondsuit$ (К$\clubsuit$), Д$\spadesuit$ (Д$\heartsuit$)
	\item Д$\clubsuit$ (К$\clubsuit$), Т$\diamondsuit$ (В$\diamondsuit$), Т$\spadesuit$ (В$\spadesuit$)
\end{enumerate}

У первого игрока из 9 вскрытых карт 4 образуют пары: К$\diamondsuit$"~Т$\diamondsuit$ и К$\spadesuit$"~Т$\spadesuit$. Остаются 5 непарных карт, что соответствует $\left|2\cdot5-8\right| = 2$ очкам штрафа. Повторив ту же процедуру для остальных игроков, можно дополнить таблицу столбцом штрафов.

\begin{table}[htbp]
	\centering
	\caption{Штрафы}
	\label{tab:cards3}
	\begin{SingleSpace}
		\newcolumntype{a}{>{\centering}m{1.5em}}
		\newcolumntype{d}{>{\centering\columncolor{lightgray}}m{1.5em}}
		\begin{tabular}{|c|ad|ad|ad|ad|c|}
			\hline
			Игрок & \multicolumn{8}{c|}{Круги ходов} & Штраф \\
			\hline
			& \multicolumn{2}{c|}{1} & \multicolumn{2}{c|}{2} & \multicolumn{2}{c|}{3} & \multicolumn{2}{c|}{4} & \\
			$1$ & Д$\clubsuit$ & Т$\clubsuit$ & & & & К$\clubsuit$ & & В$\diamondsuit$ & 2 \\
			$2$ & К$\spadesuit$ & & & В$\clubsuit$ & & К$\heartsuit$ & К$\diamondsuit$ & & 2 \\
			$3$ & В$\heartsuit$ & & Д$\diamondsuit$ & & & Д$\heartsuit$ & Д$\spadesuit$ & & 2 \\
			$4$ & Т$\heartsuit$ & & Т$\diamondsuit$ & & Т$\spadesuit$ & & & В$\spadesuit$ & 2 \\
			\hline
		\end{tabular}
	\end{SingleSpace}
\end{table}

Штрафы всех игроков равны, а значит никто никому не платит.

\section{Возможные исходы и простейшие стратегии}\label{app:D3}

Интересно то, что в любой момент игры штрафы каждых двух участников либо равны, либо различаются на 4. Это несложным образом подтверждается перебором $2^{16}$ всевозможных исходов розыгрыша, что с точки зрения выплат оставляет всего 4 различимых класса ситуаций:
\begin{enumerate}
	\item штрафы всех игроков равны, выплат нет;
	\item штраф одного из игроков на 4 больше, чем у остальных троих, он платит каждому из них по 1 фишке;
	\item штрафы двух пар игроков различаются на 4, каждый из проигравших платит по 1 фишке каждому из победителей.
	\item штраф одного из игроков на 4 меньше, чем у остальных троих, они платят ему по 1 фишке каждый
\end{enumerate}

Поскольку каждый раз, когда играется старшая карта, соперники раскрывшего её игрока уменьшают меру своего незнания относительно оставшегося содержимого его руки, то тактически разумнее играть старшие карты после младших. Кроме того, легко убедиться, что для получения в качестве исхода розыгрыша представителя любого из вышеперечисленных классов достаточно не более 4 сыгранных всеми игроками карт. Таким образом, базовой стратегией при игре в <<Тессеракт>> можно считать следующую "--- на протяжении первых трёх ходов играются только младшие карты, а единственная старшая играется на последнем круге. Даже если за столом сидят только новички, ограничивающиеся базовыми стратегиями, то их розыгрыш может закончится исходом, принадлежащим к любому из вышеперечисленных классов.

%\section{Формальная модель}\label{app:D3}
%
%С формальной точки зрения каждый расклад <<Тессеракта>> можно представить в виде игры развёрнутой формы с несовершенной информацией. Дерево игры имеет фиксированную высоту в 32 ребра от корня до каждой из терминальных вершин и разбивается на 4 слоя по 8 рёбер в высоту каждый, соответствующих кругам розыгрыша. Каждая вершина характеризуется набором параметров $\left\langle i, a, T, H\right\rangle$:
%
%\begin{itemize}
%	\item $i = 1 \ldots 4$ "--- номер слоя/круга;
%	\item $a = 1 \ldots 4$ "--- номер игрока с правом хода;
%	\item $T = (T^1, T^2, T^3, T^4)$ "--- множества старших карт, сыгранных к этому моменту на каждом круге; 
%	\item $H = (H^1, H^2, H^3, H^4)$ "--- множества старших карт, оставшихся к этому моменту в руках игроков.
%\end{itemize}
%
%Нетерминальные вершины бывают двух типов - для игры и для сброса. В игровой вершине слоя $i$ игрок $a$ с правом хода может переместить один любой элемент из множества $H^a$ в множество $T^i$ (при непустоте $H^a$). В вершине для сброса же, соответственно, игрок $a$ может исключить из $H^a$ один любой элемент. Кроме того в вершинах обоего типа игрок с правом хода, в том случае если количественно оставшихся у него ходов включая текущий больше чем старших карт в руке, может ничего не менять, что соответствует игре или сбросу младшей карты. Легальная цепочка ходов в каждом слое дерева включает по одной вершине обоих типов для каждого из игроков. При этом информационные наборы таковы, что вершины одного типа $\left\langle i_1, a_1, T_1, H_1\right\rangle$ и $\left\langle i_2, a_2, T_2, H_2\right\rangle$ входят в один набор в том и только том случае, когда $i_1 = i_2$, $a_1 = a_2$, $T_1^k = T_2^k, \forall k < i$ и $H_1^a = H_2^a$. Такая информационная структура отражает то, что в рамках одного круга карты играются всеми соперниками сперва в закрытую, а раскрываются только после того, как все завершили сброс, фактически делая несущественным порядок ходов внутри каждого слоя.
%
%Для терминальных вершин из этого набора параметров выводится единственный имеющий смысл для определения выплат "--- множество всех сыгранных старших карт $T^* = T^1 \cup T^2 \cup T^3 \cup T^4$. Если обозначить символом $\mathcal{D}^a(T^*)$ операцию исключения из множества сыгранных карт парных с точки зрения игрока $a$, то вектор штрафов приобретает вид $f = (f^1, f^2, f^3, f^4), f^a = \left| 2 \left| \mathcal{D}^a(T^*) \right| - 8 \right|$. Соответственно выводится вектор выплат $u = (u^1, u^2, u^3, u^4), u^a = \frac{1}{4} (f^1 + f^2 + f^3 + f^4) - f^a$. С использованием всего этого теоретически возможно построение полного дерева любого расклада, однако при помощи элементарного комбинаторного рассуждения можно подсчитать, сколько всевозможных партий можно сыграть на одной раздаче "--- $(5 \cdot 6 \cdot 7 \cdot 8)^4 \approx 8 \cdot 10^{12}$. Хотя в эпоху современной вычислительной техники $8$ триллионов "--- уже не настолько пугающее число, подобные экзерсисы выходят за рамки этого труда.
%
%Во избежание вскрывшегося комбинаторного взрыва множество стратегий любого игрока $a$ можно представить в виде пространства всевозможных комбинаций четырёх элементов $S^a = S^a_1 \times S^a_2 \times S^a_3 \times S^a_4$, по одному на каждый круг ходов. Каждая компонента $s^a_i \in S^a_i$ представляет собой произвольную функцию, берущую аргументами текущую руку $H^a$ и все предыдущие сыгранные круги $T^k, k < i$ и возвращающую пару карт $(p, d \in H^a \cup \{\varnothing\})$, где $p$ обозначает карту для игры, $d$ "--- карту для сброса, а $\varnothing$ "--- произвольную младшую карту. Понятное дело, если обе карты старшие, то они должны быть различны, а младшие карты можно использовать, только если их ещё хватает в руке. Естественно сразу задаться вопросом, а нельзя ли для этой игры подобрать какое-то более простое представление с совершенной информацией "--- вдруг закрытость сброса не имеет большого значения для хода игры? Опровергнем это на примере того же розыгрыша из предыдущего раздела, обратив внимание только на последний круг ходов, представимый в виде обычной игры в нормальной форме.
%
%\begin{table}[htbp]
%	\centering
%	\caption{Розыгрыш трёх кругов (вар. А)}
%	\label{tab:cards4}
%	\begin{SingleSpace}
%		\newcolumntype{a}{>{\centering}m{1.5em}}
%		\newcolumntype{d}{>{\centering\columncolor{lightgray}}m{1.5em}}
%		\begin{tabular}{|c|ad|ad|ad|ad|c|}
%			\hline
%			Игрок & \multicolumn{8}{c|}{Круги ходов} & Штраф \\
%			\hline
%			& \multicolumn{2}{c|}{1} & \multicolumn{2}{c|}{2} & \multicolumn{2}{c|}{3} & \multicolumn{2}{c|}{} & \\
%			$1$ & Д$\clubsuit$ & Т$\clubsuit$ & & & & К$\clubsuit$ & & & \\
%			$2$ & К$\spadesuit$ & & & В$\clubsuit$ & & К$\heartsuit$ & & & \\
%			$3$ & В$\heartsuit$ & & Д$\diamondsuit$ & & & Д$\heartsuit$ & & & \\
%			$4$ & Т$\heartsuit$ & & Т$\diamondsuit$ & & Т$\spadesuit$ & & & & \\
%			\hline
%		\end{tabular}
%	\end{SingleSpace}
%\end{table}
%
%\begin{table}[htbp]
%	\centering
%	\caption{Последний круг ходов (вар. А)}
%	\label{tab:cards5}
%	\begin{SingleSpace}
%		\begin{tabular}{|lr|lr|lr|lr|}
%			\hline
%			$s^1$ & & $s^2$ & & $s^3$ & & $s^4$ & \\
%			& $u^1(s)$ & & $u^2(s)$ & & $u^3(s)$ & & $u^4(s)$ \\
%			\hline \hline
%			$\varnothing$ & & $\varnothing$ & & $\varnothing$ & & $\varnothing$ & \\
%			& 0 & & 0 & & 0 & & 0 \\
%			\hline
%			$\varnothing$ & & $\varnothing$ & & $\varnothing$ & & В$\spadesuit$ & \\
%			& -1 & & -1 & & -1 & & +3 \\
%			\hline
%			$\varnothing$ & & $\varnothing$ & & Д$\spadesuit$ & & $\varnothing$ & \\
%			& -3 & & +1 & & +1 & & +1 \\
%			\hline
%			$\varnothing$ & & $\varnothing$ & & Д$\spadesuit$ & & В$\spadesuit$ & \\
%			& 0 & & 0 & & 0 & & 0 \\
%			\hline
%			$\varnothing$ & & К$\diamondsuit$ & & $\varnothing$ & & $\varnothing$ & \\
%			& +1 & & -3 & & +1 & & +1 \\
%			\hline
%			$\varnothing$ & & К$\diamondsuit$ & & $\varnothing$ & & В$\spadesuit$ & \\
%			& +1 & & -3 & & +1 & & +1 \\
%			\hline
%			$\varnothing$ & & К$\diamondsuit$ & & Д$\spadesuit$ & & $\varnothing$ & \\
%			& 0 & & 0 & & 0 & & 0 \\
%			\hline
%			$\varnothing$ & & К$\diamondsuit$ & & Д$\spadesuit$ & & В$\spadesuit$ & \\
%			& +2 & & -2 & & +2 & & -2 \\
%			\hline \rowcolor{lightgray}
%			В$\diamondsuit$ & & $\varnothing$ & & $\varnothing$ & & $\varnothing$ & \\ \rowcolor{lightgray}
%			& 0 & & 0 & & 0 & & 0 \\
%			\hline
%			В$\diamondsuit$ & & $\varnothing$ & & $\varnothing$ & & В$\spadesuit$ & \\
%			& 0 & & 0 & & 0 & & 0 \\
%			\hline
%			В$\diamondsuit$ & & $\varnothing$ & & Д$\spadesuit$ & & $\varnothing$ & \\
%			& 0 & & 0 & & 0 & & 0 \\
%			\hline
%			В$\diamondsuit$ & & $\varnothing$ & & Д$\spadesuit$ & & В$\spadesuit$ & \\
%			& +1 & & +1 & & +1 & & -3 \\
%			\hline
%			В$\diamondsuit$ & & К$\diamondsuit$ & & $\varnothing$ & & $\varnothing$ & \\
%			& 0 & & 0 & & 0 & & 0 \\
%			\hline
%			В$\diamondsuit$ & & К$\diamondsuit$ & & $\varnothing$ & & В$\spadesuit$ & \\
%			& +2 & & -2 & & +2 & & -2 \\
%			\hline
%			В$\diamondsuit$ & & К$\diamondsuit$ & & Д$\spadesuit$ & & $\varnothing$ & \\
%			& +2 & & +2 & & -2 & & -2 \\
%			\hline
%			В$\diamondsuit$ & & К$\diamondsuit$ & & Д$\spadesuit$ & & В$\spadesuit$ & \\
%			& +1 & & +1 & & +1 & & -3 \\
%			\hline
%		\end{tabular}
%	\end{SingleSpace}
%\end{table}
%
%Рассмотрим расклад, когда у всех на руках осталось по две карты (таблица \ref{tab:cards4}), как игру в нормальной форме $\Gamma = \langle A, S^a, u^a(s), a \in A \rangle$. Здесь $A = \{1, 2, 3, 4\}$, $S^1 = \{\varnothing, \text{В}\diamondsuit\}$, $S^2 = \{\varnothing, \text{К}\diamondsuit\}$, $S^3 = \{\varnothing, \text{Д}\spadesuit\}$, $S^4 = \{\varnothing, \text{В}\spadesuit\}$, а использование игроком стратегии $s^a$ подразумевает, что карту $s^a$ он играет, а оставшуюся сбрасывает. В таблице \ref{tab:cards5} перечислены значения функции выплат для всех сочетаний чистых стратегий, а серым выделено единственное равновесие по Нэшу в чистых стратегиях. Если предполагать, что сокрытая от игроков информация не имеет значения, то разумно ожидать, что в любых альтернативных раскладах с совпадающим публичным знанием также будет существовать равновесие по Нэшу, разнящееся с этим только, возможно, стратегией знающего об отличии игрока. Продемонстрируем противоположное на слегка модифицированном розыгрыше, отличающемся от приведённого выше только лишь тем, что на третьем круге первый игрок сбросил В$\diamondsuit$ вместо К$\clubsuit$.
%
%\begin{table}[htbp]
%	\centering
%	\caption{Розыгрыш трёх кругов (вар. Б)}
%	\label{tab:cards6}
%	\begin{SingleSpace}
%		\newcolumntype{a}{>{\centering}m{1.5em}}
%		\newcolumntype{d}{>{\centering\columncolor{lightgray}}m{1.5em}}
%		\begin{tabular}{|c|ad|ad|ad|ad|c|}
%			\hline
%			Игрок & \multicolumn{8}{c|}{Круги ходов} & Штраф \\
%			\hline
%			& \multicolumn{2}{c|}{1} & \multicolumn{2}{c|}{2} & \multicolumn{2}{c|}{3} & \multicolumn{2}{c|}{} & \\
%			$1$ & Д$\clubsuit$ & Т$\clubsuit$ & & & & В$\diamondsuit$ & & & \\
%			$2$ & К$\spadesuit$ & & & В$\clubsuit$ & & К$\heartsuit$ & & & \\
%			$3$ & В$\heartsuit$ & & Д$\diamondsuit$ & & & Д$\heartsuit$ & & & \\
%			$4$ & Т$\heartsuit$ & & Т$\diamondsuit$ & & Т$\spadesuit$ & & & & \\
%			\hline
%		\end{tabular}
%	\end{SingleSpace}
%\end{table}
%
%\begin{table}[htbp]
%	\centering
%	\caption{Последний круг ходов (вар. Б)}
%	\label{tab:cards7}
%	\begin{SingleSpace}
%		\begin{tabular}{|lr|lr|lr|lr|}
%			\hline
%			$s^1$ & & $s^2$ & & $s^3$ & & $s^4$ & \\
%			& $u^1(s)$ & & $u^2(s)$ & & $u^3(s)$ & & $u^4(s)$ \\
%			\hline \hline
%			$\varnothing$ & & $\varnothing$ & & $\varnothing$ & & $\varnothing$ & \\
%			& 0 & & 0 & & 0 & & 0 \\
%			\hline
%			$\varnothing$ & & $\varnothing$ & & $\varnothing$ & & В$\spadesuit$ & \\
%			& -1 & & -1 & & -1 & & +3 \\
%			\hline \rowcolor{lightgray}
%			$\varnothing$ & & $\varnothing$ & & Д$\spadesuit$ & & $\varnothing$ & \\ \rowcolor{lightgray}
%			& -3 & & +1 & & +1 & & +1 \\
%			\hline
%			$\varnothing$ & & $\varnothing$ & & Д$\spadesuit$ & & В$\spadesuit$ & \\
%			& 0 & & 0 & & 0 & & 0 \\
%			\hline
%			$\varnothing$ & & К$\diamondsuit$ & & $\varnothing$ & & $\varnothing$ & \\
%			& +1 & & -3 & & +1 & & +1 \\
%			\hline
%			$\varnothing$ & & К$\diamondsuit$ & & $\varnothing$ & & В$\spadesuit$ & \\
%			& +1 & & -3 & & +1 & & +1 \\
%			\hline
%			$\varnothing$ & & К$\diamondsuit$ & & Д$\spadesuit$ & & $\varnothing$ & \\
%			& 0 & & 0 & & 0 & & 0 \\
%			\hline
%			$\varnothing$ & & К$\diamondsuit$ & & Д$\spadesuit$ & & В$\spadesuit$ & \\
%			& +2 & & -2 & & +2 & & -2 \\
%			\hline
%			К$\clubsuit$ & & $\varnothing$ & & $\varnothing$ & & $\varnothing$ & \\
%			& -3 & & +1 & & +1 & & +1 \\
%			\hline
%			К$\clubsuit$ & & $\varnothing$ & & $\varnothing$ & & В$\spadesuit$ & \\
%			& -3 & & +1 & & +1 & & +1 \\
%			\hline
%			К$\clubsuit$ & & $\varnothing$ & & Д$\spadesuit$ & & $\varnothing$ & \\
%			& -3 & & +1 & & +1 & & +1 \\
%			\hline
%			К$\clubsuit$ & & $\varnothing$ & & Д$\spadesuit$ & & В$\spadesuit$ & \\
%			& -2 & & +2 & & +2 & & -2 \\
%			\hline
%			К$\clubsuit$ & & К$\diamondsuit$ & & $\varnothing$ & & $\varnothing$ & \\
%			& 0 & & 0 & & 0 & & 0 \\
%			\hline
%			К$\clubsuit$ & & К$\diamondsuit$ & & $\varnothing$ & & В$\spadesuit$ & \\
%			& 0 & & 0 & & 0 & & 0 \\
%			\hline
%			К$\clubsuit$ & & К$\diamondsuit$ & & Д$\spadesuit$ & & $\varnothing$ & \\
%			& -2 & & +2 & & +2 & & -2 \\
%			\hline
%			К$\clubsuit$ & & К$\diamondsuit$ & & Д$\spadesuit$ & & В$\spadesuit$ & \\
%			& +1 & & +1 & & +1 & & -3 \\
%			\hline
%		\end{tabular}
%	\end{SingleSpace}
%\end{table}
%
%В результате такого изменения множество доступных на последнем круге первому игроку стратегий превращается в $S^1 = \{\varnothing, \text{К}\clubsuit\}$, что даёт другую таблицу исходов. В этой игре также присутствует одно равновесие по Нэшу в чистых стратегиях, однако оно отличается от предыдущего ходами не только первого, но и третьего игроков, что говорит о существенности сброса в закрытую.
%
%\section{Стратегии последнего круга}\label{app:D4}

